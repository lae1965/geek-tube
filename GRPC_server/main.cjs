/*! For license information please see main.js.LICENSE.txt */
(()=>{var __webpack_modules__={1265:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addAdminServicesToServer=t.registerAdminService=void 0;const i=[];t.registerAdminService=function(e,t){i.push({getServiceDefinition:e,getHandlers:t})},t.addAdminServicesToServer=function(e){for(const{getServiceDefinition:t,getHandlers:n}of i)e.addService(t(),n())}},3510:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffTimeout=void 0,t.BackoffTimeout=class{constructor(e,t){this.callback=e,this.initialDelay=1e3,this.multiplier=1.6,this.maxDelay=12e4,this.jitter=.2,this.running=!1,this.hasRef=!0,this.startTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout((()=>{}),0),clearTimeout(this.timerId)}runTimer(e){var t,i;clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.callback(),this.running=!1}),e),this.hasRef||null===(i=(t=this.timerId).unref)||void 0===i||i.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);const e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;var i,n;this.nextDelay=e+(i=-t,n=t,Math.random()*(n-i)+i)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){const e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,null===(t=(e=this.timerId).ref)||void 0===t||t.call(e)}unref(){var e,t;this.hasRef=!1,null===(t=(e=this.timerId).unref)||void 0===t||t.call(e)}}},9587:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallCredentials=void 0;const n=i(4664);class s{static createFromMetadataGenerator(e){return new a(e)}static createFromGoogleCredential(e){return s.createFromMetadataGenerator(((t,i)=>{let s;var r;s="getRequestHeaders"in(r=e)&&"function"==typeof r.getRequestHeaders?e.getRequestHeaders(t.service_url):new Promise(((i,n)=>{e.getRequestMetadata(t.service_url,((e,t)=>{e?n(e):t?i(t):n(new Error("Headers not set by metadata plugin"))}))})),s.then((e=>{const t=new n.Metadata;for(const i of Object.keys(e))t.add(i,e[i]);i(null,t)}),(e=>{i(e)}))}))}static createEmpty(){return new o}}t.CallCredentials=s;class r extends s{constructor(e){super(),this.creds=e}async generateMetadata(e){const t=new n.Metadata,i=await Promise.all(this.creds.map((t=>t.generateMetadata(e))));for(const e of i)t.merge(e);return t}compose(e){return new r(this.creds.concat([e]))}_equals(e){return this===e||e instanceof r&&this.creds.every(((t,i)=>t._equals(e.creds[i])))}}class a extends s{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise(((t,i)=>{this.metadataGenerator(e,((e,n)=>{void 0!==n?t(n):i(e)}))}))}compose(e){return new r([this,e])}_equals(e){return this===e||e instanceof a&&this.metadataGenerator===e.metadataGenerator}}class o extends s{generateMetadata(e){return Promise.resolve(new n.Metadata)}compose(e){return e}_equals(e){return e instanceof o}}},8183:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterceptingListenerImpl=t.isInterceptingListener=void 0,t.isInterceptingListener=function(e){return void 0!==e.onReceiveMetadata&&1===e.onReceiveMetadata.length},t.InterceptingListenerImpl=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,(e=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(e),this.processPendingMessage(),this.processPendingStatus()}))}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,(e=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=e,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(e),this.processPendingStatus())}))}onReceiveStatus(e){this.listener.onReceiveStatus(e,(e=>{this.processingMetadata||this.processingMessage?this.pendingStatus=e:this.nextListener.onReceiveStatus(e)}))}}},868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNextCallNumber=void 0;let i=0;t.getNextCallNumber=function(){return i++}},3509:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientDuplexStreamImpl=t.ClientWritableStreamImpl=t.ClientReadableStreamImpl=t.ClientUnaryCallImpl=t.callErrorFromStatus=void 0;const n=i(2361),s=i(2781),r=i(3189);t.callErrorFromStatus=function(e,t){const i=`${e.code} ${r.Status[e.code]}: ${e.details}`,n=`${new Error(i).stack}\nfor call at\n${t}`;return Object.assign(new Error(i),e,{stack:n})};class a extends n.EventEmitter{constructor(){super()}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(r.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}}t.ClientUnaryCallImpl=a;class o extends s.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(r.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_read(e){var t;null===(t=this.call)||void 0===t||t.startRead()}}t.ClientReadableStreamImpl=o;class l extends s.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(r.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_write(e,t,i){var n;const s={callback:i},r=Number(t);Number.isNaN(r)||(s.flags=r),null===(n=this.call)||void 0===n||n.sendMessageWithContext(s,e)}_final(e){var t;null===(t=this.call)||void 0===t||t.halfClose(),e()}}t.ClientWritableStreamImpl=l;class c extends s.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;null===(e=this.call)||void 0===e||e.cancelWithStatus(r.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!==(t=null===(e=this.call)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:"unknown"}_read(e){var t;null===(t=this.call)||void 0===t||t.startRead()}_write(e,t,i){var n;const s={callback:i},r=Number(t);Number.isNaN(r)||(s.flags=r),null===(n=this.call)||void 0===n||n.sendMessageWithContext(s,e)}_final(e){var t;null===(t=this.call)||void 0===t||t.halfClose(),e()}}t.ClientDuplexStreamImpl=c},9357:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelCredentials=void 0;const n=i(4404),s=i(9587),r=i(8283);function a(e,t){if(e&&!(e instanceof Buffer))throw new TypeError(`${t}, if provided, must be a Buffer.`)}class o{constructor(e){this.callCredentials=e||s.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,i,s){var o;if(a(e,"Root certificate"),a(t,"Private key"),a(i,"Certificate chain"),t&&!i)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&i)throw new Error("Certificate chain must be given with accompanying private key");const l=(0,n.createSecureContext)({ca:null!==(o=null!=e?e:(0,r.getDefaultRootsData)())&&void 0!==o?o:void 0,key:null!=t?t:void 0,cert:null!=i?i:void 0,ciphers:r.CIPHER_SUITES});return new c(l,null!=s?s:{})}static createFromSecureContext(e,t){return new c(e,null!=t?t:{})}static createInsecure(){return new l}}t.ChannelCredentials=o;class l extends o{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof l}}class c extends o{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},(null==t?void 0:t.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){const t=this.callCredentials.compose(e);return new u(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e||e instanceof c&&this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}}class u extends o{constructor(e,t){super(t),this.channelCredentials=e}compose(e){const t=this.callCredentials.compose(e);return new u(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e||e instanceof u&&this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}}},8938:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.channelOptionsEqual=t.recognizedOptions=void 0,t.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0},t.channelOptionsEqual=function(e,t){const i=Object.keys(e).sort(),n=Object.keys(t).sort();if(i.length!==n.length)return!1;for(let s=0;s<i.length;s+=1){if(i[s]!==n[s])return!1;if(e[i[s]]!==t[n[s]])return!1}return!0}},2253:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelImplementation=void 0;const n=i(9357),s=i(2805);t.ChannelImplementation=class{constructor(e,t,i){if("string"!=typeof e)throw new TypeError("Channel target must be a string");if(!(t instanceof n.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&"object"!=typeof i)throw new TypeError("Channel options must be an object");this.internalChannel=new s.InternalChannel(e,t,i)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,i){this.internalChannel.watchConnectivityState(e,t,i)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,i,n,s){if("string"!=typeof e)throw new TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,i,n,s)}}},8950:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.getChannelzServiceDefinition=t.getChannelzHandlers=t.unregisterChannelzRef=t.registerChannelzSocket=t.registerChannelzServer=t.registerChannelzSubchannel=t.registerChannelzChannel=t.ChannelzCallTracker=t.ChannelzChildrenTracker=t.ChannelzTrace=void 0;const n=i(1808),s=i(207),r=i(3189),a=i(8741),o=i(1265),l=i(2011);function c(e){return{channel_id:e.id,name:e.name}}function u(e){return{subchannel_id:e.id,name:e.name}}function h(e){return{socket_id:e.id,name:e.name}}t.ChannelzTrace=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,i){const n=new Date;this.events.push({description:t,severity:e,timestamp:n,childChannel:"channel"===(null==i?void 0:i.kind)?i:void 0,childSubchannel:"subchannel"===(null==i?void 0:i.kind)?i:void 0}),this.events.length>=64&&(this.events=this.events.slice(32)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:C(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map((e=>({description:e.description,severity:e.severity,timestamp:C(e.timestamp),channel_ref:e.childChannel?c(e.childChannel):null,subchannel_ref:e.childSubchannel?u(e.childSubchannel):null})))}}},t.ChannelzChildrenTracker=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,i,n;switch(e.kind){case"channel":{let i=null!==(t=this.channelChildren.get(e.id))&&void 0!==t?t:{ref:e,count:0};i.count+=1,this.channelChildren.set(e.id,i);break}case"subchannel":{let t=null!==(i=this.subchannelChildren.get(e.id))&&void 0!==i?i:{ref:e,count:0};t.count+=1,this.subchannelChildren.set(e.id,t);break}case"socket":{let t=null!==(n=this.socketChildren.get(e.id))&&void 0!==n?n:{ref:e,count:0};t.count+=1,this.socketChildren.set(e.id,t);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){const e=[];for(const{ref:t}of this.channelChildren.values())e.push(t);const t=[];for(const{ref:e}of this.subchannelChildren.values())t.push(e);const i=[];for(const{ref:e}of this.socketChildren.values())i.push(e);return{channels:e,subchannels:t,sockets:i}}},t.ChannelzCallTracker=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};let d=1;function f(){return d++}const p=[],m=[],g=[],v=[];function y(e){if(""===e)return[];const t=e.split(":").map((e=>function(e){const t=Number.parseInt(e,16);return[t/256|0,t%256]}(e)));return[].concat(...t)}function S(e){if((0,n.isIPv4)(e))return Buffer.from(Uint8Array.from(e.split(".").map((e=>Number.parseInt(e)))));if((0,n.isIPv6)(e)){let t,i;const n=e.indexOf("::");-1===n?(t=e,i=""):(t=e.substring(0,n),i=e.substring(n+2));const s=Buffer.from(y(t)),r=Buffer.from(y(i)),a=Buffer.alloc(16-s.length-r.length,0);return Buffer.concat([s,a,r])}return null}function b(e){switch(e){case s.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case s.ConnectivityState.IDLE:return{state:"IDLE"};case s.ConnectivityState.READY:return{state:"READY"};case s.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case s.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function C(e){if(!e)return null;const t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function T(e){const t=e.getInfo();return{ref:c(e.ref),data:{target:t.target,state:b(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:C(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map((e=>c(e))),subchannel_ref:t.children.subchannels.map((e=>u(e)))}}function E(e,t){const i=Number.parseInt(e.request.channel_id),n=p[i];void 0!==n?t(null,{channel:T(n)}):t({code:r.Status.NOT_FOUND,details:"No channel data found for id "+i})}function w(e,t){const i=Number.parseInt(e.request.max_results),n=[];let s=Number.parseInt(e.request.start_channel_id);for(;s<p.length;s++){const e=p[s];if(void 0!==e&&(n.push(T(e)),n.length>=i))break}t(null,{channel:n,end:s>=g.length})}function _(e){const t=e.getInfo();return{ref:(i=e.ref,{server_id:i.id}),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:C(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map((e=>h(e)))};var i}function k(e,t){const i=Number.parseInt(e.request.server_id),n=g[i];void 0!==n?t(null,{server:_(n)}):t({code:r.Status.NOT_FOUND,details:"No server data found for id "+i})}function R(e,t){const i=Number.parseInt(e.request.max_results),n=[];let s=Number.parseInt(e.request.start_server_id);for(;s<g.length;s++){const e=g[s];if(void 0!==e&&(n.push(_(e)),n.length>=i))break}t(null,{server:n,end:s>=g.length})}function x(e,t){const i=Number.parseInt(e.request.subchannel_id),n=m[i];if(void 0===n)return void t({code:r.Status.NOT_FOUND,details:"No subchannel data found for id "+i});const s=n.getInfo();t(null,{subchannel:{ref:u(n.ref),data:{target:s.target,state:b(s.state),calls_started:s.callTracker.callsStarted,calls_succeeded:s.callTracker.callsSucceeded,calls_failed:s.callTracker.callsFailed,last_call_started_timestamp:C(s.callTracker.lastCallStartedTimestamp),trace:s.trace.getTraceMessage()},socket_ref:s.children.sockets.map((e=>h(e)))}})}function A(e){var t;return(0,a.isTcpSubchannelAddress)(e)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(t=S(e.host))&&void 0!==t?t:void 0,port:e.port}}:{address:"uds_address",uds_address:{filename:e.path}}}function N(e,t){var i,n,s,a,o;const l=Number.parseInt(e.request.socket_id),c=v[l];if(void 0===c)return void t({code:r.Status.NOT_FOUND,details:"No socket data found for id "+l});const u=c.getInfo(),d=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(i=u.security.cipherSuiteStandardName)&&void 0!==i?i:void 0,other_name:null!==(n=u.security.cipherSuiteOtherName)&&void 0!==n?n:void 0,local_certificate:null!==(s=u.security.localCertificate)&&void 0!==s?s:void 0,remote_certificate:null!==(a=u.security.remoteCertificate)&&void 0!==a?a:void 0}}:null;t(null,{socket:{ref:h(c.ref),local:u.localAddress?A(u.localAddress):null,remote:u.remoteAddress?A(u.remoteAddress):null,remote_name:null!==(o=u.remoteName)&&void 0!==o?o:void 0,security:d,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:C(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:C(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:C(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:C(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}}})}function O(e,t){const i=Number.parseInt(e.request.server_id),n=g[i];if(void 0===n)return void t({code:r.Status.NOT_FOUND,details:"No server data found for id "+i});const s=Number.parseInt(e.request.start_socket_id),a=Number.parseInt(e.request.max_results),o=n.getInfo().sessionChildren.sockets.sort(((e,t)=>e.id-t.id)),l=[];let c=0;for(;c<o.length&&!(o[c].id>=s&&(l.push(h(o[c])),l.length>=a));c++);t(null,{socket_ref:l,end:c>=o.length})}function M(){return{GetChannel:E,GetTopChannels:w,GetServer:k,GetServers:R,GetSubchannel:x,GetSocket:N,GetServerSockets:O}}t.registerChannelzChannel=function(e,t,i){const n=f(),s={id:n,name:e,kind:"channel"};return i&&(p[n]={ref:s,getInfo:t}),s},t.registerChannelzSubchannel=function(e,t,i){const n=f(),s={id:n,name:e,kind:"subchannel"};return i&&(m[n]={ref:s,getInfo:t}),s},t.registerChannelzServer=function(e,t){const i=f(),n={id:i,kind:"server"};return t&&(g[i]={ref:n,getInfo:e}),n},t.registerChannelzSocket=function(e,t,i){const n=f(),s={id:n,name:e,kind:"socket"};return i&&(v[n]={ref:s,getInfo:t}),s},t.unregisterChannelzRef=function(e){switch(e.kind){case"channel":return void delete p[e.id];case"subchannel":return void delete m[e.id];case"server":return void delete g[e.id];case"socket":return void delete v[e.id]}},t.getChannelzHandlers=M;let P=null;function I(){if(P)return P;const e=(0,i(9421).loadSync)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]}),t=(0,l.loadPackageDefinition)(e);return P=t.grpc.channelz.v1.Channelz.service,P}t.getChannelzServiceDefinition=I,t.setup=function(){(0,o.registerAdminService)(I,M)}},3740:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInterceptingCall=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.InterceptorConfigurationError=void 0;const n=i(4664),s=i(8183),r=i(3189),a=i(5503);class o extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,o)}}t.InterceptorConfigurationError=o,t.ListenerBuilder=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}},t.RequesterBuilder=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};const l={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveStatus:(e,t)=>{t(e)}},c={start:(e,t,i)=>{i(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};t.InterceptingCall=class{constructor(e,t){var i,n,s,r;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,this.requester=t?{start:null!==(i=t.start)&&void 0!==i?i:c.start,sendMessage:null!==(n=t.sendMessage)&&void 0!==n?n:c.sendMessage,halfClose:null!==(s=t.halfClose)&&void 0!==s?s:c.halfClose,cancel:null!==(r=t.cancel)&&void 0!==r?r:c.cancel}:c}cancelWithStatus(e,t){this.requester.cancel((()=>{this.nextCall.cancelWithStatus(e,t)}))}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var i,n,r,a,o,c;const u={onReceiveMetadata:null!==(n=null===(i=null==t?void 0:t.onReceiveMetadata)||void 0===i?void 0:i.bind(t))&&void 0!==n?n:e=>{},onReceiveMessage:null!==(a=null===(r=null==t?void 0:t.onReceiveMessage)||void 0===r?void 0:r.bind(t))&&void 0!==a?a:e=>{},onReceiveStatus:null!==(c=null===(o=null==t?void 0:t.onReceiveStatus)||void 0===o?void 0:o.bind(t))&&void 0!==c?c:e=>{}};this.processingMetadata=!0,this.requester.start(e,u,((e,t)=>{var i,n,r;let a;if(this.processingMetadata=!1,(0,s.isInterceptingListener)(t))a=t;else{const e={onReceiveMetadata:null!==(i=t.onReceiveMetadata)&&void 0!==i?i:l.onReceiveMetadata,onReceiveMessage:null!==(n=t.onReceiveMessage)&&void 0!==n?n:l.onReceiveMessage,onReceiveStatus:null!==(r=t.onReceiveStatus)&&void 0!==r?r:l.onReceiveStatus};a=new s.InterceptingListenerImpl(e,u)}this.nextCall.start(e,a),this.processPendingMessage(),this.processPendingHalfClose()}))}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,(i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,i),this.processPendingHalfClose())}))}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose((()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()}))}};class u{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let i;try{i=this.methodDefinition.requestSerialize(t)}catch(e){return void this.call.cancelWithStatus(r.Status.INTERNAL,`Request message serialization failure: ${(0,a.getErrorMessage)(e)}`)}this.call.sendMessageWithContext(e,i)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let i=null;this.call.start(e,{onReceiveMetadata:e=>{var i;null===(i=null==t?void 0:t.onReceiveMetadata)||void 0===i||i.call(t,e)},onReceiveMessage:e=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(e)}catch(e){return i={code:r.Status.INTERNAL,details:`Response message parsing error: ${(0,a.getErrorMessage)(e)}`,metadata:new n.Metadata},void this.call.cancelWithStatus(i.code,i.details)}null===(s=null==t?void 0:t.onReceiveMessage)||void 0===s||s.call(t,o)},onReceiveStatus:e=>{var n,s;i?null===(n=null==t?void 0:t.onReceiveStatus)||void 0===n||n.call(t,i):null===(s=null==t?void 0:t.onReceiveStatus)||void 0===s||s.call(t,e)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class h extends u{constructor(e,t){super(e,t)}start(e,t){var i,n;let s=!1;const r={onReceiveMetadata:null!==(n=null===(i=null==t?void 0:t.onReceiveMetadata)||void 0===i?void 0:i.bind(t))&&void 0!==n?n:e=>{},onReceiveMessage:e=>{var i;s=!0,null===(i=null==t?void 0:t.onReceiveMessage)||void 0===i||i.call(t,e)},onReceiveStatus:e=>{var i,n;s||null===(i=null==t?void 0:t.onReceiveMessage)||void 0===i||i.call(t,null),null===(n=null==t?void 0:t.onReceiveStatus)||void 0===n||n.call(t,e)}};super.start(e,r),this.call.startRead()}}class d extends u{}t.getInterceptingCall=function(e,t,i,n){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let s=[];s=e.callInterceptors.length>0||e.callInterceptorProviders.length>0?[].concat(e.callInterceptors,e.callInterceptorProviders.map((e=>e(t)))).filter((e=>e)):[].concat(e.clientInterceptors,e.clientInterceptorProviders.map((e=>e(t)))).filter((e=>e));const r=Object.assign({},i,{method_definition:t});return s.reduceRight(((e,t)=>i=>t(i,e)),(e=>function(e,t,i){const n=function(e,t,i){var n,s;const r=null!==(n=i.deadline)&&void 0!==n?n:1/0,a=i.host,o=null!==(s=i.parent)&&void 0!==s?s:null,l=i.propagate_flags,c=i.credentials,u=e.createCall(t,r,a,o,l);return c&&u.setCredentials(c),u}(e,i.path,t);return i.responseStream?new d(n,i):new h(n,i)}(n,e,t)))(r)}},8279:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const n=i(3509),s=i(2253),r=i(207),a=i(3189),o=i(4664),l=i(3740),c=Symbol(),u=Symbol(),h=Symbol(),d=Symbol();function f(e){return"function"==typeof e}function p(e){return e.stack.split("\n").slice(1).join("\n")}t.Client=class{constructor(e,t,i={}){var n,r;if(i=Object.assign({},i),this[u]=null!==(n=i.interceptors)&&void 0!==n?n:[],delete i.interceptors,this[h]=null!==(r=i.interceptor_providers)&&void 0!==r?r:[],delete i.interceptor_providers,this[u].length>0&&this[h].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[d]=i.callInvocationTransformer,delete i.callInvocationTransformer,i.channelOverride)this[c]=i.channelOverride;else if(i.channelFactoryOverride){const n=i.channelFactoryOverride;delete i.channelFactoryOverride,this[c]=n(e,t,i)}else this[c]=new s.ChannelImplementation(e,t,i)}close(){this[c].close()}getChannel(){return this[c]}waitForReady(e,t){const i=n=>{if(n)return void t(new Error("Failed to connect before the deadline"));let s;try{s=this[c].getConnectivityState(!0)}catch(e){return void t(new Error("The channel has been closed"))}if(s===r.ConnectivityState.READY)t();else try{this[c].watchConnectivityState(s,e,i)}catch(e){t(new Error("The channel has been closed"))}};setImmediate(i)}checkOptionalUnaryResponseArguments(e,t,i){if(f(e))return{metadata:new o.Metadata,options:{},callback:e};if(f(t))return e instanceof o.Metadata?{metadata:e,options:{},callback:t}:{metadata:new o.Metadata,options:e,callback:t};if(!(e instanceof o.Metadata&&t instanceof Object&&f(i)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:i}}makeUnaryRequest(e,t,i,s,r,o,f){var m,g;const v=this.checkOptionalUnaryResponseArguments(r,o,f),y={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:i};let S={argument:s,metadata:v.metadata,call:new n.ClientUnaryCallImpl,channel:this[c],methodDefinition:y,callOptions:v.options,callback:v.callback};this[d]&&(S=this[d](S));const b=S.call,C={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!==(m=S.callOptions.interceptors)&&void 0!==m?m:[],callInterceptorProviders:null!==(g=S.callOptions.interceptor_providers)&&void 0!==g?g:[]},T=(0,l.getInterceptingCall)(C,S.methodDefinition,S.callOptions,S.channel);b.call=T;let E=null,w=!1;const _=new Error;return T.start(S.metadata,{onReceiveMetadata:e=>{b.emit("metadata",e)},onReceiveMessage(e){null!==E&&T.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),E=e},onReceiveStatus(e){if(!w){if(w=!0,e.code===a.Status.OK)if(null===E){const t=p(_);S.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else S.callback(null,E);else{const t=p(_);S.callback((0,n.callErrorFromStatus)(e,t))}b.emit("status",e)}}}),T.sendMessage(s),T.halfClose(),b}makeClientStreamRequest(e,t,i,s,r,o){var f,m;const g=this.checkOptionalUnaryResponseArguments(s,r,o),v={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:i};let y={metadata:g.metadata,call:new n.ClientWritableStreamImpl(t),channel:this[c],methodDefinition:v,callOptions:g.options,callback:g.callback};this[d]&&(y=this[d](y));const S=y.call,b={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!==(f=y.callOptions.interceptors)&&void 0!==f?f:[],callInterceptorProviders:null!==(m=y.callOptions.interceptor_providers)&&void 0!==m?m:[]},C=(0,l.getInterceptingCall)(b,y.methodDefinition,y.callOptions,y.channel);S.call=C;let T=null,E=!1;const w=new Error;return C.start(y.metadata,{onReceiveMetadata:e=>{S.emit("metadata",e)},onReceiveMessage(e){null!==T&&C.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),T=e},onReceiveStatus(e){if(!E){if(E=!0,e.code===a.Status.OK)if(null===T){const t=p(w);y.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else y.callback(null,T);else{const t=p(w);y.callback((0,n.callErrorFromStatus)(e,t))}S.emit("status",e)}}}),S}checkMetadataAndOptions(e,t){let i,n;return e instanceof o.Metadata?(i=e,n=t||{}):(n=e||{},i=new o.Metadata),{metadata:i,options:n}}makeServerStreamRequest(e,t,i,s,r,o){var f,m;const g=this.checkMetadataAndOptions(r,o),v={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:i};let y={argument:s,metadata:g.metadata,call:new n.ClientReadableStreamImpl(i),channel:this[c],methodDefinition:v,callOptions:g.options};this[d]&&(y=this[d](y));const S=y.call,b={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!==(f=y.callOptions.interceptors)&&void 0!==f?f:[],callInterceptorProviders:null!==(m=y.callOptions.interceptor_providers)&&void 0!==m?m:[]},C=(0,l.getInterceptingCall)(b,y.methodDefinition,y.callOptions,y.channel);S.call=C;let T=!1;const E=new Error;return C.start(y.metadata,{onReceiveMetadata(e){S.emit("metadata",e)},onReceiveMessage(e){S.push(e)},onReceiveStatus(e){if(!T){if(T=!0,S.push(null),e.code!==a.Status.OK){const t=p(E);S.emit("error",(0,n.callErrorFromStatus)(e,t))}S.emit("status",e)}}}),C.sendMessage(s),C.halfClose(),S}makeBidiStreamRequest(e,t,i,s,r){var o,f;const m=this.checkMetadataAndOptions(s,r),g={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:i};let v={metadata:m.metadata,call:new n.ClientDuplexStreamImpl(t,i),channel:this[c],methodDefinition:g,callOptions:m.options};this[d]&&(v=this[d](v));const y=v.call,S={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!==(o=v.callOptions.interceptors)&&void 0!==o?o:[],callInterceptorProviders:null!==(f=v.callOptions.interceptor_providers)&&void 0!==f?f:[]},b=(0,l.getInterceptingCall)(S,v.methodDefinition,v.callOptions,v.channel);y.call=b;let C=!1;const T=new Error;return b.start(v.metadata,{onReceiveMetadata(e){y.emit("metadata",e)},onReceiveMessage(e){y.push(e)},onReceiveStatus(e){if(!C){if(C=!0,y.push(null),e.code!==a.Status.OK){const t=p(T);y.emit("error",(0,n.callErrorFromStatus)(e,t))}y.emit("status",e)}}}),y}}},9852:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionAlgorithms=void 0,(i=t.CompressionAlgorithms||(t.CompressionAlgorithms={}))[i.identity=0]="identity",i[i.deflate=1]="deflate",i[i.gzip=2]="gzip"},4930:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompressionFilterFactory=t.CompressionFilter=void 0;const n=i(9796),s=i(9852),r=i(3189),a=i(6994),o=i(8626);class l{async writeMessage(e,t){let i=e;t&&(i=await this.compressMessage(i));const n=Buffer.allocUnsafe(i.length+5);return n.writeUInt8(t?1:0,0),n.writeUInt32BE(i.length,1),i.copy(n,5),n}async readMessage(e){const t=1===e.readUInt8(0);let i=e.slice(5);return t&&(i=await this.decompressMessage(i)),i}}class c extends l{async compressMessage(e){return e}async writeMessage(e,t){const i=Buffer.allocUnsafe(e.length+5);return i.writeUInt8(0,0),i.writeUInt32BE(e.length,1),e.copy(i,5),i}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}}class u extends l{compressMessage(e){return new Promise(((t,i)=>{n.deflate(e,((e,n)=>{e?i(e):t(n)}))}))}decompressMessage(e){return new Promise(((t,i)=>{n.inflate(e,((e,n)=>{e?i(e):t(n)}))}))}}class h extends l{compressMessage(e){return new Promise(((t,i)=>{n.gzip(e,((e,n)=>{e?i(e):t(n)}))}))}decompressMessage(e){return new Promise(((t,i)=>{n.unzip(e,((e,n)=>{e?i(e):t(n)}))}))}}class d extends l{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}}function f(e){switch(e){case"identity":return new c;case"deflate":return new u;case"gzip":return new h;default:return new d(e)}}class p extends a.BaseFilter{constructor(e,t){var i;super(),this.sharedFilterConfig=t,this.sendCompression=new c,this.receiveCompression=new c,this.currentCompressionAlgorithm="identity";const n=e["grpc.default_compression_algorithm"];if(void 0!==n)if("number"==typeof(a=n)&&"string"==typeof s.CompressionAlgorithms[a]){const e=s.CompressionAlgorithms[n],r=null===(i=t.serverSupportedEncodingHeader)||void 0===i?void 0:i.split(",");r&&!r.includes(e)||(this.currentCompressionAlgorithm=e,this.sendCompression=f(this.currentCompressionAlgorithm))}else o.log(r.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${n}`);var a}async sendMetadata(e){const t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){const t=e.get("grpc-encoding");if(t.length>0){const e=t[0];"string"==typeof e&&(this.receiveCompression=f(e))}e.remove("grpc-encoding");const i=e.get("grpc-accept-encoding")[0];return i&&(this.sharedFilterConfig.serverSupportedEncodingHeader=i,i.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new c,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;const i=await e;let n;return n=!(this.sendCompression instanceof c)&&0==(2&(null!==(t=i.flags)&&void 0!==t?t:0)),{message:await this.sendCompression.writeMessage(i.message,n),flags:i.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}t.CompressionFilter=p,t.CompressionFilterFactory=class{constructor(e,t){this.channel=e,this.options=t,this.sharedFilterConfig={}}createFilter(){return new p(this.options,this.sharedFilterConfig)}}},207:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectivityState=void 0,(i=t.ConnectivityState||(t.ConnectivityState={}))[i.IDLE=0]="IDLE",i[i.CONNECTING=1]="CONNECTING",i[i.READY=2]="READY",i[i.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",i[i.SHUTDOWN=4]="SHUTDOWN"},3189:(e,t)=>{"use strict";var i,n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=t.Propagate=t.LogVerbosity=t.Status=void 0,(s=t.Status||(t.Status={}))[s.OK=0]="OK",s[s.CANCELLED=1]="CANCELLED",s[s.UNKNOWN=2]="UNKNOWN",s[s.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",s[s.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",s[s.NOT_FOUND=5]="NOT_FOUND",s[s.ALREADY_EXISTS=6]="ALREADY_EXISTS",s[s.PERMISSION_DENIED=7]="PERMISSION_DENIED",s[s.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",s[s.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",s[s.ABORTED=10]="ABORTED",s[s.OUT_OF_RANGE=11]="OUT_OF_RANGE",s[s.UNIMPLEMENTED=12]="UNIMPLEMENTED",s[s.INTERNAL=13]="INTERNAL",s[s.UNAVAILABLE=14]="UNAVAILABLE",s[s.DATA_LOSS=15]="DATA_LOSS",s[s.UNAUTHENTICATED=16]="UNAUTHENTICATED",(n=t.LogVerbosity||(t.LogVerbosity={}))[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",(i=t.Propagate||(t.Propagate={}))[i.DEADLINE=1]="DEADLINE",i[i.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",i[i.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",i[i.CANCELLATION=8]="CANCELLATION",i[i.DEFAULTS=65535]="DEFAULTS",t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},4617:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restrictControlPlaneStatusCode=void 0;const n=i(3189),s=[n.Status.OK,n.Status.INVALID_ARGUMENT,n.Status.NOT_FOUND,n.Status.ALREADY_EXISTS,n.Status.FAILED_PRECONDITION,n.Status.ABORTED,n.Status.OUT_OF_RANGE,n.Status.DATA_LOSS];t.restrictControlPlaneStatusCode=function(e,t){return s.includes(e)?{code:n.Status.INTERNAL,details:`Invalid status from control plane: ${e} ${n.Status[e]} ${t}`}:{code:e,details:t}}},1128:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRelativeTimeout=t.getDeadlineTimeoutString=t.minDeadline=void 0,t.minDeadline=function(...e){let t=1/0;for(const i of e){const e=i instanceof Date?i.getTime():i;e<t&&(t=e)}return t};const i=[["m",1],["S",1e3],["M",6e4],["H",36e5]];t.getDeadlineTimeoutString=function(e){const t=(new Date).getTime();e instanceof Date&&(e=e.getTime());const n=Math.max(e-t,0);for(const[e,t]of i){const i=n/t;if(i<1e8)return String(Math.ceil(i))+e}throw new Error("Deadline is too far in the future")},t.getRelativeTimeout=function(e){return(e instanceof Date?e.getTime():e)-(new Date).getTime()}},5484:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDuration=t.durationToMs=t.msToDuration=void 0,t.msToDuration=function(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}},t.durationToMs=function(e){return 1e3*e.seconds+e.nanos/1e6|0},t.isDuration=function(e){return"number"==typeof e.seconds&&"number"==typeof e.nanos}},5503:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorCode=t.getErrorMessage=void 0,t.getErrorMessage=function(e){return e instanceof Error?e.message:String(e)},t.getErrorCode=function(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.code?e.code:null}},495:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlierDetectionLoadBalancingConfig=t.BaseSubchannelWrapper=t.registerAdminService=t.FilterStackFactory=t.BaseFilter=t.PickResultType=t.QueuePicker=t.UnavailablePicker=t.ChildLoadBalancerHandler=t.subchannelAddressToString=t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.registerLoadBalancerType=t.createChildChannelControlHelper=t.BackoffTimeout=t.durationToMs=t.uriToString=t.registerResolver=t.log=t.trace=void 0;var n=i(8626);Object.defineProperty(t,"trace",{enumerable:!0,get:function(){return n.trace}}),Object.defineProperty(t,"log",{enumerable:!0,get:function(){return n.log}});var s=i(3513);Object.defineProperty(t,"registerResolver",{enumerable:!0,get:function(){return s.registerResolver}});var r=i(5165);Object.defineProperty(t,"uriToString",{enumerable:!0,get:function(){return r.uriToString}});var a=i(5484);Object.defineProperty(t,"durationToMs",{enumerable:!0,get:function(){return a.durationToMs}});var o=i(3510);Object.defineProperty(t,"BackoffTimeout",{enumerable:!0,get:function(){return o.BackoffTimeout}});var l=i(1192);Object.defineProperty(t,"createChildChannelControlHelper",{enumerable:!0,get:function(){return l.createChildChannelControlHelper}}),Object.defineProperty(t,"registerLoadBalancerType",{enumerable:!0,get:function(){return l.registerLoadBalancerType}}),Object.defineProperty(t,"getFirstUsableConfig",{enumerable:!0,get:function(){return l.getFirstUsableConfig}}),Object.defineProperty(t,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return l.validateLoadBalancingConfig}});var c=i(8741);Object.defineProperty(t,"subchannelAddressToString",{enumerable:!0,get:function(){return c.subchannelAddressToString}});var u=i(4487);Object.defineProperty(t,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return u.ChildLoadBalancerHandler}});var h=i(4219);Object.defineProperty(t,"UnavailablePicker",{enumerable:!0,get:function(){return h.UnavailablePicker}}),Object.defineProperty(t,"QueuePicker",{enumerable:!0,get:function(){return h.QueuePicker}}),Object.defineProperty(t,"PickResultType",{enumerable:!0,get:function(){return h.PickResultType}});var d=i(6994);Object.defineProperty(t,"BaseFilter",{enumerable:!0,get:function(){return d.BaseFilter}});var f=i(1882);Object.defineProperty(t,"FilterStackFactory",{enumerable:!0,get:function(){return f.FilterStackFactory}});var p=i(1265);Object.defineProperty(t,"registerAdminService",{enumerable:!0,get:function(){return p.registerAdminService}});var m=i(8862);Object.defineProperty(t,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return m.BaseSubchannelWrapper}});var g=i(3002);Object.defineProperty(t,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return g.OutlierDetectionLoadBalancingConfig}})},1882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterStackFactory=t.FilterStack=void 0;class i{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMessage(t);return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}t.FilterStack=i;class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new i(this.factories.map((e=>e.createFilter())))}}t.FilterStackFactory=n},6994:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFilter=void 0,t.BaseFilter=class{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}}},6042:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxiedConnection=t.mapProxyName=void 0;const n=i(8626),s=i(3189),r=i(3513),a=i(3685),o=i(4404),l=i(8626),c=i(8741),u=i(5165),h=i(7310);function d(e){l.trace(s.LogVerbosity.DEBUG,"proxy",e)}t.mapProxyName=function(e,t){var i;const r={target:e,extraOptions:{}};if(0===(null!==(i=t["grpc.enable_http_proxy"])&&void 0!==i?i:1))return r;if("unix"===e.scheme)return r;const a=function(){let e,t="",i="";if(process.env.grpc_proxy)i="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)i="https_proxy",t=process.env.https_proxy;else{if(!process.env.http_proxy)return{};i="http_proxy",t=process.env.http_proxy}try{e=new h.URL(t)}catch(e){return(0,n.log)(s.LogVerbosity.ERROR,`cannot parse value of "${i}" env var`),{}}if("http:"!==e.protocol)return(0,n.log)(s.LogVerbosity.ERROR,`"${e.protocol}" scheme not supported in proxy URI`),{};let r=null;e.username&&(e.password?((0,n.log)(s.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${e.username}:${e.password}`):r=e.username);const a=e.hostname;let o=e.port;""===o&&(o="80");const l={address:`${a}:${o}`};return r&&(l.creds=r),d("Proxy server "+l.address+" set by environment variable "+i),l}();if(!a.address)return r;const o=(0,u.splitHostPort)(e.path);if(!o)return r;const l=o.host;for(const t of function(){let e=process.env.no_grpc_proxy,t="no_grpc_proxy";return e||(e=process.env.no_proxy,t="no_proxy"),e?(d("No proxy server list set by environment variable "+t),e.split(",")):[]}())if(t===l)return d("Not using proxy for target in no_proxy list: "+(0,u.uriToString)(e)),r;const c={"grpc.http_connect_target":(0,u.uriToString)(e)};return a.creds&&(c["grpc.http_connect_creds"]=a.creds),{target:{scheme:"dns",path:a.address},extraOptions:c}},t.getProxiedConnection=function(e,t,i){if(!("grpc.http_connect_target"in t))return Promise.resolve({});const l=t["grpc.http_connect_target"],h=(0,u.parseUri)(l);if(null===h)return Promise.resolve({});const f={method:"CONNECT",path:h.path},p={Host:h.path};(0,c.isTcpSubchannelAddress)(e)?(f.host=e.host,f.port=e.port):f.socketPath=e.path,"grpc.http_connect_creds"in t&&(p["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")),f.headers=p;const m=(0,c.subchannelAddressToString)(e);return d("Using proxy "+m+" to connect to "+f.path),new Promise(((e,t)=>{const l=a.request(f);l.once("connect",((a,c,p)=>{var g;if(l.removeAllListeners(),c.removeAllListeners(),200===a.statusCode)if(d("Successfully connected to "+f.path+" through proxy "+m),"secureContext"in i){const n=(0,r.getDefaultAuthority)(h),s=(0,u.splitHostPort)(n),a=null!==(g=null==s?void 0:s.host)&&void 0!==g?g:n,l=o.connect(Object.assign({host:a,servername:a,socket:c},i),(()=>{d("Successfully established a TLS connection to "+f.path+" through proxy "+m),e({socket:l,realTarget:h})}));l.on("error",(e=>{d("Failed to establish a TLS connection to "+f.path+" through proxy "+m+" with error "+e.message),t()}))}else d("Successfully established a plaintext connection to "+f.path+" through proxy "+m),e({socket:c,realTarget:h});else(0,n.log)(s.LogVerbosity.ERROR,"Failed to connect to "+f.path+" through proxy "+m+" with status "+a.statusCode),t()})),l.once("error",(e=>{l.removeAllListeners(),(0,n.log)(s.LogVerbosity.ERROR,"Failed to connect to proxy "+m+" with error "+e.message),t()})),l.end()}))}},6636:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimental=t.addAdminServicesToServer=t.getChannelzHandlers=t.getChannelzServiceDefinition=t.InterceptorConfigurationError=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.StatusBuilder=t.getClientChannel=t.ServerCredentials=t.Server=t.setLogVerbosity=t.setLogger=t.load=t.loadObject=t.CallCredentials=t.ChannelCredentials=t.waitForClientReady=t.closeClient=t.Channel=t.makeGenericClientConstructor=t.makeClientConstructor=t.loadPackageDefinition=t.Client=t.compressionAlgorithms=t.propagate=t.connectivityState=t.status=t.logVerbosity=t.Metadata=t.credentials=void 0;const n=i(9587);Object.defineProperty(t,"CallCredentials",{enumerable:!0,get:function(){return n.CallCredentials}});const s=i(2253);Object.defineProperty(t,"Channel",{enumerable:!0,get:function(){return s.ChannelImplementation}});const r=i(9852);Object.defineProperty(t,"compressionAlgorithms",{enumerable:!0,get:function(){return r.CompressionAlgorithms}});const a=i(207);Object.defineProperty(t,"connectivityState",{enumerable:!0,get:function(){return a.ConnectivityState}});const o=i(9357);Object.defineProperty(t,"ChannelCredentials",{enumerable:!0,get:function(){return o.ChannelCredentials}});const l=i(8279);Object.defineProperty(t,"Client",{enumerable:!0,get:function(){return l.Client}});const c=i(3189);Object.defineProperty(t,"logVerbosity",{enumerable:!0,get:function(){return c.LogVerbosity}}),Object.defineProperty(t,"status",{enumerable:!0,get:function(){return c.Status}}),Object.defineProperty(t,"propagate",{enumerable:!0,get:function(){return c.Propagate}});const u=i(8626),h=i(2011);Object.defineProperty(t,"loadPackageDefinition",{enumerable:!0,get:function(){return h.loadPackageDefinition}}),Object.defineProperty(t,"makeClientConstructor",{enumerable:!0,get:function(){return h.makeClientConstructor}}),Object.defineProperty(t,"makeGenericClientConstructor",{enumerable:!0,get:function(){return h.makeClientConstructor}});const d=i(4664);Object.defineProperty(t,"Metadata",{enumerable:!0,get:function(){return d.Metadata}});const f=i(903);Object.defineProperty(t,"Server",{enumerable:!0,get:function(){return f.Server}});const p=i(5919);Object.defineProperty(t,"ServerCredentials",{enumerable:!0,get:function(){return p.ServerCredentials}});const m=i(930);Object.defineProperty(t,"StatusBuilder",{enumerable:!0,get:function(){return m.StatusBuilder}}),t.credentials={combineChannelCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),combineCallCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),createInsecure:o.ChannelCredentials.createInsecure,createSsl:o.ChannelCredentials.createSsl,createFromSecureContext:o.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:n.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:n.CallCredentials.createFromGoogleCredential,createEmpty:n.CallCredentials.createEmpty},t.closeClient=e=>e.close(),t.waitForClientReady=(e,t,i)=>e.waitForReady(t,i),t.loadObject=(e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},t.load=(e,t,i)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},t.setLogger=e=>{u.setLogger(e)},t.setLogVerbosity=e=>{u.setLoggerVerbosity(e)},t.getClientChannel=e=>l.Client.prototype.getChannel.call(e);var g=i(3740);Object.defineProperty(t,"ListenerBuilder",{enumerable:!0,get:function(){return g.ListenerBuilder}}),Object.defineProperty(t,"RequesterBuilder",{enumerable:!0,get:function(){return g.RequesterBuilder}}),Object.defineProperty(t,"InterceptingCall",{enumerable:!0,get:function(){return g.InterceptingCall}}),Object.defineProperty(t,"InterceptorConfigurationError",{enumerable:!0,get:function(){return g.InterceptorConfigurationError}});var v=i(8950);Object.defineProperty(t,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return v.getChannelzServiceDefinition}}),Object.defineProperty(t,"getChannelzHandlers",{enumerable:!0,get:function(){return v.getChannelzHandlers}});var y=i(1265);Object.defineProperty(t,"addAdminServicesToServer",{enumerable:!0,get:function(){return y.addAdminServicesToServer}});const S=i(495);t.experimental=S;const b=i(6982),C=i(1350),T=i(8733),E=i(6659),w=i(5174),_=i(3002),k=i(8950),R=i(6569).i8;u.trace(c.LogVerbosity.DEBUG,"index","Loading @grpc/grpc-js version "+R),b.setup(),C.setup(),T.setup(),E.setup(),w.setup(),_.setup(),k.setup()},2805:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalChannel=void 0;const n=i(9357),s=i(3970),r=i(651),a=i(4219),o=i(3189),l=i(1882),c=i(4930),u=i(3513),h=i(8626),d=i(2829),f=i(6042),p=i(5165),m=i(207),g=i(8950),v=i(9600),y=i(4692),S=i(868),b=i(4617),C=i(859),T=new Map;t.InternalChannel=class{constructor(e,t,i){var v,y,S,E,w,_;if(this.credentials=t,this.options=i,this.connectivityState=m.ConnectivityState.IDLE,this.currentPicker=new a.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.channelzEnabled=!0,this.callTracker=new g.ChannelzCallTracker,this.childrenTracker=new g.ChannelzChildrenTracker,"string"!=typeof e)throw new TypeError("Channel target must be a string");if(!(t instanceof n.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&"object"!=typeof i)throw new TypeError("Channel options must be an object");this.originalTarget=e;const k=(0,p.parseUri)(e);if(null===k)throw new Error(`Could not parse target name "${e}"`);const R=(0,u.mapUriDefaultScheme)(k);if(null===R)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval((()=>{}),2147483647),null===(y=(v=this.callRefTimer).unref)||void 0===y||y.call(v),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new g.ChannelzTrace,this.channelzRef=(0,g.registerChannelzChannel)(e,(()=>this.getChannelzInfo()),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,u.getDefaultAuthority)(R);const x=(0,f.mapProxyName)(R,i);this.target=x.target,this.options=Object.assign({},this.options,x.extraOptions),this.subchannelPool=(0,r.getSubchannelPool)(0===(null!==(S=i["grpc.use_local_subchannel_pool"])&&void 0!==S?S:0)),this.retryBufferTracker=new C.MessageBufferTracker(null!==(E=i["grpc.retry_buffer_size"])&&void 0!==E?E:16777216,null!==(w=i["grpc.per_rpc_retry_buffer_size"])&&void 0!==w?w:1048576);const A={createSubchannel:(e,t)=>{const i=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);return this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",i.getChannelzRef()),i},updateState:(e,t)=>{this.currentPicker=t;const i=this.pickQueue.slice();this.pickQueue=[],this.callRefTimerUnref();for(const e of i)e.doPick();this.updateState(e)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.refChild(e)},removeChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.unrefChild(e)}};this.resolvingLoadBalancer=new s.ResolvingLoadBalancer(this.target,A,i,((e,t)=>{e.retryThrottling?T.set(this.getTarget(),new C.RetryThrottler(e.retryThrottling.maxTokens,e.retryThrottling.tokenRatio,T.get(this.getTarget()))):T.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=t,this.currentResolutionError=null,process.nextTick((()=>{const e=this.configSelectionQueue;this.configSelectionQueue=[],this.callRefTimerUnref();for(const t of e)t.getConfig();this.configSelectionQueue=[]}))}),(e=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,b.restrictControlPlaneStatusCode)(e.code,e.details)),{metadata:e.metadata}));const t=this.configSelectionQueue;this.configSelectionQueue=[],this.callRefTimerUnref();for(const i of t)i.reportResolverError(e)})),this.filterStackFactory=new l.FilterStackFactory([new d.MaxMessageSizeFilterFactory(this.options),new c.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(i,void 0,2));const N=new Error;(0,h.trace)(o.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(_=N.stack)||void 0===_?void 0:_.substring(N.stack.indexOf("\n")+1)))}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,h.trace)(null!=t?t:o.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,p.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,i,n;(null===(t=(e=this.callRefTimer).hasRef)||void 0===t?void 0:t.call(e))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(n=(i=this.callRefTimer).ref)||void 0===n||n.call(i))}callRefTimerUnref(){var e,t;this.callRefTimer.hasRef&&!this.callRefTimer.hasRef()||(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(t=(e=this.callRefTimer).unref)||void 0===t||t.call(e))}removeConnectivityStateWatcher(e){const t=this.connectivityStateWatchers.findIndex((t=>t===e));t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,h.trace)(o.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,p.uriToString)(this.target)+" "+m.ConnectivityState[this.connectivityState]+" -> "+m.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO",m.ConnectivityState[this.connectivityState]+" -> "+m.ConnectivityState[e]),this.connectivityState=e;const t=this.connectivityStateWatchers.slice();for(const i of t)e!==i.currentState&&(i.timer&&clearTimeout(i.timer),this.removeConnectivityStateWatcher(i),i.callback());e!==m.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}createLoadBalancingCall(e,t,i,n,s){const r=(0,S.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+r+'] method="'+t+'"'),new v.LoadBalancingCall(this,e,t,i,n,s,r)}createRetryingCall(e,t,i,n,s){const r=(0,S.getNextCallNumber)();return this.trace("createRetryingCall ["+r+'] method="'+t+'"'),new C.RetryingCall(this,e,t,i,n,s,r,this.retryBufferTracker,T.get(this.getTarget()))}createInnerCall(e,t,i,n,s){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(e,t,i,n,s):this.createRetryingCall(e,t,i,n,s)}createResolvingCall(e,t,i,n,s){const r=(0,S.getNextCallNumber)();this.trace("createResolvingCall ["+r+'] method="'+e+'", deadline='+t);const a={deadline:t,flags:null!=s?s:o.Propagate.DEFAULTS,host:null!=i?i:this.defaultAuthority,parentCall:n},l=new y.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),r);return this.channelzEnabled&&(this.callTracker.addCallStarted(),l.addStatusWatcher((e=>{e.code===o.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}))),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(m.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.channelzEnabled&&(0,g.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,p.uriToString)(this.target)}getConnectivityState(e){const t=this.connectivityState;return e&&this.resolvingLoadBalancer.exitIdle(),t}watchConnectivityState(e,t,i){if(this.connectivityState===m.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let n=null;if(t!==1/0){const e=t instanceof Date?t:new Date(t),r=new Date;if(t===-1/0||e<=r)return void process.nextTick(i,new Error("Deadline passed without connectivity state change"));n=setTimeout((()=>{this.removeConnectivityStateWatcher(s),i(new Error("Deadline passed without connectivity state change"))}),e.getTime()-r.getTime())}const s={currentState:e,callback:i,timer:n};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,i,n,s){if("string"!=typeof e)throw new TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===m.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,i,n,s)}}},4487:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChildLoadBalancerHandler=void 0;const n=i(1192),s=i(207);t.ChildLoadBalancerHandler=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.ChildPolicyHelper=class{constructor(e){this.parent=e,this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var i;if(this.calledByPendingChild()){if(e===s.ConnectivityState.CONNECTING)return;null===(i=this.parent.currentChild)||void 0===i||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;const t=null!==(e=this.parent.pendingChild)&&void 0!==e?e:this.parent.currentChild;this.child===t&&this.parent.channelControlHelper.requestReresolution()}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}updateAddressList(e,t,i){let s;if(null===this.currentChild||this.currentChild.getTypeName()!==t.getLoadBalancerName()){const e=new this.ChildPolicyHelper(this),i=(0,n.createLoadBalancer)(t,e);e.setChild(i),null===this.currentChild?(this.currentChild=i,s=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=i,s=this.pendingChild)}else s=null===this.pendingChild?this.currentChild:this.pendingChild;s.updateAddressList(e,t,i)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return"child_load_balancer_helper"}}},3002:(e,t,i)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.OutlierDetectionLoadBalancer=t.OutlierDetectionLoadBalancingConfig=void 0;const s=i(207),r=i(3189),a=i(5484),o=i(495),l=i(1192),c=i(4487),u=i(4219),h=i(8741),d=i(8862),f=i(8626);function p(e){f.trace(r.LogVerbosity.DEBUG,"outlier_detection",e)}const m="outlier_detection",g="true"===(null!==(n=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==n?n:"true"),v={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},y={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function S(e,t,i,n){if(t in e&&typeof e[t]!==i)throw new Error(`outlier detection config ${n?`${n}.${t}`:t} parse error: expected ${i}, got ${typeof e[t]}`)}function b(e,t,i){const n=i?`${i}.${t}`:t;if(t in e){if(!(0,a.isDuration)(e[t]))throw new Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof e[t]}`);if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=999999999))throw new Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}function C(e,t,i){const n=i?`${i}.${t}`:t;if(S(e,t,"number",i),t in e&&!(e[t]>=0&&e[t]<=100))throw new Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}class T{constructor(e,t,i,n,s,r,a){this.childPolicy=a,this.intervalMs=null!=e?e:1e4,this.baseEjectionTimeMs=null!=t?t:3e4,this.maxEjectionTimeMs=null!=i?i:3e5,this.maxEjectionPercent=null!=n?n:10,this.successRateEjection=s?Object.assign(Object.assign({},v),s):null,this.failurePercentageEjection=r?Object.assign(Object.assign({},y),r):null}getLoadBalancerName(){return m}toJsonObject(){return{interval:(0,a.msToDuration)(this.intervalMs),base_ejection_time:(0,a.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map((e=>e.toJsonObject()))}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new T(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(b(e,"interval"),b(e,"base_ejection_time"),b(e,"max_ejection_time"),C(e,"max_ejection_percent"),"success_rate_ejection"in e){if("object"!=typeof e.success_rate_ejection)throw new Error("outlier detection config success_rate_ejection must be an object");S(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),C(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),S(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),S(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if("object"!=typeof e.failure_percentage_ejection)throw new Error("outlier detection config failure_percentage_ejection must be an object");C(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),C(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),S(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),S(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new T(e.interval?(0,a.durationToMs)(e.interval):null,e.base_ejection_time?(0,a.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a.durationToMs)(e.max_ejection_time):null,null!==(t=e.max_ejection_percent)&&void 0!==t?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(l.validateLoadBalancingConfig))}}t.OutlierDetectionLoadBalancingConfig=T;class E extends d.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener(((e,t,i)=>{if(this.childSubchannelState=i,!this.ejected)for(const e of this.stateListeners)e(this,t,i)}))}getConnectivityState(){return this.ejected?s.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){const t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){const e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(const e of this.stateListeners)e(this,this.childSubchannelState,s.ConnectivityState.TRANSIENT_FAILURE)}uneject(){this.ejected=!1;for(const e of this.stateListeners)e(this,s.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}class w{constructor(){this.activeBucket={success:0,failure:0},this.inactiveBucket={success:0,failure:0}}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket={success:0,failure:0}}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class _{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){const t=this.wrappedPicker.pick(e);if(t.pickResultType===u.PickResultType.COMPLETE){const e=t.subchannel,i=e.getMapEntry();if(i){let n=t.onCallEnded;return this.countCalls&&(n=e=>{var n;e===r.Status.OK?i.counter.addSuccess():i.counter.addFailure(),null===(n=t.onCallEnded)||void 0===n||n.call(t,e)}),Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),onCallEnded:n})}return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel()})}return t}}class k{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new c.ChildLoadBalancerHandler((0,o.createChildChannelControlHelper)(e,{createSubchannel:(t,i)=>{const n=e.createSubchannel(t,i),s=this.addressMap.get((0,h.subchannelAddressToString)(t)),r=new E(n,s);return null!==(null==s?void 0:s.currentEjectionTimestamp)&&r.eject(),null==s||s.subchannelWrappers.push(r),r},updateState:(t,i)=>{t===s.ConnectivityState.READY?e.updateState(t,new _(i,this.isCountingEnabled())):e.updateState(t,i)}})),this.ejectionTimer=setInterval((()=>{}),0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let e=0;for(const t of this.addressMap.values())null!==t.currentEjectionTimestamp&&(e+=1);return 100*e/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;const t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;p("Running success rate check");const i=t.request_volume;let n=0;const s=[];for(const[e,t]of this.addressMap){const r=t.counter.getLastSuccesses(),a=t.counter.getLastFailures();p("Stats for "+e+": successes="+r+" failures="+a+" targetRequestVolume="+i),r+a>=i&&(n+=1,s.push(r/(r+a)))}if(p("Found "+n+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),n<t.minimum_hosts)return;const r=s.reduce(((e,t)=>e+t))/s.length;let a=0;for(const e of s){const t=e-r;a+=t*t}const o=a/s.length,l=Math.sqrt(o),c=r-l*(t.stdev_factor/1e3);p("stdev="+l+" ejectionThreshold="+c);for(const[n,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;const r=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(r+a<i)continue;const o=r/(r+a);if(p("Checking candidate "+n+" successRate="+o),o<c){const i=100*Math.random();p("Candidate "+n+" randomNumber="+i+" enforcement_percentage="+t.enforcement_percentage),i<t.enforcement_percentage&&(p("Ejecting candidate "+n),this.eject(s,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;const t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;p("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let i=0;for(const e of this.addressMap.values())e.counter.getLastSuccesses()+e.counter.getLastFailures()>=t.request_volume&&(i+=1);if(!(i<t.minimum_hosts))for(const[i,n]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;const s=n.counter.getLastSuccesses(),r=n.counter.getLastFailures();if((p("Candidate successes="+s+" failures="+r),!(s+r<t.request_volume))&&100*r/(r+s)>t.threshold){const s=100*Math.random();p("Candidate "+i+" randomNumber="+s+" enforcement_percentage="+t.enforcement_percentage),s<t.enforcement_percentage&&(p("Ejecting candidate "+i),this.eject(n,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(const t of e.subchannelWrappers)t.eject()}uneject(e){e.currentEjectionTimestamp=null;for(const t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(const e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,i;this.ejectionTimer=setTimeout((()=>this.runChecks()),e),null===(i=(t=this.ejectionTimer).unref)||void 0===i||i.call(t)}runChecks(){const e=new Date;if(p("Ejection timer running"),this.switchAllBuckets(),this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(const[e,t]of this.addressMap.entries())if(null===t.currentEjectionTimestamp)t.ejectionTimeMultiplier>0&&(t.ejectionTimeMultiplier-=1);else{const i=this.latestConfig.getBaseEjectionTimeMs(),n=this.latestConfig.getMaxEjectionTimeMs(),s=new Date(t.currentEjectionTimestamp.getTime());s.setMilliseconds(s.getMilliseconds()+Math.min(i*t.ejectionTimeMultiplier,Math.max(i,n))),s<new Date&&(p("Unejecting "+e),this.uneject(t))}}}updateAddressList(e,t,i){if(!(t instanceof T))return;const n=new Set;for(const t of e)n.add((0,h.subchannelAddressToString)(t));for(const e of n)this.addressMap.has(e)||(p("Adding map entry for "+e),this.addressMap.set(e,{counter:new w,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(const e of this.addressMap.keys())n.has(e)||(p("Removing map entry for "+e),this.addressMap.delete(e));const s=(0,l.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,i),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){p("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);const e=t.getIntervalMs()-((new Date).getTime()-this.timerStartTime.getTime());this.startTimer(e)}else p("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{p("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(const e of this.addressMap.values())this.uneject(e),e.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return m}}t.OutlierDetectionLoadBalancer=k,t.setup=function(){g&&(0,o.registerLoadBalancerType)(m,k,T)}},6659:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.PickFirstLoadBalancer=t.PickFirstLoadBalancingConfig=void 0;const n=i(1192),s=i(207),r=i(4219),a=i(8741),o=i(8626),l=i(3189);function c(e){o.trace(l.LogVerbosity.DEBUG,"pick_first",e)}const u="pick_first";class h{getLoadBalancerName(){return u}constructor(){}toJsonObject(){return{[u]:{}}}static createFromJson(e){return new h}}t.PickFirstLoadBalancingConfig=h;class d{constructor(e){this.subchannel=e}pick(e){return{pickResultType:r.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}class f{constructor(e){this.channelControlHelper=e,this.latestAddressList=[],this.subchannels=[],this.currentState=s.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.triedAllSubchannels=!1,this.subchannelStateCounts={[s.ConnectivityState.CONNECTING]:0,[s.ConnectivityState.IDLE]:0,[s.ConnectivityState.READY]:0,[s.ConnectivityState.SHUTDOWN]:0,[s.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannelStateListener=(e,t,i)=>{if(this.subchannelStateCounts[t]-=1,this.subchannelStateCounts[i]+=1,e===this.subchannels[this.currentSubchannelIndex]&&i===s.ConnectivityState.TRANSIENT_FAILURE&&this.startNextSubchannelConnecting(),i!==s.ConnectivityState.READY){if(this.triedAllSubchannels&&this.subchannelStateCounts[s.ConnectivityState.IDLE]===this.subchannels.length)return this.resetSubchannelList(!1),void this.updateState(s.ConnectivityState.IDLE,new r.QueuePicker(this));if(null===this.currentPick)if(this.triedAllSubchannels){let e;e=this.subchannelStateCounts[s.ConnectivityState.CONNECTING]>0?s.ConnectivityState.CONNECTING:this.subchannelStateCounts[s.ConnectivityState.TRANSIENT_FAILURE]>0?s.ConnectivityState.TRANSIENT_FAILURE:s.ConnectivityState.IDLE,e!==this.currentState&&(e===s.ConnectivityState.TRANSIENT_FAILURE?this.updateState(e,new r.UnavailablePicker):this.updateState(e,new r.QueuePicker(this)))}else this.updateState(s.ConnectivityState.CONNECTING,new r.QueuePicker(this))}else this.pickSubchannel(e)},this.pickedSubchannelStateListener=(e,t,i)=>{if(i!==s.ConnectivityState.READY)if(this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.pickedSubchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef()),this.subchannels.length>0)if(this.triedAllSubchannels){let e;e=this.subchannelStateCounts[s.ConnectivityState.CONNECTING]>0?s.ConnectivityState.CONNECTING:this.subchannelStateCounts[s.ConnectivityState.TRANSIENT_FAILURE]>0?s.ConnectivityState.TRANSIENT_FAILURE:s.ConnectivityState.IDLE,e===s.ConnectivityState.TRANSIENT_FAILURE?this.updateState(e,new r.UnavailablePicker):this.updateState(e,new r.QueuePicker(this))}else this.updateState(s.ConnectivityState.CONNECTING,new r.QueuePicker(this));else this.updateState(s.ConnectivityState.IDLE,new r.QueuePicker(this))},this.connectionDelayTimeout=setTimeout((()=>{}),0),clearTimeout(this.connectionDelayTimeout)}startNextSubchannelConnecting(){if(!this.triedAllSubchannels){for(const[e,t]of this.subchannels.entries())if(e>this.currentSubchannelIndex){const i=t.getConnectivityState();if(i===s.ConnectivityState.IDLE||i===s.ConnectivityState.CONNECTING)return void this.startConnecting(e)}this.triedAllSubchannels=!0}}startConnecting(e){clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.subchannels[e].getConnectivityState()===s.ConnectivityState.IDLE&&(c("Start connecting to subchannel with address "+this.subchannels[e].getAddress()),process.nextTick((()=>{this.subchannels[e].startConnecting()}))),this.connectionDelayTimeout=setTimeout((()=>{this.startNextSubchannelConnecting()}),250)}pickSubchannel(e){c("Pick subchannel with address "+e.getAddress()),null!==this.currentPick&&(this.currentPick.unref(),this.currentPick.removeConnectivityStateListener(this.pickedSubchannelStateListener)),this.currentPick=e,this.updateState(s.ConnectivityState.READY,new d(e)),e.addConnectivityStateListener(this.pickedSubchannelStateListener),e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout)}updateState(e,t){c(s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(e=!0){for(const e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.currentSubchannelIndex=0,this.subchannelStateCounts={[s.ConnectivityState.CONNECTING]:0,[s.ConnectivityState.IDLE]:0,[s.ConnectivityState.READY]:0,[s.ConnectivityState.SHUTDOWN]:0,[s.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannels=[],e&&(this.triedAllSubchannels=!1)}connectToAddressList(){this.resetSubchannelList(),c("Connect to address list "+this.latestAddressList.map((e=>(0,a.subchannelAddressToString)(e)))),this.subchannels=this.latestAddressList.map((e=>this.channelControlHelper.createSubchannel(e,{})));for(const e of this.subchannels)e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef());for(const e of this.subchannels)if(e.addConnectivityStateListener(this.subchannelStateListener),this.subchannelStateCounts[e.getConnectivityState()]+=1,e.getConnectivityState()===s.ConnectivityState.READY)return this.pickSubchannel(e),void this.resetSubchannelList();for(const[e,t]of this.subchannels.entries()){const i=t.getConnectivityState();if(i===s.ConnectivityState.IDLE||i===s.ConnectivityState.CONNECTING)return this.startConnecting(e),void(null===this.currentPick&&this.updateState(s.ConnectivityState.CONNECTING,new r.QueuePicker(this)))}null===this.currentPick&&this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new r.UnavailablePicker)}updateAddressList(e,t){0!==this.subchannels.length&&this.latestAddressList.every(((t,i)=>e[i]===t))||(this.latestAddressList=e,this.connectToAddressList())}exitIdle(){(this.currentState===s.ConnectivityState.IDLE||this.triedAllSubchannels)&&this.channelControlHelper.requestReresolution();for(const e of this.subchannels)e.startConnecting();this.currentState===s.ConnectivityState.IDLE&&this.latestAddressList.length>0&&this.connectToAddressList()}resetBackoff(){}destroy(){if(this.resetSubchannelList(),null!==this.currentPick){const e=this.currentPick;e.unref(),e.removeConnectivityStateListener(this.pickedSubchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}getTypeName(){return u}}t.PickFirstLoadBalancer=f,t.setup=function(){(0,n.registerLoadBalancerType)(u,f,h),(0,n.registerDefaultLoadBalancerType)(u)}},5174:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=t.RoundRobinLoadBalancer=void 0;const n=i(1192),s=i(207),r=i(4219),a=i(8741),o=i(8626),l=i(3189);function c(e){o.trace(l.LogVerbosity.DEBUG,"round_robin",e)}const u="round_robin";class h{getLoadBalancerName(){return u}constructor(){}toJsonObject(){return{[u]:{}}}static createFromJson(e){return new h}}class d{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){const t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:r.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class f{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=s.ConnectivityState.IDLE,this.currentReadyPicker=null,this.subchannelStateCounts={[s.ConnectivityState.CONNECTING]:0,[s.ConnectivityState.IDLE]:0,[s.ConnectivityState.READY]:0,[s.ConnectivityState.SHUTDOWN]:0,[s.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannelStateListener=(e,t,i)=>{this.subchannelStateCounts[t]-=1,this.subchannelStateCounts[i]+=1,this.calculateAndUpdateState(),i!==s.ConnectivityState.TRANSIENT_FAILURE&&i!==s.ConnectivityState.IDLE||(this.channelControlHelper.requestReresolution(),e.startConnecting())}}calculateAndUpdateState(){if(this.subchannelStateCounts[s.ConnectivityState.READY]>0){const e=this.subchannels.filter((e=>e.getConnectivityState()===s.ConnectivityState.READY));let t=0;null!==this.currentReadyPicker&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(s.ConnectivityState.READY,new d(e,t))}else this.subchannelStateCounts[s.ConnectivityState.CONNECTING]>0?this.updateState(s.ConnectivityState.CONNECTING,new r.QueuePicker(this)):this.subchannelStateCounts[s.ConnectivityState.TRANSIENT_FAILURE]>0?this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new r.UnavailablePicker):this.updateState(s.ConnectivityState.IDLE,new r.QueuePicker(this))}updateState(e,t){c(s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]),e===s.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(const e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannelStateCounts={[s.ConnectivityState.CONNECTING]:0,[s.ConnectivityState.IDLE]:0,[s.ConnectivityState.READY]:0,[s.ConnectivityState.SHUTDOWN]:0,[s.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),c("Connect to address list "+e.map((e=>(0,a.subchannelAddressToString)(e)))),this.subchannels=e.map((e=>this.channelControlHelper.createSubchannel(e,{})));for(const e of this.subchannels){e.ref(),e.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(e.getChannelzRef());const t=e.getConnectivityState();this.subchannelStateCounts[t]+=1,t!==s.ConnectivityState.IDLE&&t!==s.ConnectivityState.TRANSIENT_FAILURE||e.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(const e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return u}}t.RoundRobinLoadBalancer=f,t.setup=function(){(0,n.registerLoadBalancerType)(u,f,h)}},1192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.isLoadBalancerNameRegistered=t.createLoadBalancer=t.registerDefaultLoadBalancerType=t.registerLoadBalancerType=t.createChildChannelControlHelper=void 0,t.createChildChannelControlHelper=function(e,t){var i,n,s,r,a,o,l,c,u,h;return{createSubchannel:null!==(n=null===(i=t.createSubchannel)||void 0===i?void 0:i.bind(t))&&void 0!==n?n:e.createSubchannel.bind(e),updateState:null!==(r=null===(s=t.updateState)||void 0===s?void 0:s.bind(t))&&void 0!==r?r:e.updateState.bind(e),requestReresolution:null!==(o=null===(a=t.requestReresolution)||void 0===a?void 0:a.bind(t))&&void 0!==o?o:e.requestReresolution.bind(e),addChannelzChild:null!==(c=null===(l=t.addChannelzChild)||void 0===l?void 0:l.bind(t))&&void 0!==c?c:e.addChannelzChild.bind(e),removeChannelzChild:null!==(h=null===(u=t.removeChannelzChild)||void 0===u?void 0:u.bind(t))&&void 0!==h?h:e.removeChannelzChild.bind(e)}};const i={};let n=null;t.registerLoadBalancerType=function(e,t,n){i[e]={LoadBalancer:t,LoadBalancingConfig:n}},t.registerDefaultLoadBalancerType=function(e){n=e},t.createLoadBalancer=function(e,t){const n=e.getLoadBalancerName();return n in i?new i[n].LoadBalancer(t):null},t.isLoadBalancerNameRegistered=function(e){return e in i},t.getFirstUsableConfig=function(e,t=!1){for(const t of e)if(t.getLoadBalancerName()in i)return t;return t&&n?new i[n].LoadBalancingConfig:null},t.validateLoadBalancingConfig=function(e){if(null===e||"object"!=typeof e)throw new Error("Load balancing config must be an object");const t=Object.keys(e);if(1!==t.length)throw new Error("Provided load balancing config has multiple conflicting entries");const n=t[0];if(n in i)return i[n].LoadBalancingConfig.createFromJson(e[n]);throw new Error(`Unrecognized load balancing config name ${n}`)}},9600:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadBalancingCall=void 0;const n=i(207),s=i(3189),r=i(1128),a=i(4664),o=i(4219),l=i(5165),c=i(8626),u=i(4617),h=i(5158);t.LoadBalancingCall=class{constructor(e,t,i,n,s,r,a){var o,c;this.channel=e,this.callConfig=t,this.methodName=i,this.host=n,this.credentials=s,this.deadline=r,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.pendingChildStatus=null,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;const u=this.methodName.split("/");let h="";u.length>=2&&(h=u[1]);const d=null!==(c=null===(o=(0,l.splitHostPort)(this.host))||void 0===o?void 0:o.host)&&void 0!==c?c:"localhost";this.serviceUrl=`https://${d}/${h}`}trace(e){c.trace(s.LogVerbosity.DEBUG,"load_balancing_call","["+this.callNumber+"] "+e)}outputStatus(e,t){var i,n;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');const s=Object.assign(Object.assign({},e),{progress:t});null===(i=this.listener)||void 0===i||i.onReceiveStatus(s),null===(n=this.onCallEnded)||void 0===n||n.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");const i=this.channel.doPick(this.metadata,this.callConfig.pickInformation),l=i.subchannel?"("+i.subchannel.getChannelzRef().id+") "+i.subchannel.getAddress():""+i.subchannel;switch(this.trace("Pick result: "+o.PickResultType[i.pickResultType]+" subchannel: "+l+" status: "+(null===(e=i.status)||void 0===e?void 0:e.code)+" "+(null===(t=i.status)||void 0===t?void 0:t.details)),i.pickResultType){case o.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then((e=>{var t,o,c;const u=this.metadata.clone();if(u.merge(e),u.get("authorization").length>1&&this.outputStatus({code:s.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new a.Metadata},"PROCESSED"),i.subchannel.getConnectivityState()!==n.ConnectivityState.READY)return this.trace("Picked subchannel "+l+" has state "+n.ConnectivityState[i.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),void this.doPick();this.deadline!==1/0&&u.set("grpc-timeout",(0,r.getDeadlineTimeoutString)(this.deadline));try{this.child=i.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(e)},onReceiveMessage:e=>{this.trace("Received message"),this.listener.onReceiveMessage(e)},onReceiveStatus:e=>{this.trace("Received status"),e.rstCode===h.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(e,"REFUSED"):this.outputStatus(e,"PROCESSED")}})}catch(e){return this.trace("Failed to start call on picked subchannel "+l+" with error "+e.message),void this.outputStatus({code:s.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+e.message,metadata:new a.Metadata},"NOT_STARTED")}null===(o=(t=this.callConfig).onCommitted)||void 0===o||o.call(t),null===(c=i.onCallStarted)||void 0===c||c.call(i),this.onCallEnded=i.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()}),(e=>{const{code:t,details:i}=(0,u.restrictControlPlaneStatusCode)("number"==typeof e.code?e.code:s.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`);this.outputStatus({code:t,details:i,metadata:new a.Metadata},"PROCESSED")}));break;case o.PickResultType.DROP:const{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(i.status.code,i.status.details);this.outputStatus({code:e,details:t,metadata:i.status.metadata},"DROP");break;case o.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{const{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(i.status.code,i.status.details);this.outputStatus({code:e,details:t,metadata:i.status.metadata},"PROCESSED")}break;case o.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null===(i=this.child)||void 0===i||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new a.Metadata},"PROCESSED")}getPeer(){var e,t;return null!==(t=null===(e=this.child)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}}},8626:(e,t,i)=>{"use strict";var n,s,r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.isTracerEnabled=t.trace=t.log=t.setLoggerVerbosity=t.setLogger=t.getLogger=void 0;const o=i(3189);let l={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}},c=o.LogVerbosity.ERROR;switch((null!==(s=null!==(n=process.env.GRPC_NODE_VERBOSITY)&&void 0!==n?n:process.env.GRPC_VERBOSITY)&&void 0!==s?s:"").toUpperCase()){case"DEBUG":c=o.LogVerbosity.DEBUG;break;case"INFO":c=o.LogVerbosity.INFO;break;case"ERROR":c=o.LogVerbosity.ERROR;break;case"NONE":c=o.LogVerbosity.NONE}t.getLogger=()=>l,t.setLogger=e=>{l=e},t.setLoggerVerbosity=e=>{c=e},t.log=(e,...t)=>{let i;if(e>=c){switch(e){case o.LogVerbosity.DEBUG:i=l.debug;break;case o.LogVerbosity.INFO:i=l.info;break;case o.LogVerbosity.ERROR:i=l.error}i||(i=l.error),i&&i.bind(l)(...t)}};const u=null!==(a=null!==(r=process.env.GRPC_NODE_TRACE)&&void 0!==r?r:process.env.GRPC_TRACE)&&void 0!==a?a:"",h=new Set,d=new Set;for(const e of u.split(","))e.startsWith("-")?d.add(e.substring(1)):h.add(e);const f=h.has("all");function p(e){return!d.has(e)&&(f||h.has(e))}t.trace=function(e,i,n){p(i)&&(0,t.log)(e,(new Date).toISOString()+" | "+i+" | "+n)},t.isTracerEnabled=p},2011:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPackageDefinition=t.makeClientConstructor=void 0;const n=i(8279),s={unary:n.Client.prototype.makeUnaryRequest,server_stream:n.Client.prototype.makeServerStreamRequest,client_stream:n.Client.prototype.makeClientStreamRequest,bidi:n.Client.prototype.makeBidiStreamRequest};function r(e){return["__proto__","prototype","constructor"].includes(e)}function a(e,t,i){i||(i={});class a extends n.Client{}return Object.keys(e).forEach((t=>{if(r(t))return;const i=e[t];let n;if("string"==typeof t&&"$"===t.charAt(0))throw new Error("Method names cannot start with $");n=i.requestStream?i.responseStream?"bidi":"client_stream":i.responseStream?"server_stream":"unary";const o=i.requestSerialize,l=i.responseDeserialize,c=function(e,t,i,n){return function(...s){return e.call(this,t,i,n,...s)}}(s[n],i.path,o,l);a.prototype[t]=c,Object.assign(a.prototype[t],i),i.originalName&&!r(i.originalName)&&(a.prototype[i.originalName]=a.prototype[t])})),a.service=e,a.serviceName=t,a}t.makeClientConstructor=a,t.loadPackageDefinition=function(e){const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=e[n],o=n.split(".");if(o.some((e=>r(e))))continue;const l=o[o.length-1];let c=t;for(const e of o.slice(0,-1))c[e]||(c[e]={}),c=c[e];i=s,c[l]="format"in i?s:a(s,l,{})}var i;return t}},2829:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxMessageSizeFilterFactory=t.MaxMessageSizeFilter=void 0;const n=i(6994),s=i(3189),r=i(4664);class a extends n.BaseFilter{constructor(e){super(),this.options=e,this.maxSendMessageSize=s.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}async sendMessage(e){if(-1===this.maxSendMessageSize)return e;{const t=await e;if(t.message.length>this.maxSendMessageSize)throw{code:s.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`,metadata:new r.Metadata};return t}}async receiveMessage(e){if(-1===this.maxReceiveMessageSize)return e;{const t=await e;if(t.length>this.maxReceiveMessageSize)throw{code:s.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`,metadata:new r.Metadata};return t}}}t.MaxMessageSizeFilter=a,t.MaxMessageSizeFilterFactory=class{constructor(e){this.options=e}createFilter(){return new a(this.options)}}},4664:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;const n=i(8626),s=i(3189),r=i(5503),a=/^[0-9a-z_.-]+$/,o=/^[ -~]*$/;function l(e){return e.endsWith("-bin")}function c(e){return!e.startsWith("grpc-")}function u(e){return e.toLowerCase()}function h(e,t){if(!function(e){return a.test(e)}(e))throw new Error('Metadata key "'+e+'" contains illegal characters');if(null!=t)if(l(e)){if(!Buffer.isBuffer(t))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(t))throw new Error("keys that don't end with '-bin' must have String values");if(!function(e){return o.test(e)}(t))throw new Error('Metadata string value "'+t+'" contains illegal characters')}}class d{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){h(e=u(e),t),this.internalRepr.set(e,[t])}add(e,t){h(e=u(e),t);const i=this.internalRepr.get(e);void 0===i?this.internalRepr.set(e,[t]):i.push(t)}remove(e){e=u(e),this.internalRepr.delete(e)}get(e){return e=u(e),this.internalRepr.get(e)||[]}getMap(){const e={};for(const[t,i]of this.internalRepr)if(i.length>0){const n=i[0];e[t]=Buffer.isBuffer(n)?Buffer.from(n):n}return e}clone(){const e=new d(this.options),t=e.internalRepr;for(const[e,i]of this.internalRepr){const n=i.map((e=>Buffer.isBuffer(e)?Buffer.from(e):e));t.set(e,n)}return e}merge(e){for(const[t,i]of e.internalRepr){const e=(this.internalRepr.get(t)||[]).concat(i);this.internalRepr.set(t,e)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){const e={};for(const[t,i]of this.internalRepr)e[t]=i.map(f);return e}_getCoreRepresentation(){return this.internalRepr}toJSON(){const e={};for(const[t,i]of this.internalRepr)e[t]=i;return e}static fromHttp2Headers(e){const t=new d;for(const i of Object.keys(e)){if(":"===i.charAt(0))continue;const a=e[i];try{l(i)?Array.isArray(a)?a.forEach((e=>{t.add(i,Buffer.from(e,"base64"))})):void 0!==a&&(c(i)?a.split(",").forEach((e=>{t.add(i,Buffer.from(e.trim(),"base64"))})):t.add(i,Buffer.from(a,"base64"))):Array.isArray(a)?a.forEach((e=>{t.add(i,e)})):void 0!==a&&t.add(i,a)}catch(e){const t=`Failed to add metadata entry ${i}: ${a}. ${(0,r.getErrorMessage)(e)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,n.log)(s.LogVerbosity.ERROR,t)}}return t}}t.Metadata=d;const f=e=>Buffer.isBuffer(e)?e.toString("base64"):e},4219:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuePicker=t.UnavailablePicker=t.PickResultType=void 0;const n=i(4664),s=i(3189);var r;!function(e){e[e.COMPLETE=0]="COMPLETE",e[e.QUEUE=1]="QUEUE",e[e.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",e[e.DROP=3]="DROP"}(r=t.PickResultType||(t.PickResultType={})),t.UnavailablePicker=class{constructor(e){this.status=void 0!==e?e:{code:s.Status.UNAVAILABLE,details:"No connection established",metadata:new n.Metadata}}pick(e){return{pickResultType:r.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}},t.QueuePicker=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick((()=>{this.loadBalancer.exitIdle()})),this.calledExitIdle=!0),{pickResultType:r.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}},6982:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;const n=i(3513),s=i(9523),r=i(3837),a=i(235),o=i(3189),l=i(4664),c=i(8626),u=i(3189),h=i(5165),d=i(1808),f=i(3510);function p(e){c.trace(u.LogVerbosity.DEBUG,"dns_resolver",e)}const m=r.promisify(s.resolveTxt),g=r.promisify(s.lookup);class v{constructor(e,t,i){var n,s,r;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,p("Resolver constructed for target "+(0,h.uriToString)(e));const a=(0,h.splitHostPort)(e.path);null===a?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,d.isIPv4)(a.host)||(0,d.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:null!==(n=a.port)&&void 0!==n?n:443}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=null!==(s=a.port)&&void 0!==s?s:443),this.percentage=100*Math.random(),this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,h.uriToString)(this.target)}`,metadata:new l.Metadata};const c={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new f.BackoffTimeout((()=>{this.continueResolving&&this.startResolutionWithBackoff()}),c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(r=i["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==r?r:3e4,this.nextResolutionTimer=setTimeout((()=>{}),0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult)return p("Returning IP address for target "+(0,h.uriToString)(this.target)),setImmediate((()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})})),this.backoff.stop(),void this.backoff.reset();if(null===this.dnsHostname)p("Failed to parse DNS address "+(0,h.uriToString)(this.target)),setImmediate((()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,h.uriToString)(this.target)}`,metadata:new l.Metadata})})),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;p("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;const e=this.dnsHostname;this.pendingLookupPromise=g(e,{all:!0}),this.pendingLookupPromise.then((e=>{this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();const t=e.filter((e=>4===e.family)),i=e.filter((e=>6===e.family));this.latestLookupResult=function(...e){const t=[];for(let i=0;i<Math.max.apply(null,e.map((e=>e.length)));i++)for(const n of e)i<n.length&&t.push(n[i]);return t}(i,t).map((e=>({host:e.address,port:+this.port})));const n="["+this.latestLookupResult.map((e=>e.host+":"+e.port)).join(",")+"]";p("Resolved addresses for target "+(0,h.uriToString)(this.target)+": "+n),0!==this.latestLookupResult.length?this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{}):this.listener.onError(this.defaultResolutionError)}),(e=>{p("Resolution error for target "+(0,h.uriToString)(this.target)+": "+e.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError)})),null===this.pendingTxtPromise&&(this.pendingTxtPromise=m(e),this.pendingTxtPromise.then((e=>{this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,a.extractAndSelectServiceConfig)(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:"Parsing service config failed",metadata:new l.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}),(e=>{})))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(t=(e=setTimeout((()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()}),this.minTimeBetweenResolutionsMs)).unref)||void 0===t?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.startResolution(),this.backoff.runOnce(),this.startNextResolutionTimer())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?this.continueResolving=!0:this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.stop(),this.stopNextResolutionTimer()}static getDefaultAuthority(e){return e.path}}t.setup=function(){(0,n.registerResolver)("dns",v),(0,n.registerDefaultScheme)("dns")}},8733:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;const n=i(1808),s=i(3189),r=i(4664),a=i(3513),o=i(5165),l=i(8626);function c(e){l.trace(s.LogVerbosity.DEBUG,"ip_resolver",e)}const u="ipv4",h="ipv6";class d{constructor(e,t,i){var a;this.target=e,this.listener=t,this.addresses=[],this.error=null,c("Resolver constructed for target "+(0,o.uriToString)(e));const l=[];if(e.scheme!==u&&e.scheme!==h)return void(this.error={code:s.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new r.Metadata});const d=e.path.split(",");for(const t of d){const i=(0,o.splitHostPort)(t);if(null===i)return void(this.error={code:s.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new r.Metadata});if(e.scheme===u&&!(0,n.isIPv4)(i.host)||e.scheme===h&&!(0,n.isIPv6)(i.host))return void(this.error={code:s.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new r.Metadata});l.push({host:i.host,port:null!==(a=i.port)&&void 0!==a?a:443})}this.addresses=l,c("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){process.nextTick((()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){}static getDefaultAuthority(e){return e.path.split(",")[0]}}t.setup=function(){(0,a.registerResolver)(u,d),(0,a.registerResolver)(h,d)}},1350:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setup=void 0;const n=i(3513);class s{constructor(e,t,i){let n;this.listener=t,this.addresses=[],n=""===e.authority?"/"+e.path:e.path,this.addresses=[{path:n}]}updateResolution(){process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{})}destroy(){}static getDefaultAuthority(e){return"localhost"}}t.setup=function(){(0,n.registerResolver)("unix",s)}},3513:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapUriDefaultScheme=t.getDefaultAuthority=t.createResolver=t.registerDefaultScheme=t.registerResolver=void 0;const n=i(5165),s={};let r=null;t.registerResolver=function(e,t){s[e]=t},t.registerDefaultScheme=function(e){r=e},t.createResolver=function(e,t,i){if(void 0!==e.scheme&&e.scheme in s)return new s[e.scheme](e,t,i);throw new Error(`No resolver could be created for target ${(0,n.uriToString)(e)}`)},t.getDefaultAuthority=function(e){if(void 0!==e.scheme&&e.scheme in s)return s[e.scheme].getDefaultAuthority(e);throw new Error(`Invalid target ${(0,n.uriToString)(e)}`)},t.mapUriDefaultScheme=function(e){return void 0!==e.scheme&&e.scheme in s?e:null!==r?{scheme:r,authority:void 0,path:(0,n.uriToString)(e)}:null}},4692:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingCall=void 0;const n=i(3189),s=i(1128),r=i(4664),a=i(8626),o=i(4617);t.ResolvingCall=class{constructor(e,t,i,r,a,o){this.channel=e,this.method=t,this.filterStackFactory=r,this.credentials=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout((()=>{}),0),this.filterStack=null,this.deadline=i.deadline,this.host=i.host,i.parentCall&&(i.flags&n.Propagate.CANCELLATION&&i.parentCall.on("cancelled",(()=>{this.cancelWithStatus(n.Status.CANCELLED,"Cancelled by parent call")})),i.flags&n.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+i.parentCall.getDeadline()),this.deadline=(0,s.minDeadline)(this.deadline,i.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){a.trace(n.LogVerbosity.DEBUG,"resolving_call","["+this.callNumber+"] "+e)}runDeadlineTimer(){if(clearTimeout(this.deadlineTimer),this.trace("Deadline: "+this.deadline),this.deadline!==1/0){const e=(0,s.getRelativeTimeout)(this.deadline);this.trace("Deadline will be reached in "+e+"ms");const t=()=>{this.cancelWithStatus(n.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter());const t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach((e=>e(t))),process.nextTick((()=>{var e;null===(e=this.listener)||void 0===e||e.onReceiveStatus(t)}))}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");const i=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then((t=>{this.writeFilterPending=!1,i.sendMessageWithContext(e,t.message),this.pendingHalfClose&&i.halfClose()}),(e=>{this.cancelWithStatus(e.code,e.details)}))}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");const e=this.channel.getConfig(this.method,this.metadata);if("NONE"===e.type)return void this.channel.queueCallForConfig(this);if("ERROR"===e.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error));const t=e.config;if(t.status===n.Status.OK){if(t.methodConfig.timeout){const e=new Date;e.setSeconds(e.getSeconds()+t.methodConfig.timeout.seconds),e.setMilliseconds(e.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,s.minDeadline)(this.deadline,e),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then((e=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.child.start(e,{onReceiveMetadata:e=>{this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(e))},onReceiveMessage:e=>{this.readFilterPending=!0,this.filterStack.receiveMessage(e).then((e=>{this.readFilterPending=!1,this.listener.onReceiveMessage(e),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)}),(e=>{this.cancelWithStatus(e.code,e.details)}))},onReceiveStatus:e=>{this.readFilterPending?this.pendingChildStatus=e:this.outputStatus(e)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()}),(e=>{this.outputStatus(e)}))}else{const{code:e,details:i}=(0,o.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:e,details:i,metadata:new r.Metadata})}}reportResolverError(e){var t;(null===(t=this.metadata)||void 0===t?void 0:t.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var i;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null===(i=this.child)||void 0===i||i.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new r.Metadata})}getPeer(){var e,t;return null!==(t=null===(e=this.child)||void 0===e?void 0:e.getPeer())&&void 0!==t?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}}},3970:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvingLoadBalancer=void 0;const n=i(1192),s=i(235),r=i(207),a=i(3513),o=i(4219),l=i(3510),c=i(3189),u=i(4664),h=i(8626),d=i(3189),f=i(5165),p=i(4487);t.ResolvingLoadBalancer=class{constructor(e,t,i,h,d){this.target=e,this.channelControlHelper=t,this.channelOptions=i,this.onSuccessfulResolution=h,this.onFailedResolution=d,this.latestChildState=r.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=r.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,i["grpc.service_config"]?this.defaultServiceConfig=(0,s.validateServiceConfig)(JSON.parse(i["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(r.ConnectivityState.IDLE,new o.QueuePicker(this)),this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()},updateState:(e,t)=>{this.latestChildState=e,this.latestChildPicker=t,this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,a.createResolver)(e,{onSuccessfulResolution:(e,t,i,s,r)=>{var a;let o=null;null===t?null===i?(this.previousServiceConfig=null,o=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(i):o=this.previousServiceConfig:(o=t,this.previousServiceConfig=t);const l=null!==(a=null==o?void 0:o.loadBalancingConfig)&&void 0!==a?a:[],h=(0,n.getFirstUsableConfig)(l,!0);if(null===h)return void this.handleResolutionFailure({code:c.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new u.Metadata});this.childLoadBalancer.updateAddressList(e,h,r);const d=null!=o?o:this.defaultServiceConfig;this.onSuccessfulResolution(d,null!=s?s:function(e){return function(t,i){var n,s;const r=t.split("/").filter((e=>e.length>0)),a=null!==(n=r[0])&&void 0!==n?n:"",o=null!==(s=r[1])&&void 0!==s?s:"";if(e&&e.methodConfig)for(const t of e.methodConfig)for(const e of t.name)if(e.service===a&&(void 0===e.method||e.method===o))return{methodConfig:t,pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]};return{methodConfig:{name:[]},pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}(d))},onError:e=>{this.handleResolutionFailure(e)}},i);const f={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout((()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)}),f),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===r.ConnectivityState.IDLE&&this.updateState(r.ConnectivityState.CONNECTING,new o.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){var i;i=(0,f.uriToString)(this.target)+" "+r.ConnectivityState[this.currentState]+" -> "+r.ConnectivityState[e],h.trace(d.LogVerbosity.DEBUG,"resolving_load_balancer",i),e===r.ConnectivityState.IDLE&&(t=new o.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===r.ConnectivityState.IDLE&&(this.updateState(r.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){this.currentState!==r.ConnectivityState.IDLE&&this.currentState!==r.ConnectivityState.TRANSIENT_FAILURE||(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.updateState(r.ConnectivityState.SHUTDOWN,new o.UnavailablePicker)}getTypeName(){return"resolving_load_balancer"}}},859:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryingCall=t.MessageBufferTracker=t.RetryThrottler=void 0;const n=i(3189),s=i(4664),r=i(8626);t.RetryThrottler=class{constructor(e,t,i){this.maxTokens=e,this.tokenRatio=t,this.tokens=i?i.tokens*(e/i.maxTokens):e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}},t.MessageBufferTracker=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var i;const n=null!==(i=this.allocatedPerCall.get(t))&&void 0!==i?i:0;return!(this.limitPerCall-n<e||this.totalLimit-this.totalAllocated<e||(this.allocatedPerCall.set(t,n+e),this.totalAllocated+=e,0))}free(e,t){var i;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;const n=null!==(i=this.allocatedPerCall.get(t))&&void 0!==i?i:0;if(n<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${n}`);this.allocatedPerCall.set(t,n-e)}freeAll(e){var t;const i=null!==(t=this.allocatedPerCall.get(e))&&void 0!==t?t:0;if(this.totalAllocated<i)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${i} > total allocated ${this.totalAllocated}`);this.totalAllocated-=i,this.allocatedPerCall.delete(e)}};const a="grpc-previous-rpc-attempts";t.RetryingCall=class{constructor(e,t,i,n,s,r,a,o,l){if(this.channel=e,this.callConfig=t,this.methodName=i,this.host=n,this.credentials=s,this.deadline=r,this.callNumber=a,this.bufferTracker=o,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";const e=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(e.initialBackoff.substring(0,e.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){r.trace(n.LogVerbosity.DEBUG,"retrying_call","["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),process.nextTick((()=>{var t;null===(t=this.listener)||void 0===t||t.onReceiveStatus(e)}))}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new s.Metadata});for(const{call:i}of this.underlyingCalls)i.cancelWithStatus(e,t)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}maybefreeMessageBufferEntry(e){if("COMMITTED"!==this.state)return;const t=this.writeBuffer[e];"MESSAGE"===t.entryType&&(t.allocated&&this.bufferTracker.free(t.message.message.length,this.callNumber),this.writeBuffer[e]={entryType:"FREED",allocated:!1})}commitCall(e){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[e].state){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&"COMPLETED"!==this.underlyingCalls[t].state&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(n.Status.CANCELLED,"Discarded in favor of other hedged attempt"));for(let t=0;t<this.underlyingCalls[e].nextMessageToSend-1;t+=1)this.maybefreeMessageBufferEntry(t)}}commitCallWithMostMessages(){let e=-1,t=-1;for(const[i,n]of this.underlyingCalls.entries())n.nextMessageToSend>e&&(e=n.nextMessageToSend,t=i);this.commitCall(t)}isStatusCodeInList(e,t){return e.some((e=>e===t||e.toString().toLowerCase()===n.Status[t].toLowerCase()))}getNextRetryBackoffMs(){var e;const t=null===(e=this.callConfig)||void 0===e?void 0:e.methodConfig.retryPolicy;if(!t)return 0;const i=Math.random()*this.nextRetryBackoffSec*1e3,n=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,n),i}maybeRetryCall(e,t){if("RETRY"!==this.state)return void t(!1);const i=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return void t(!1);let n;if(null===e)n=this.getNextRetryBackoffMs();else{if(e<0)return this.state="TRANSPARENT_ONLY",void t(!1);n=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec}setTimeout((()=>{var e,i;"RETRY"===this.state?(null===(i=null===(e=this.retryThrottler)||void 0===e?void 0:e.canRetryCall())||void 0===i||i)&&(t(!0),this.attempts+=1,this.startNewAttempt()):t(!1)}),n)}countActiveCalls(){let e=0;for(const t of this.underlyingCalls)"ACTIVE"===(null==t?void 0:t.state)&&(e+=1);return e}handleProcessedStatus(e,t,i){var n,s,r;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList(null!==(n=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==n?n:[],e.code)){let n;if(null===(s=this.retryThrottler)||void 0===s||s.addCallFailed(),null===i)n=0;else{if(i<0)return this.state="TRANSPARENT_ONLY",this.commitCall(t),void this.reportStatus(e);n=i}setTimeout((()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(t),this.reportStatus(e))}),n)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?(null===(r=this.retryThrottler)||void 0===r||r.addCallFailed(),this.maybeRetryCall(i,(i=>{i||(this.commitCall(t),this.reportStatus(e))}))):(this.commitCall(t),this.reportStatus(e))}}getPushback(e){const t=e.get("grpc-retry-pushback-ms");if(0===t.length)return null;try{return parseInt(t[0])}catch(e){return-1}}handleChildStatus(e,t){var i;if("COMPLETED"===this.underlyingCalls[t].state)return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===n.Status.OK)return null===(i=this.retryThrottler)||void 0===i||i.addCallSucceeded(),this.commitCall(t),void this.reportStatus(e);if("COMMITTED"===this.state)return void this.reportStatus(e);const s=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,s):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,s)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state)return;if(!this.callConfig.methodConfig.hedgingPolicy)return;const e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,i;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state)return;if(!this.callConfig.methodConfig.hedgingPolicy)return;const n=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(n.maxAttempts,5))return;const s=null!==(e=n.hedgingDelay)&&void 0!==e?e:"0s",r=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout((()=>{this.maybeStartHedgingAttempt()}),1e3*r),null===(i=(t=this.hedgingTimer).unref)||void 0===i||i.call(t)}startNewAttempt(){const e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);const t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});const i=this.attempts-1,n=this.initialMetadata.clone();i>0&&n.set(a,`${i}`);let s=!1;e.start(n,{onReceiveMetadata:n=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,i>0&&n.set(a,`${i}`),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMetadata(n)},onReceiveMessage:i=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMessage(i)},onReceiveStatus:n=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&i>0&&n.metadata.set(a,`${i}`),this.handleChildStatus(n,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,i;const n=this.underlyingCalls[e],s=n.nextMessageToSend;null===(i=(t=this.writeBuffer[s]).callback)||void 0===i||i.call(t),this.maybefreeMessageBufferEntry(s),n.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){const t=this.underlyingCalls[e];if("COMPLETED"!==t.state&&this.writeBuffer[t.nextMessageToSend]){const i=this.writeBuffer[t.nextMessageToSend];switch(i.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},i.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose()}}}sendMessageWithContext(e,t){var i;this.trace("write() called with message of length "+t.length);const n={message:t,flags:e.flags},s=this.writeBuffer.length,r={entryType:"MESSAGE",message:n,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer[s]=r,r.allocated){null===(i=e.callback)||void 0===i||i.call(e);for(const[e,i]of this.underlyingCalls.entries())"ACTIVE"===i.state&&i.nextMessageToSend===s&&i.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},t)}else{this.commitCallWithMostMessages();const i=this.underlyingCalls[this.committedCallIndex];r.callback=e.callback,"ACTIVE"===i.state&&i.nextMessageToSend===s&&i.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(const e of this.underlyingCalls)"ACTIVE"===(null==e?void 0:e.state)&&e.call.startRead()}halfClose(){this.trace("halfClose called");const e=this.writeBuffer.length;this.writeBuffer[e]={entryType:"HALF_CLOSE",allocated:!1};for(const t of this.underlyingCalls)"ACTIVE"===(null==t?void 0:t.state)&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}},777:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2ServerCallStream=t.ServerDuplexStreamImpl=t.ServerWritableStreamImpl=t.ServerReadableStreamImpl=t.ServerUnaryCallImpl=void 0;const n=i(2361),s=i(5158),r=i(2781),a=i(9796),o=i(3837),l=i(3189),c=i(4664),u=i(1524),h=i(8626),d=i(5503),f="server_call",p=(0,o.promisify)(a.unzip),m=(0,o.promisify)(a.inflate);function g(e){h.trace(l.LogVerbosity.DEBUG,f,e)}const v="grpc-message",y="grpc-status",S="grpc-timeout",b=/(\d{1,8})\s*([HMSmun])/,C={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},T={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity",[s.constants.HTTP2_HEADER_STATUS]:s.constants.HTTP_STATUS_OK,[s.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},E={waitForTrailers:!0};class w extends n.EventEmitter{constructor(e,t,i){super(),this.call=e,this.metadata=t,this.request=i,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerUnaryCallImpl=w;class _ extends r.Readable{constructor(e,t,i,n){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=i,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,n)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}t.ServerReadableStreamImpl=_;class k extends r.Writable{constructor(e,t,i,n){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.request=n,this.cancelled=!1,this.trailingMetadata=new c.Metadata,this.call.setupSurfaceCall(this),this.on("error",(e=>{this.call.sendError(e),this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,i){try{const t=this.call.serializeMessage(e);if(!this.call.write(t))return void this.call.once("drain",i)}catch(e){this.emit("error",{details:(0,d.getErrorMessage)(e),code:l.Status.INTERNAL})}i()}_final(e){this.call.sendStatus({code:l.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerWritableStreamImpl=k;class R extends r.Duplex{constructor(e,t,i,n,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=i,this.deserialize=n,this.cancelled=!1,this.trailingMetadata=new c.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",(e=>{this.call.sendError(e),this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}}t.ServerDuplexStreamImpl=R,R.prototype._read=_.prototype._read,R.prototype._write=k.prototype._write,R.prototype._final=k.prototype._final;class x extends n.EventEmitter{constructor(e,t,i){super(),this.stream=e,this.handler=t,this.options=i,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=l.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=l.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",(e=>{})),this.stream.once("close",(()=>{var e;g("Request to method "+(null===(e=this.handler)||void 0===e?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:l.Status.CANCELLED,details:"Cancelled by client",metadata:null}))})),this.stream.on("drain",(()=>{this.emit("drain")})),"grpc.max_send_message_length"in i&&(this.maxSendMessageSize=i["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in i&&(this.maxReceiveMessageSize=i["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){return"deflate"===t?m(e.subarray(5)):"gzip"===t?p(e.subarray(5)):"identity"===t?e.subarray(5):Promise.reject({code:l.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled())return;if(this.metadataSent)return;this.metadataSent=!0;const t=e?e.toHttp2Headers():null,i=Object.assign(Object.assign({},T),t);this.stream.respond(i,E)}receiveMetadata(e){const t=c.Metadata.fromHttp2Headers(e);h.isTracerEnabled(f)&&g("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));const i=t.get(S);if(i.length>0){const e=i[0].toString().match(b);if(null===e){const e=new Error("Invalid deadline");return e.code=l.Status.OUT_OF_RANGE,this.sendError(e),t}const n=+e[1]*C[e[2]]|0,s=new Date;this.deadline=s.setMilliseconds(s.getMilliseconds()+n),this.deadlineTimer=setTimeout(A,n,this),t.remove(S)}return t.remove(s.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(s.constants.HTTP2_HEADER_TE),t.remove(s.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e,t){const{stream:i}=this;let n=0;const s=this,r=[],a=this.maxReceiveMessageSize;function o(e){if(n+=e.byteLength,-1!==a&&n>a)return i.removeListener("data",o),i.removeListener("end",c),i.removeListener("error",c),void t({code:l.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${n} vs. ${a})`});r.push(e)}function c(a){if(i.removeListener("data",o),i.removeListener("end",c),i.removeListener("error",c),void 0!==a)return void t({code:l.Status.INTERNAL,details:a.message});if(0===n)return void t({code:l.Status.INTERNAL,details:"received empty unary message"});s.emit("receiveMessage");const u=Buffer.concat(r,n),h=1===u.readUInt8(0)?e:"identity",d=s.getDecompressedMessage(u,h);Buffer.isBuffer(d)?s.safeDeserializeMessage(d,t):d.then((e=>s.safeDeserializeMessage(e,t)),(i=>t(i.code?i:{code:l.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`})))}i.on("data",o),i.on("end",c),i.on("error",c)}safeDeserializeMessage(e,t){try{t(null,this.deserializeMessage(e))}catch(e){t({details:(0,d.getErrorMessage)(e),code:l.Status.INTERNAL})}}serializeMessage(e){const t=this.handler.serialize(e),i=t.byteLength,n=Buffer.allocUnsafe(i+5);return n.writeUInt8(0,0),n.writeUInt32BE(i,1),t.copy(n,5),n}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,i,n){if(!this.checkCancelled()){if(void 0===i&&(i=null),e)return!Object.prototype.hasOwnProperty.call(e,"metadata")&&i&&(e.metadata=i),void this.sendError(e);try{const e=this.serializeMessage(t);this.write(e),this.sendStatus({code:l.Status.OK,details:"OK",metadata:i})}catch(e){this.sendError({details:(0,d.getErrorMessage)(e),code:l.Status.INTERNAL})}}}sendStatus(e){var t,i;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===l.Status.OK),!this.checkCancelled())if(g("Request to method "+(null===(t=this.handler)||void 0===t?void 0:t.path)+" ended with status code: "+l.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",(()=>{var t;const i=Object.assign({[y]:e.code,[v]:encodeURI(e.details)},null===(t=e.metadata)||void 0===t?void 0:t.toHttp2Headers());this.stream.sendTrailers(i),this.statusSent=!0})),this.stream.end());else{const t=Object.assign({[y]:e.code,[v]:encodeURI(e.details)},null===(i=e.metadata)||void 0===i?void 0:i.toHttp2Headers());this.stream.respond(t,{endStream:!0}),this.statusSent=!0}}sendError(e){const t={code:l.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&void 0!==e.metadata?e.metadata:null};"code"in e&&"number"==typeof e.code&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&"string"==typeof e.details&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(!(-1!==this.maxSendMessageSize&&e.length>this.maxSendMessageSize))return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e);this.sendError({code:l.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`})}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",(t=>{e.cancelled=!0,e.emit("cancelled",t)})),this.once("callEnd",(t=>e.emit("callEnd",t)))}setupReadable(e,t){const i=new u.StreamDecoder;let n=!1,s=!1,r=!1;const a=()=>{r||!n||s||(r=!0,this.pushOrBufferMessage(e,null))};this.stream.on("data",(async n=>{const r=i.write(n);s=!0,this.stream.pause();for(const i of r){if(-1!==this.maxReceiveMessageSize&&i.length>this.maxReceiveMessageSize)return void this.sendError({code:l.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${i.length} vs. ${this.maxReceiveMessageSize})`});this.emit("receiveMessage");const n=1===i.readUInt8(0)?t:"identity",s=await this.getDecompressedMessage(i,n);if(!s)return;this.pushOrBufferMessage(e,s)}s=!1,this.stream.resume(),a()})),this.stream.once("end",(()=>{n=!0,a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){const t=this.messagesToPush.shift(),i=e.push(t);if(null===t||!1===i){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):this.pushMessage(e,t)}async pushMessage(e,t){if(null===t)return g("Received end of stream"),void(this.canPush?e.push(null):this.messagesToPush.push(null));g("Received message of length "+t.length),this.isPushPending=!0;try{const i=await this.deserializeMessage(t);this.canPush?e.push(i)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(i)}catch(t){this.bufferedMessages.length=0;let i=(0,d.getErrorCode)(t);(null===i||i<l.Status.OK||i>l.Status.UNAUTHENTICATED)&&(i=l.Status.INTERNAL),e.emit("error",{details:(0,d.getErrorMessage)(t),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){const e=this.stream.session.socket;return e.remoteAddress?e.remotePort?`${e.remoteAddress}:${e.remotePort}`:e.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function A(e){const t=new Error("Deadline exceeded");t.code=l.Status.DEADLINE_EXCEEDED,e.sendError(t),e.cancelled=!0,e.emit("cancelled","deadline")}t.Http2ServerCallStream=x},5919:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerCredentials=void 0;const n=i(8283);class s{static createInsecure(){return new r}static createSsl(e,t,i=!1){if(null!==e&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if("boolean"!=typeof i)throw new TypeError("checkClientCertificate must be a boolean");const s=[],r=[];for(let e=0;e<t.length;e++){const i=t[e];if(null===i||"object"!=typeof i)throw new TypeError(`keyCertPair[${e}] must be an object`);if(!Buffer.isBuffer(i.private_key))throw new TypeError(`keyCertPair[${e}].private_key must be a Buffer`);if(!Buffer.isBuffer(i.cert_chain))throw new TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`);s.push(i.cert_chain),r.push(i.private_key)}return new a({ca:e||(0,n.getDefaultRootsData)()||void 0,cert:s,key:r,requestCert:i,ciphers:n.CIPHER_SUITES})}}t.ServerCredentials=s;class r extends s{_isSecure(){return!1}_getSettings(){return null}}class a extends s{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}},903:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Server=void 0;const n=i(5158),s=i(3189),r=i(777),a=i(5919),o=i(3513),l=i(8626),c=i(8741),u=i(5165),h=i(8950),d=i(5503),f=~(1<<31),{HTTP2_HEADER_PATH:p}=n.constants;function m(){}function g(e){return{code:s.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`}}t.Server=class{constructor(e){var t,i,n,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new h.ChannelzTrace,this.callTracker=new h.ChannelzCallTracker,this.listenerChildrenTracker=new h.ChannelzChildrenTracker,this.sessionChildrenTracker=new h.ChannelzChildrenTracker,this.options=null!=e?e:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,h.registerChannelzServer)((()=>this.getChannelzInfo()),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(t=this.options["grpc.max_connection_age_ms"])&&void 0!==t?t:f,this.maxConnectionAgeGraceMs=null!==(i=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==i?i:f,this.keepaliveTimeMs=null!==(n=this.options["grpc.keepalive_time_ms"])&&void 0!==n?n:2147483647,this.keepaliveTimeoutMs=null!==(s=this.options["grpc.keepalive_timeout_ms"])&&void 0!==s?s:2e4,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,i,n;const s=this.sessions.get(e),r=e.socket,a=r.remoteAddress?(0,c.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,o=r.localAddress?(0,c.stringToSubchannelAddress)(r.localAddress,r.localPort):null;let l;if(e.encrypted){const e=r,i=e.getCipher(),n=e.getCertificate(),s=e.getPeerCertificate();l={cipherSuiteStandardName:null!==(t=i.standardName)&&void 0!==t?t:null,cipherSuiteOtherName:i.standardName?null:i.name,localCertificate:n&&"raw"in n?n.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else l=null;return{remoteAddress:a,localAddress:o,security:l,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(i=e.state.localWindowSize)&&void 0!==i?i:null,remoteFlowControlWindow:null!==(n=e.state.remoteWindowSize)&&void 0!==n?n:null}}}trace(e){l.trace(s.LogVerbosity.DEBUG,"server","("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)throw new Error("addService() requires two objects as arguments");const i=Object.keys(e);if(0===i.length)throw new Error("Cannot add an empty service to a server");i.forEach((i=>{const n=e[i];let s;s=n.requestStream?n.responseStream?"bidi":"clientStream":n.responseStream?"serverStream":"unary";let r,a=t[i];if(void 0===a&&"string"==typeof n.originalName&&(a=t[n.originalName]),r=void 0!==a?a.bind(t):function(e,t){const i=g(t);switch(e){case"unary":case"clientStream":return(e,t)=>{t(i,null)};case"serverStream":case"bidi":return e=>{e.emit("error",i)};default:throw new Error(`Invalid handlerType ${e}`)}}(s,i),!1===this.register(n.path,r,n.responseSerialize,n.requestDeserialize,s))throw new Error(`Method handler for ${n.path} already provided.`)}))}removeService(e){if(null===e||"object"!=typeof e)throw new Error("removeService() requires object as argument");Object.keys(e).forEach((t=>{const i=e[t];this.unregister(i.path)}))}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,i){if(!0===this.started)throw new Error("server is already started");if("string"!=typeof e)throw new TypeError("port must be a string");if(null===t||!(t instanceof a.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if("function"!=typeof i)throw new TypeError("callback must be a function");const r=(0,u.parseUri)(e);if(null===r)throw new Error(`Could not parse port "${e}"`);const d=(0,o.mapUriDefaultScheme)(r);if(null===d)throw new Error(`Could not get a default scheme for port "${e}"`);const f={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?f.maxSessionMemory=this.options["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(f.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});const p=(e,t)=>{process.nextTick((()=>i(e,t)))},g=()=>{let e;if(t._isSecure()){const i=Object.assign(f,t._getSettings());e=n.createSecureServer(i),e.on("secureConnection",(e=>{e.on("error",(e=>{this.trace("An incoming TLS connection closed with error: "+e.message)}))}))}else e=n.createServer(f);return e.setTimeout(0,m),this._setupHandlers(e),e},v=(e,t,i)=>0===e.length?Promise.resolve({port:t,count:i}):Promise.all(e.map((e=>{let i;this.trace("Attempting to bind "+(0,c.subchannelAddressToString)(e)),i=(0,c.isTcpSubchannelAddress)(e)?{host:e.host,port:t}:e;const n=g();return new Promise(((s,r)=>{const a=t=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(e)+" with error "+t.message),s(t)};n.once("error",a),n.listen(i,(()=>{const e=n.address();let i,r;i="string"==typeof e?{path:e}:{host:e.address,port:e.port},r=(0,h.registerChannelzSocket)((0,c.subchannelAddressToString)(i),(()=>({localAddress:i,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null})),this.channelzEnabled),this.channelzEnabled&&this.listenerChildrenTracker.refChild(r),this.http2ServerList.push({server:n,channelzRef:r}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(i)),s("port"in i?i.port:t),n.removeListener("error",a)}))}))}))).then((e=>{let n=0;for(const i of e)if("number"==typeof i&&(n+=1,i!==t))throw new Error("Invalid state: multiple port numbers added from single address");return{port:t,count:n+i}})),y=e=>{if(0===e.length)return Promise.resolve({port:0,count:0});const t=e[0],i=g();return new Promise(((n,s)=>{const r=i=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(t)+" with error "+i.message),n(y(e.slice(1)))};i.once("error",r),i.listen(t,(()=>{const t=i.address(),s={host:t.address,port:t.port};let a;a=(0,h.registerChannelzSocket)((0,c.subchannelAddressToString)(s),(()=>({localAddress:s,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null})),this.channelzEnabled),this.channelzEnabled&&this.listenerChildrenTracker.refChild(a),this.http2ServerList.push({server:i,channelzRef:a}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(s)),n(v(e.slice(1),t.port,1)),i.removeListener("error",r)}))}))},S={onSuccessfulResolution:(t,i,n)=>{if(S.onSuccessfulResolution=()=>{},0===t.length)return void p(new Error(`No addresses resolved for port ${e}`),0);let r;r=(0,c.isTcpSubchannelAddress)(t[0])?0===t[0].port?y(t):v(t,t[0].port,0):v(t,1,0),r.then((e=>{if(0===e.count){const e=`No address added out of total ${t.length} resolved`;l.log(s.LogVerbosity.ERROR,e),p(new Error(e),0)}else e.count<t.length&&l.log(s.LogVerbosity.INFO,`WARNING Only ${e.count} addresses added out of total ${t.length} resolved`),p(null,e.port)}),(e=>{const i=`No address added out of total ${t.length} resolved`;l.log(s.LogVerbosity.ERROR,i),p(new Error(i),0)}))},onError:e=>{p(new Error(e.details),0)}};(0,o.createResolver)(d,S,this.options).updateResolution()}forceShutdown(){for(const{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close((()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,h.unregisterChannelzRef)(t))}));this.started=!1,this.sessions.forEach(((e,t)=>{t.destroy(n.constants.NGHTTP2_CANCEL)})),this.sessions.clear(),this.channelzEnabled&&(0,h.unregisterChannelzRef)(this.channelzRef)}register(e,t,i,n,s){return!this.handlers.has(e)&&(this.handlers.set(e,{func:t,serialize:i,deserialize:n,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every((({server:e})=>!0!==e.listening)))throw new Error("server must be bound in order to start");if(!0===this.started)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){const t=t=>{this.channelzEnabled&&(0,h.unregisterChannelzRef)(this.channelzRef),e(t)};let i=0;function n(){i--,0===i&&t()}this.started=!1;for(const{server:e,channelzRef:t}of this.http2ServerList)e.listening&&(i++,e.close((()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,h.unregisterChannelzRef)(t)),n()})));this.sessions.forEach(((e,t)=>{t.closed||(i+=1,t.close(n))})),0===i&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){const i=t[n.constants.HTTP2_HEADER_CONTENT_TYPE];return!("string"!=typeof i||!i.startsWith("application/grpc"))||(e.respond({[n.constants.HTTP2_HEADER_STATUS]:n.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(e){const t=e[p];this.trace("Received call to method "+t+" at address "+this.serverAddressString);const i=this.handlers.get(t);if(void 0===i)throw this.trace("No handler registered for method "+t+". Sending UNIMPLEMENTED status."),g(t);return i}_respondWithError(e,t,i=null){const n=new r.Http2ServerCallStream(t,null,this.options);void 0===e.code&&(e.code=s.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==i||i.streamTracker.addCallFailed()),n.sendError(e)}_channelzHandler(e,t){var i;const n=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),null==n||n.streamTracker.addCallStarted(),!this._verifyContentType(e,t))return this.callTracker.addCallFailed(),void(null==n||n.streamTracker.addCallFailed());let a;try{a=this._retrieveHandler(t)}catch(t){return void this._respondWithError({details:(0,d.getErrorMessage)(t),code:null!==(i=(0,d.getErrorCode)(t))&&void 0!==i?i:void 0},e,n)}const o=new r.Http2ServerCallStream(e,a,this.options);o.once("callEnd",(e=>{e===s.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()})),n&&(o.once("streamEnd",(e=>{e?n.streamTracker.addCallSucceeded():n.streamTracker.addCallFailed()})),o.on("sendMessage",(()=>{n.messagesSent+=1,n.lastMessageSentTimestamp=new Date})),o.on("receiveMessage",(()=>{n.messagesReceived+=1,n.lastMessageReceivedTimestamp=new Date}))),this._runHandlerForCall(o,a,t)||(this.callTracker.addCallFailed(),null==n||n.streamTracker.addCallFailed(),o.sendError({code:s.Status.INTERNAL,details:`Unknown handler type: ${a.type}`}))}_streamHandler(e,t){var i;if(!0!==this._verifyContentType(e,t))return;let n;try{n=this._retrieveHandler(t)}catch(t){return void this._respondWithError({details:(0,d.getErrorMessage)(t),code:null!==(i=(0,d.getErrorCode)(t))&&void 0!==i?i:void 0},e,null)}const a=new r.Http2ServerCallStream(e,n,this.options);this._runHandlerForCall(a,n,t)||a.sendError({code:s.Status.INTERNAL,details:`Unknown handler type: ${n.type}`})}_runHandlerForCall(e,t,i){var n;const s=e.receiveMetadata(i),a=null!==(n=s.get("grpc-encoding")[0])&&void 0!==n?n:"identity";s.remove("grpc-encoding");const{type:o}=t;if("unary"===o)!function(e,t,i,n){e.receiveUnaryMessage(n,((n,s)=>{if(n)return void e.sendError(n);if(void 0===s||e.cancelled)return;const a=new r.ServerUnaryCallImpl(e,i,s);t.func(a,((t,i,n,s)=>{e.sendUnaryMessage(t,i,n,s)}))}))}(e,t,s,a);else if("clientStream"===o)!function(e,t,i,n){const s=new r.ServerReadableStreamImpl(e,i,t.deserialize,n);function a(t,i,n,r){s.destroy(),e.sendUnaryMessage(t,i,n,r)}e.cancelled||(s.on("error",a),t.func(s,a))}(e,t,s,a);else if("serverStream"===o)!function(e,t,i,n){e.receiveUnaryMessage(n,((n,s)=>{if(n)return void e.sendError(n);if(void 0===s||e.cancelled)return;const a=new r.ServerWritableStreamImpl(e,i,t.serialize,s);t.func(a)}))}(e,t,s,a);else{if("bidi"!==o)return!1;!function(e,t,i,n){const s=new r.ServerDuplexStreamImpl(e,i,t.serialize,t.deserialize,n);e.cancelled||t.func(s)}(e,t,s,a)}return!0}_setupHandlers(e){if(null===e)return;const t=e.address();let i="null";t&&(i="string"==typeof t?t:t.address+":"+t.port),this.serverAddressString=i;const s=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",s.bind(this)),e.on("session",(e=>{var t,i,s,r,a;if(!this.started)return void e.destroy();let o;o=(0,h.registerChannelzSocket)(null!==(t=e.socket.remoteAddress)&&void 0!==t?t:"unknown",this.getChannelzSessionInfoGetter(e),this.channelzEnabled);const l={ref:o,streamTracker:new h.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(e,l);const c=e.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+c),this.sessionChildrenTracker.refChild(o));let u=null,d=null,p=!1;if(this.maxConnectionAgeMs!==f){const t=this.maxConnectionAgeMs/10,r=Math.random()*t*2-t;u=null===(s=(i=setTimeout((()=>{var t,i;p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+c);try{e.goaway(n.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch(t){return void e.destroy()}e.close(),this.maxConnectionAgeGraceMs!==f&&(d=null===(i=(t=setTimeout((()=>{e.destroy()}),this.maxConnectionAgeGraceMs)).unref)||void 0===i?void 0:i.call(t))}),this.maxConnectionAgeMs+r)).unref)||void 0===s?void 0:s.call(i)}const m=null===(a=(r=setInterval((()=>{var t,i;const n=null===(i=(t=setTimeout((()=>{p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+c),e.close()}),this.keepaliveTimeoutMs)).unref)||void 0===i?void 0:i.call(t);try{e.ping(((e,t,i)=>{clearTimeout(n)}))}catch(t){e.destroy()}}),this.keepaliveTimeMs)).unref)||void 0===a?void 0:a.call(r);e.on("close",(()=>{this.channelzEnabled&&(p||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+c),this.sessionChildrenTracker.unrefChild(o),(0,h.unregisterChannelzRef)(o)),u&&clearTimeout(u),d&&clearTimeout(d),m&&clearTimeout(m),this.sessions.delete(e)}))}))}}},235:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractAndSelectServiceConfig=t.validateServiceConfig=t.validateRetryThrottling=void 0;const n=i(2037),s=i(3189),r=i(1192),a=/^\d+(\.\d{1,9})?s$/;function o(e){if(!("service"in e)||"string"!=typeof e.service)throw new Error("Invalid method config name: invalid service");const t={service:e.service};if("method"in e){if("string"!=typeof e.method)throw new Error("Invalid method config name: invalid method");t.method=e.method}return t}function l(e){var t;const i={name:[]};if(!("name"in e)||!Array.isArray(e.name))throw new Error("Invalid method config: invalid name array");for(const t of e.name)i.name.push(o(t));if("waitForReady"in e){if("boolean"!=typeof e.waitForReady)throw new Error("Invalid method config: invalid waitForReady");i.waitForReady=e.waitForReady}if("timeout"in e)if("object"==typeof e.timeout){if(!("seconds"in e.timeout)||"number"!=typeof e.timeout.seconds)throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in e.timeout)||"number"!=typeof e.timeout.nanos)throw new Error("Invalid method config: invalid timeout.nanos");i.timeout=e.timeout}else{if("string"!=typeof e.timeout||!a.test(e.timeout))throw new Error("Invalid method config: invalid timeout");{const n=e.timeout.substring(0,e.timeout.length-1).split(".");i.timeout={seconds:0|n[0],nanos:0|(null!==(t=n[1])&&void 0!==t?t:0)}}}if("maxRequestBytes"in e){if("number"!=typeof e.maxRequestBytes)throw new Error("Invalid method config: invalid maxRequestBytes");i.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if("number"!=typeof e.maxResponseBytes)throw new Error("Invalid method config: invalid maxRequestBytes");i.maxResponseBytes=e.maxResponseBytes}if("retryPolicy"in e){if("hedgingPolicy"in e)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");i.retryPolicy=function(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in e)||"string"!=typeof e.initialBackoff||!a.test(e.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in e)||"string"!=typeof e.maxBackoff||!a.test(e.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in e)||"number"!=typeof e.backoffMultiplier||e.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in e)||!Array.isArray(e.retryableStatusCodes))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===e.retryableStatusCodes.length)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(const t of e.retryableStatusCodes)if("number"==typeof t){if(!Object.values(s.Status).includes(t))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else{if("string"!=typeof t)throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");if(!Object.values(s.Status).includes(t.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}return{maxAttempts:e.maxAttempts,initialBackoff:e.initialBackoff,maxBackoff:e.maxBackoff,backoffMultiplier:e.backoffMultiplier,retryableStatusCodes:e.retryableStatusCodes}}(e.retryPolicy)}else"hedgingPolicy"in e&&(i.hedgingPolicy=function(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in e&&("string"!=typeof e.hedgingDelay||!a.test(e.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in e&&Array.isArray(e.nonFatalStatusCodes))for(const t of e.nonFatalStatusCodes)if("number"==typeof t){if(!Object.values(s.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else{if("string"!=typeof t)throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");if(!Object.values(s.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}const t={maxAttempts:e.maxAttempts};return e.hedgingDelay&&(t.hedgingDelay=e.hedgingDelay),e.nonFatalStatusCodes&&(t.nonFatalStatusCodes=e.nonFatalStatusCodes),t}(e.hedgingPolicy));return i}function c(e){if(!("maxTokens"in e)||"number"!=typeof e.maxTokens||e.maxTokens<=0||e.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in e)||"number"!=typeof e.tokenRatio||e.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+e.maxTokens.toFixed(3),tokenRatio:+e.tokenRatio.toFixed(3)}}function u(e){const t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e){if("string"!=typeof e.loadBalancingPolicy)throw new Error("Invalid service config: invalid loadBalancingPolicy");t.loadBalancingPolicy=e.loadBalancingPolicy}if("loadBalancingConfig"in e){if(!Array.isArray(e.loadBalancingConfig))throw new Error("Invalid service config: invalid loadBalancingConfig");for(const i of e.loadBalancingConfig)t.loadBalancingConfig.push((0,r.validateLoadBalancingConfig)(i))}if("methodConfig"in e&&Array.isArray(e.methodConfig))for(const i of e.methodConfig)t.methodConfig.push(l(i));"retryThrottling"in e&&(t.retryThrottling=c(e.retryThrottling));const i=[];for(const e of t.methodConfig)for(const t of e.name){for(const e of i)if(t.service===e.service&&t.method===e.method)throw new Error(`Invalid service config: duplicate name ${t.service}/${t.method}`);i.push(t)}return t}function h(e){if(!("serviceConfig"in e))throw new Error("Invalid service config choice: missing service config");const t={serviceConfig:u(e.serviceConfig)};if("clientLanguage"in e){if(!Array.isArray(e.clientLanguage))throw new Error("Invalid service config choice: invalid clientLanguage");t.clientLanguage=[];for(const i of e.clientLanguage){if("string"!=typeof i)throw new Error("Invalid service config choice: invalid clientLanguage");t.clientLanguage.push(i)}}if("clientHostname"in e){if(!Array.isArray(e.clientHostname))throw new Error("Invalid service config choice: invalid clientHostname");t.clientHostname=[];for(const i of e.clientHostname){if("string"!=typeof i)throw new Error("Invalid service config choice: invalid clientHostname");t.clientHostname.push(i)}}if("percentage"in e){if(!("number"==typeof e.percentage&&0<=e.percentage&&e.percentage<=100))throw new Error("Invalid service config choice: invalid percentage");t.percentage=e.percentage}const i=["clientLanguage","percentage","clientHostname","serviceConfig"];for(const t in e)if(!i.includes(t))throw new Error(`Invalid service config choice: unexpected field ${t}`);return t}function d(e,t){if(!Array.isArray(e))throw new Error("Invalid service config list");for(const i of e){const e=h(i);if(!("number"==typeof e.percentage&&t>e.percentage)){if(Array.isArray(e.clientHostname)){let t=!1;for(const i of e.clientHostname)i===n.hostname()&&(t=!0);if(!t)continue}if(Array.isArray(e.clientLanguage)){let t=!1;for(const i of e.clientLanguage)"node"===i&&(t=!0);if(!t)continue}return e.serviceConfig}}throw new Error("No matching service config found")}t.validateRetryThrottling=c,t.validateServiceConfig=u,t.extractAndSelectServiceConfig=function(e,t){for(const i of e)if(i.length>0&&i[0].startsWith("grpc_config=")){const e=i.join("").substring("grpc_config=".length);return d(JSON.parse(e),t)}return null}},930:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBuilder=void 0,t.StatusBuilder=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){const e={};return null!==this.code&&(e.code=this.code),null!==this.details&&(e.details=this.details),null!==this.metadata&&(e.metadata=this.metadata),e}}},1524:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.StreamDecoder=void 0,function(e){e[e.NO_DATA=0]="NO_DATA",e[e.READING_SIZE=1]="READING_SIZE",e[e.READING_MESSAGE=2]="READING_MESSAGE"}(i||(i={})),t.StreamDecoder=class{constructor(){this.readState=i.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t,n=0;const s=[];for(;n<e.length;)switch(this.readState){case i.NO_DATA:this.readCompressFlag=e.slice(n,n+1),n+=1,this.readState=i.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case i.READING_SIZE:if(t=Math.min(e.length-n,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,n,n+t),this.readSizeRemaining-=t,n+=t,0===this.readSizeRemaining)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=i.READING_MESSAGE;else{const e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=i.NO_DATA,s.push(e)}break;case i.READING_MESSAGE:if(t=Math.min(e.length-n,this.readMessageRemaining),this.readPartialMessage.push(e.slice(n,n+t)),this.readMessageRemaining-=t,n+=t,0===this.readMessageRemaining){const e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),t=Buffer.concat(e,this.readMessageSize+5);this.readState=i.NO_DATA,s.push(t)}break;default:throw new Error("Unexpected read state")}return s}}},8741:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToSubchannelAddress=t.subchannelAddressToString=t.subchannelAddressEqual=t.isTcpSubchannelAddress=void 0;const n=i(1808);function s(e){return"port"in e}t.isTcpSubchannelAddress=s,t.subchannelAddressEqual=function(e,t){return s(e)?s(t)&&e.host===t.host&&e.port===t.port:!s(t)&&e.path===t.path},t.subchannelAddressToString=function(e){return s(e)?e.host+":"+e.port:e.path},t.stringToSubchannelAddress=function(e,t){return(0,n.isIP)(e)?{host:e,port:null!=t?t:443}:{path:e}}},9697:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Http2SubchannelCall=void 0;const n=i(5158),s=i(2037),r=i(3189),a=i(4664),o=i(1524),l=i(8626),c=i(3189),{HTTP2_HEADER_STATUS:u,HTTP2_HEADER_CONTENT_TYPE:h,NGHTTP2_CANCEL:d}=n.constants;t.Http2SubchannelCall=class{constructor(e,t,i,l,c){this.http2Stream=e,this.callStatsTracker=t,this.listener=i,this.subchannel=l,this.callId=c,this.decoder=new o.StreamDecoder,this.isReadFilterPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=r.Status.UNKNOWN,this.finalStatus=null,this.internalError=null,this.disconnectListener=()=>{this.endCall({code:r.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})},l.addDisconnectListener(this.disconnectListener),l.callRef(),e.on("response",((e,t)=>{let i="";for(const t of Object.keys(e))i+="\t\t"+t+": "+e[t]+"\n";switch(this.trace("Received server headers:\n"+i),e[":status"]){case 400:this.mappedStatusCode=r.Status.INTERNAL;break;case 401:this.mappedStatusCode=r.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=r.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=r.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=r.Status.UNAVAILABLE;break;default:this.mappedStatusCode=r.Status.UNKNOWN}if(t&n.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(e);else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){return void this.endCall({code:r.Status.UNKNOWN,details:e.message,metadata:new a.Metadata})}this.listener.onReceiveMetadata(t)}})),e.on("trailers",(e=>{this.handleTrailers(e)})),e.on("data",(e=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+e.length);const t=this.decoder.write(e);for(const e of t)this.trace("parsed message of length "+e.length),this.callStatsTracker.addMessageReceived(),this.tryPush(e)})),e.on("end",(()=>{this.readsClosed=!0,this.maybeOutputStatus()})),e.on("close",(()=>{process.nextTick((()=>{var t;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),(null===(t=this.finalStatus)||void 0===t?void 0:t.code)===r.Status.OK)return;let i,s="";switch(e.rstCode){case n.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;i=r.Status.INTERNAL,s=`Received RST_STREAM with code ${e.rstCode}`;break;case n.constants.NGHTTP2_REFUSED_STREAM:i=r.Status.UNAVAILABLE,s="Stream refused by server";break;case n.constants.NGHTTP2_CANCEL:i=r.Status.CANCELLED,s="Call cancelled";break;case n.constants.NGHTTP2_ENHANCE_YOUR_CALM:i=r.Status.RESOURCE_EXHAUSTED,s="Bandwidth exhausted or memory limit exceeded";break;case n.constants.NGHTTP2_INADEQUATE_SECURITY:i=r.Status.PERMISSION_DENIED,s="Protocol not secure enough";break;case n.constants.NGHTTP2_INTERNAL_ERROR:i=r.Status.INTERNAL,null===this.internalError?s=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(i=r.Status.UNAVAILABLE,s=this.internalError.message):s=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:i=r.Status.INTERNAL,s=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:i,details:s,metadata:new a.Metadata,rstCode:e.rstCode})}))})),e.on("error",(e=>{"ERR_HTTP2_STREAM_ERROR"!==e.code&&(this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+function(e){for(const[t,i]of Object.entries(s.constants.errno))if(i===e)return t;return"Unknown system error "+e}(e.errno)+" syscall="+e.syscall),this.internalError=e),this.callStatsTracker.onStreamEnd(!1)}))}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callStatsTracker.onCallEnd(this.finalStatus),process.nextTick((()=>{this.listener.onReceiveStatus(this.finalStatus)})),this.http2Stream.resume(),this.subchannel.callUnref(),this.subchannel.removeDisconnectListener(this.disconnectListener))}trace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_call","["+this.callId+"] "+e)}endCall(e){null!==this.finalStatus&&this.finalStatus.code!==r.Status.OK||(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null!==this.finalStatus&&(this.finalStatus.code!==r.Status.OK||this.readsClosed&&0===this.unpushedReadMessages.length&&!this.isReadFilterPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,process.nextTick((()=>{this.statusOutput||(this.listener.onReceiveMessage(e),this.maybeOutputStatus())}))}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callStatsTracker.onStreamEnd(!0);let t,i="";for(const t of Object.keys(e))i+="\t\t"+t+": "+e[t]+"\n";this.trace("Received server trailers:\n"+i);try{t=a.Metadata.fromHttp2Headers(e)}catch(e){t=new a.Metadata}const n=t.getMap();let s=this.mappedStatusCode;if(s===r.Status.UNKNOWN&&"string"==typeof n["grpc-status"]){const e=Number(n["grpc-status"]);e in r.Status&&(s=e,this.trace("received status code "+e+" from server")),t.remove("grpc-status")}let o="";if("string"==typeof n["grpc-message"]){try{o=decodeURI(n["grpc-message"])}catch(e){o=n["grpc-message"]}t.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}const l={code:s,details:o,metadata:t};this.endCall(l)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;t=(null===(e=this.finalStatus)||void 0===e?void 0:e.code)===r.Status.OK?n.constants.NGHTTP2_NO_ERROR:n.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new a.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.subchannel.getAddress()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==r.Status.OK)return this.readsClosed=!0,void this.maybeOutputStatus();if(this.canPush=!0,this.unpushedReadMessages.length>0){const e=this.unpushedReadMessages.shift();this.push(e)}else this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);const i=t=>{var i;let n=r.Status.UNAVAILABLE;"ERR_STREAM_WRITE_AFTER_END"===(null==t?void 0:t.code)&&(n=r.Status.INTERNAL),t&&this.cancelWithStatus(n,`Write error: ${t.message}`),null===(i=e.callback)||void 0===i||i.call(e)};this.trace("sending data chunk of length "+t.length),this.callStatsTracker.addMessageSent();try{this.http2Stream.write(t,i)}catch(e){this.endCall({code:r.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}},8862:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseSubchannelWrapper=void 0,t.BaseSubchannelWrapper=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}}},651:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSubchannelPool=t.SubchannelPool=void 0;const n=i(8938),s=i(8825),r=i(8741),a=i(5165);class o{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(const t in this.pool){const i=this.pool[t].filter((e=>!e.subchannel.unrefIfOneRef()));i.length>0&&(e=!1),this.pool[t]=i}e&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;null===this.cleanupTimer&&(this.cleanupTimer=setInterval((()=>{this.unrefUnusedSubchannels()}),1e4),null===(t=(e=this.cleanupTimer).unref)||void 0===t||t.call(e))}getOrCreateSubchannel(e,t,i,o){this.ensureCleanupTask();const l=(0,a.uriToString)(e);if(l in this.pool){const e=this.pool[l];for(const s of e)if((0,r.subchannelAddressEqual)(t,s.subchannelAddress)&&(0,n.channelOptionsEqual)(i,s.channelArguments)&&o._equals(s.channelCredentials))return s.subchannel}const c=new s.Subchannel(e,t,i,o);return l in this.pool||(this.pool[l]=[]),this.pool[l].push({subchannelAddress:t,channelArguments:i,channelCredentials:o,subchannel:c}),c.ref(),c}}t.SubchannelPool=o;const l=new o;t.getSubchannelPool=function(e){return e?l:new o}},8825:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subchannel=void 0;const n=i(5158),s=i(4404),r=i(207),a=i(3510),o=i(3513),l=i(8626),c=i(3189),u=i(6042),h=i(1808),d=i(5165),f=i(8741),p=i(8950),m=i(9697),g=i(868),v=i(6569).i8,y="subchannel",S=~(1<<31),{HTTP2_HEADER_AUTHORITY:b,HTTP2_HEADER_CONTENT_TYPE:C,HTTP2_HEADER_METHOD:T,HTTP2_HEADER_PATH:E,HTTP2_HEADER_TE:w,HTTP2_HEADER_USER_AGENT:_}=n.constants,k=Buffer.from("too_many_pings","ascii");t.Subchannel=class{constructor(e,t,i,n){this.channelTarget=e,this.subchannelAddress=t,this.options=i,this.credentials=n,this.connectivityState=r.ConnectivityState.IDLE,this.session=null,this.continueConnecting=!1,this.stateListeners=[],this.disconnectListeners=new Set,this.keepaliveTimeMs=S,this.keepaliveTimeoutMs=2e4,this.keepaliveWithoutCalls=!1,this.callRefcount=0,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new p.ChannelzCallTracker,this.childrenTracker=new p.ChannelzChildrenTracker,this.channelzSocketRef=null,this.remoteName=null,this.streamTracker=new p.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.userAgent=[i["grpc.primary_user_agent"],`grpc-node-js/${v}`,i["grpc.secondary_user_agent"]].filter((e=>e)).join(" "),"grpc.keepalive_time_ms"in i&&(this.keepaliveTimeMs=i["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in i&&(this.keepaliveTimeoutMs=i["grpc.keepalive_timeout_ms"]),this.keepaliveWithoutCalls="grpc.keepalive_permit_without_calls"in i&&1===i["grpc.keepalive_permit_without_calls"],this.keepaliveIntervalId=setTimeout((()=>{}),0),clearTimeout(this.keepaliveIntervalId),this.keepaliveTimeoutId=setTimeout((()=>{}),0),clearTimeout(this.keepaliveTimeoutId);const s={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new a.BackoffTimeout((()=>{this.handleBackoffTimer()}),s),this.subchannelAddressString=(0,f.subchannelAddressToString)(t),0===i["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new p.ChannelzTrace,this.channelzRef=(0,p.registerChannelzSubchannel)(this.subchannelAddressString,(()=>this.getChannelzInfo()),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(i,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}getChannelzSocketInfo(){var e,t,i;if(null===this.session)return null;const n=this.session.socket,s=n.remoteAddress?(0,f.stringToSubchannelAddress)(n.remoteAddress,n.remotePort):null,r=n.localAddress?(0,f.stringToSubchannelAddress)(n.localAddress,n.localPort):null;let a;if(this.session.encrypted){const t=n,i=t.getCipher(),s=t.getCertificate(),r=t.getPeerCertificate();a={cipherSuiteStandardName:null!==(e=i.standardName)&&void 0!==e?e:null,cipherSuiteOtherName:i.standardName?null:i.name,localCertificate:s&&"raw"in s?s.raw:null,remoteCertificate:r&&"raw"in r?r.raw:null}}else a=null;return{remoteAddress:s,localAddress:r,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(t=this.session.state.localWindowSize)&&void 0!==t?t:null,remoteFlowControlWindow:null!==(i=this.session.state.remoteWindowSize)&&void 0!==i?i:null}}resetChannelzSocketInfo(){this.channelzEnabled&&(this.channelzSocketRef&&((0,p.unregisterChannelzRef)(this.channelzSocketRef),this.childrenTracker.unrefChild(this.channelzSocketRef),this.channelzSocketRef=null),this.remoteName=null,this.streamTracker=new p.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null)}trace(e){l.trace(c.LogVerbosity.DEBUG,y,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_flowctrl","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(c.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.CONNECTING):this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}sendPing(){var e,t;this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId=setTimeout((()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()}),this.keepaliveTimeoutMs),null===(t=(e=this.keepaliveTimeoutId).unref)||void 0===t||t.call(e);try{this.session.ping(((e,t,i)=>{this.keepaliveTrace("Received ping response"),clearTimeout(this.keepaliveTimeoutId)}))}catch(e){this.transitionToState([r.ConnectivityState.READY],r.ConnectivityState.TRANSIENT_FAILURE)}}startKeepalivePings(){var e,t;this.keepaliveIntervalId=setInterval((()=>{this.sendPing()}),this.keepaliveTimeMs),null===(t=(e=this.keepaliveIntervalId).unref)||void 0===t||t.call(e)}stopKeepalivePings(){clearInterval(this.keepaliveIntervalId),clearTimeout(this.keepaliveTimeoutId)}createSession(e){var t,i,a;e.realTarget?(this.remoteName=(0,d.uriToString)(e.realTarget),this.trace("creating HTTP/2 session through proxy to "+e.realTarget)):(this.remoteName=null,this.trace("creating HTTP/2 session"));const u=(0,o.getDefaultAuthority)(null!==(t=e.realTarget)&&void 0!==t?t:this.channelTarget);let f=this.credentials._getConnectionOptions()||{};f.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in this.options?f.maxSessionMemory=this.options["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER;let m="http://";if("secureContext"in f){if(m="https://",this.options["grpc.ssl_target_name_override"]){const e=this.options["grpc.ssl_target_name_override"];f.checkServerIdentity=(t,i)=>(0,s.checkServerIdentity)(e,i),f.servername=e}else{const e=null!==(a=null===(i=(0,d.splitHostPort)(u))||void 0===i?void 0:i.host)&&void 0!==a?a:"localhost";f.servername=e}e.socket&&(f.createConnection=(t,i)=>e.socket)}else f.createConnection=(t,i)=>e.socket?e.socket:h.connect(this.subchannelAddress);f=Object.assign(Object.assign({},f),this.subchannelAddress);const g=n.connect(m+u,f);this.session=g,this.channelzSocketRef=(0,p.registerChannelzSocket)(this.subchannelAddressString,(()=>this.getChannelzSocketInfo()),this.channelzEnabled),this.channelzEnabled&&this.childrenTracker.refChild(this.channelzSocketRef),g.unref(),g.once("connect",(()=>{this.session===g&&this.transitionToState([r.ConnectivityState.CONNECTING],r.ConnectivityState.READY)})),g.once("close",(()=>{this.session===g&&(this.trace("connection closed"),this.transitionToState([r.ConnectivityState.CONNECTING],r.ConnectivityState.TRANSIENT_FAILURE),this.transitionToState([r.ConnectivityState.READY],r.ConnectivityState.IDLE))})),g.once("goaway",((e,t,i)=>{this.session===g&&(e===n.constants.NGHTTP2_ENHANCE_YOUR_CALM&&i.equals(k)&&(this.keepaliveTimeMs=Math.min(2*this.keepaliveTimeMs,S),l.log(c.LogVerbosity.ERROR,`Connection to ${(0,d.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTimeMs} ms`)),this.trace("connection closed by GOAWAY with code "+e),this.transitionToState([r.ConnectivityState.CONNECTING,r.ConnectivityState.READY],r.ConnectivityState.IDLE))})),g.once("error",(e=>{this.trace("connection closed with error "+e.message)})),l.isTracerEnabled(y)&&(g.on("remoteSettings",(e=>{this.trace("new settings received"+(this.session!==g?" on the old connection":"")+": "+JSON.stringify(e))})),g.on("localSettings",(e=>{this.trace("local settings acknowledged by remote"+(this.session!==g?" on the old connection":"")+": "+JSON.stringify(e))})))}startConnectingInternal(){var e,t;const i=this.credentials._getConnectionOptions()||{};if("secureContext"in i)if(i.ALPNProtocols=["h2"],this.options["grpc.ssl_target_name_override"]){const e=this.options["grpc.ssl_target_name_override"];i.checkServerIdentity=(t,i)=>(0,s.checkServerIdentity)(e,i),i.servername=e}else if("grpc.http_connect_target"in this.options){const n=(0,o.getDefaultAuthority)(null!==(e=(0,d.parseUri)(this.options["grpc.http_connect_target"]))&&void 0!==e?e:{path:"localhost"}),s=(0,d.splitHostPort)(n);i.servername=null!==(t=null==s?void 0:s.host)&&void 0!==t?t:n}(0,u.getProxiedConnection)(this.subchannelAddress,this.options,i).then((e=>{this.createSession(e)}),(e=>{this.transitionToState([r.ConnectivityState.CONNECTING],r.ConnectivityState.TRANSIENT_FAILURE)}))}handleDisconnect(){this.transitionToState([r.ConnectivityState.READY],r.ConnectivityState.TRANSIENT_FAILURE);for(const e of this.disconnectListeners.values())e()}transitionToState(e,t){if(-1===e.indexOf(this.connectivityState))return!1;this.trace(r.ConnectivityState[this.connectivityState]+" -> "+r.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO",r.ConnectivityState[this.connectivityState]+" -> "+r.ConnectivityState[t]);const i=this.connectivityState;switch(this.connectivityState=t,t){case r.ConnectivityState.READY:this.stopBackoff();const e=this.session;e.socket.once("close",(()=>{this.session===e&&this.handleDisconnect()})),this.keepaliveWithoutCalls&&this.startKeepalivePings();break;case r.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case r.ConnectivityState.TRANSIENT_FAILURE:this.session&&this.session.close(),this.session=null,this.resetChannelzSocketInfo(),this.stopKeepalivePings(),this.backoffTimeout.isRunning()||process.nextTick((()=>{this.handleBackoffTimer()}));break;case r.ConnectivityState.IDLE:this.session&&this.session.close(),this.session=null,this.resetChannelzSocketInfo(),this.stopKeepalivePings();break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(const e of[...this.stateListeners])e(this,i,t);return!0}checkBothRefcounts(){0===this.callRefcount&&0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.transitionToState([r.ConnectivityState.CONNECTING,r.ConnectivityState.READY],r.ConnectivityState.IDLE),this.channelzEnabled&&(0,p.unregisterChannelzRef)(this.channelzRef))}callRef(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount+1)),0===this.callRefcount&&(this.session&&this.session.ref(),this.backoffTimeout.ref(),this.keepaliveWithoutCalls||this.startKeepalivePings()),this.callRefcount+=1}callUnref(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount-1)),this.callRefcount-=1,0===this.callRefcount&&(this.session&&this.session.unref(),this.backoffTimeout.unref(),this.keepaliveWithoutCalls||clearInterval(this.keepaliveIntervalId),this.checkBothRefcounts())}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.checkBothRefcounts()}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(e,t,i,n){const s=e.toHttp2Headers();let a;s[b]=t,s[_]=this.userAgent,s[C]="application/grpc",s[T]="POST",s[E]=i,s[w]="trailers";try{a=this.session.request(s)}catch(e){throw this.transitionToState([r.ConnectivityState.READY],r.ConnectivityState.TRANSIENT_FAILURE),e}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize);const o=this.session;let l;return this.internalsTrace("session.closed="+o.closed+" session.destroyed="+o.destroyed+" session.socket.destroyed="+o.socket.destroyed),this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),l={addMessageSent:()=>{this.messagesSent+=1,this.lastMessageSentTimestamp=new Date},addMessageReceived:()=>{this.messagesReceived+=1},onCallEnd:e=>{e.code===c.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()},onStreamEnd:e=>{o===this.session&&(e?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed())}}):l={addMessageSent:()=>{},addMessageReceived:()=>{},onCallEnd:()=>{},onStreamEnd:()=>{}},new m.Http2SubchannelCall(a,l,n,this,(0,g.getNextCallNumber)())}startConnecting(){this.transitionToState([r.ConnectivityState.IDLE],r.ConnectivityState.CONNECTING)||this.connectivityState===r.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){const t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}addDisconnectListener(e){this.disconnectListeners.add(e)}removeDisconnectListener(e){this.disconnectListeners.delete(e)}resetBackoff(){this.backoffTimeout.reset(),this.transitionToState([r.ConnectivityState.TRANSIENT_FAILURE],r.ConnectivityState.CONNECTING)}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}}},8283:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultRootsData=t.CIPHER_SUITES=void 0;const n=i(7147);t.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;const s=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH;let r=null;t.getDefaultRootsData=function(){return s?(null===r&&(r=n.readFileSync(s)),r):null}},5165:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uriToString=t.splitHostPort=t.parseUri=void 0;const i=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;t.parseUri=function(e){const t=i.exec(e);return null===t?null:{scheme:t[1],authority:t[2],path:t[3]}};const n=/^\d+$/;t.splitHostPort=function(e){if(e.startsWith("[")){const t=e.indexOf("]");if(-1===t)return null;const i=e.substring(1,t);if(-1===i.indexOf(":"))return null;if(e.length>t+1){if(":"===e[t+1]){const s=e.substring(t+2);return n.test(s)?{host:i,port:+s}:null}return null}return{host:i}}{const t=e.split(":");return 2===t.length?n.test(t[1])?{host:t[0],port:+t[1]}:null:{host:e}}},t.uriToString=function(e){let t="";return void 0!==e.scheme&&(t+=e.scheme+":"),void 0!==e.authority&&(t+="//"+e.authority+"/"),t+=e.path,t}},9421:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadFileDescriptorSetFromObject=t.loadFileDescriptorSetFromBuffer=t.fromJSON=t.loadSync=t.load=t.isAnyExtension=t.Long=void 0;const n=i(6884),s=i(3281),r=i(3961),a=i(5969),o=i(3720);t.Long=o,t.isAnyExtension=function(e){return"@type"in e&&"string"==typeof e["@type"]};const l={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function c(e,t){const i=(n=t,r=e.name,""===n?r:n+"."+r);var n,r;return function(e){return e instanceof s.Service||e instanceof s.Type||e instanceof s.Enum}(e)?[[i,e]]:function(e){return e instanceof s.Namespace||e instanceof s.Root}(e)&&void 0!==e.nested?Object.keys(e.nested).map((t=>c(e.nested[t],i))).reduce(((e,t)=>e.concat(t)),[]):[]}function u(e,t){return function(i){return e.toObject(e.decode(i),t)}}function h(e){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`);const i=e.fromObject(t);return e.encode(i).finish()}}function d(e,t,i,s){const r=e.resolvedRequestType,a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:h(r),requestDeserialize:u(r,i),responseSerialize:h(a),responseDeserialize:u(a,i),originalName:n(e.name),requestType:f(r,s),responseType:f(a,s)}}function f(e,t){const i=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:i.$type.toObject(i,l),fileDescriptorProtos:t}}function p(e,t,i,n){if(e instanceof s.Service)return function(e,t,i,n){const s={};for(const r of e.methodsArray)s[r.name]=d(r,t,i,n);return s}(e,t,i,n);if(e instanceof s.Type)return f(e,n);if(e instanceof s.Enum)return function(e,t){const i=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:i.$type.toObject(i,l),fileDescriptorProtos:t}}(e,n);throw new Error("Type mismatch in reflection object handling")}function m(e,t){const i={};e.resolveAll();const n=e.toDescriptor("proto3").file.map((e=>Buffer.from(r.FileDescriptorProto.encode(e).finish())));for(const[s,r]of c(e,""))i[s]=p(r,s,t,n);return i}function g(e,t){t=t||{};const i=s.Root.fromDescriptor(e);return i.resolveAll(),m(i,t)}t.load=function(e,t){return(0,a.loadProtosWithOptions)(e,t).then((e=>m(e,t)))},t.loadSync=function(e,t){return m((0,a.loadProtosWithOptionsSync)(e,t),t)},t.fromJSON=function(e,t){t=t||{};const i=s.Root.fromJSON(e);return i.resolveAll(),m(i,t)},t.loadFileDescriptorSetFromBuffer=function(e,t){return g(r.FileDescriptorSet.decode(e),t)},t.loadFileDescriptorSetFromObject=function(e,t){return g(r.FileDescriptorSet.fromObject(e),t)},(0,a.addCommonProtos)()},5969:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCommonProtos=t.loadProtosWithOptionsSync=t.loadProtosWithOptions=void 0;const n=i(7147),s=i(1017),r=i(3281);function a(e,t){const i=e.resolvePath;e.resolvePath=(e,r)=>{if(s.isAbsolute(r))return r;for(const e of t){const t=s.join(e,r);try{return n.accessSync(t,n.constants.R_OK),t}catch(e){continue}}return process.emitWarning(`${r} not found in any of the include paths ${t}`),i(e,r)}}t.loadProtosWithOptions=async function(e,t){const i=new r.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));a(i,t.includeDirs)}const n=await i.load(e,t);return n.resolveAll(),n},t.loadProtosWithOptionsSync=function(e,t){const i=new r.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))throw new Error("The includeDirs option must be an array");a(i,t.includeDirs)}const n=i.loadSync(e,t);return n.resolveAll(),n},t.addCommonProtos=function(){const e=i(4784),t=i(3571),n=i(3342),s=i(8783);r.common("api",e.nested.google.nested.protobuf.nested),r.common("descriptor",t.nested.google.nested.protobuf.nested),r.common("source_context",n.nested.google.nested.protobuf.nested),r.common("type",s.nested.google.nested.protobuf.nested)}},4537:e=>{"use strict";e.exports=function(e,t){for(var i=new Array(arguments.length-1),n=0,s=2,r=!0;s<arguments.length;)i[n++]=arguments[s++];return new Promise((function(s,a){i[n]=function(e){if(r)if(r=!1,e)a(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];s.apply(null,t)}};try{e.apply(t||null,i)}catch(e){r&&(r=!1,a(e))}}))}},7419:(e,t)=>{"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var n=new Array(64),s=new Array(123),r=0;r<64;)s[n[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;i.encode=function(e,t,i){for(var s,r=null,a=[],o=0,l=0;t<i;){var c=e[t++];switch(l){case 0:a[o++]=n[c>>2],s=(3&c)<<4,l=1;break;case 1:a[o++]=n[s|c>>4],s=(15&c)<<2,l=2;break;case 2:a[o++]=n[s|c>>6],a[o++]=n[63&c],l=0}o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,a)),o=0)}return l&&(a[o++]=n[s],a[o++]=61,1===l&&(a[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,a.slice(0,o))),r.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var a="invalid encoding";i.decode=function(e,t,i){for(var n,r=i,o=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&o>1)break;if(void 0===(c=s[c]))throw Error(a);switch(o){case 0:n=c,o=1;break;case 1:t[i++]=n<<2|(48&c)>>4,n=c,o=2;break;case 2:t[i++]=(15&n)<<4|(60&c)>>2,n=c,o=3;break;case 3:t[i++]=(3&n)<<6|c,o=0}}if(1===o)throw Error(a);return i-r},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5124:e=>{"use strict";function t(e,i){"string"==typeof e&&(i=e,e=void 0);var n=[];function s(e){if("string"!=typeof e){var i=r();if(t.verbose&&console.log("codegen: "+i),i="return "+i,e){for(var a=Object.keys(e),o=new Array(a.length+1),l=new Array(a.length),c=0;c<a.length;)o[c]=a[c],l[c]=e[a[c++]];return o[c]=i,Function.apply(null,o).apply(null,l)}return Function(i)()}for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h]=arguments[++h];if(h=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var i=u[h++];switch(t){case"d":case"f":return String(Number(i));case"i":return String(Math.floor(i));case"j":return JSON.stringify(i);case"s":return String(i)}return"%"})),h!==u.length)throw Error("parameter count mismatch");return n.push(e),s}function r(t){return"function "+(t||i||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return s.toString=r,s}e.exports=t,t.verbose=!1},9211:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},9054:(e,t,i)=>{"use strict";e.exports=r;var n=i(4537),s=i(7199)("fs");function r(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),i?!t.xhr&&s&&s.readFile?s.readFile(e,(function(n,s){return n&&"undefined"!=typeof XMLHttpRequest?r.xhr(e,t,i):n?i(n):i(null,t.binary?s:s.toString("utf8"))})):r.xhr(e,t,i):n(r,this,e,t)}r.xhr=function(e,t,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){if(0!==n.status&&200!==n.status)return i(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var s=0;s<n.responseText.length;++s)e.push(255&n.responseText.charCodeAt(s))}return i(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return i(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},945:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function s(e,n,s){t[0]=e,n[s]=i[0],n[s+1]=i[1],n[s+2]=i[2],n[s+3]=i[3]}function r(e,n,s){t[0]=e,n[s]=i[3],n[s+1]=i[2],n[s+2]=i[1],n[s+3]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function o(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?s:r,e.writeFloatBE=n?r:s,e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():function(){function t(e,t,i,n){var s=t<0?1:0;if(s&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((s<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((s<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var r=Math.floor(Math.log(t)/Math.LN2);e((s<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,i,n)}}function a(e,t,i){var n=e(t,i),s=2*(n>>31)+1,r=n>>>23&255,a=8388607&n;return 255===r?a?NaN:s*(1/0):0===r?1401298464324817e-60*s*a:s*Math.pow(2,r-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,n),e.readFloatLE=a.bind(null,s),e.readFloatBE=a.bind(null,r)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function s(e,n,s){t[0]=e,n[s]=i[0],n[s+1]=i[1],n[s+2]=i[2],n[s+3]=i[3],n[s+4]=i[4],n[s+5]=i[5],n[s+6]=i[6],n[s+7]=i[7]}function r(e,n,s){t[0]=e,n[s]=i[7],n[s+1]=i[6],n[s+2]=i[5],n[s+3]=i[4],n[s+4]=i[3],n[s+5]=i[2],n[s+6]=i[1],n[s+7]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function o(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?s:r,e.writeDoubleBE=n?r:s,e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():function(){function t(e,t,i,n,s,r){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,s,r+t),e(1/n>0?0:2147483648,s,r+i);else if(isNaN(n))e(0,s,r+t),e(2146959360,s,r+i);else if(n>17976931348623157e292)e(0,s,r+t),e((a<<31|2146435072)>>>0,s,r+i);else{var o;if(n<22250738585072014e-324)e((o=n/5e-324)>>>0,s,r+t),e((a<<31|o/4294967296)>>>0,s,r+i);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(o=n*Math.pow(2,-l))>>>0,s,r+t),e((a<<31|l+1023<<20|1048576*o&1048575)>>>0,s,r+i)}}}function a(e,t,i,n,s){var r=e(n,s+t),a=e(n,s+i),o=2*(a>>31)+1,l=a>>>20&2047,c=4294967296*(1048575&a)+r;return 2047===l?c?NaN:o*(1/0):0===l?5e-324*o*c:o*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=a.bind(null,s,0,4),e.readDoubleBE=a.bind(null,r,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function n(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function r(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},2860:(e,t)=>{"use strict";var i=t,n=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},s=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),i=n(e),s="";i&&(s=t.shift()+"/");for(var r=0;r<t.length;)".."===t[r]?r>0&&".."!==t[r-1]?t.splice(--r,2):i?t.splice(r,1):++r:"."===t[r]?t.splice(r,1):++r;return s+t.join("/")};i.resolve=function(e,t,i){return i||(t=s(t)),n(t)?t:(i||(e=s(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?s(e+"/"+t):t)}},6662:e=>{"use strict";e.exports=function(e,t,i){var n=i||8192,s=n>>>1,r=null,a=n;return function(i){if(i<1||i>s)return e(i);a+i>n&&(r=e(n),a=0);var o=t.call(r,a,a+=i);return 7&a&&(a=1+(7|a)),o}}},4997:(e,t)=>{"use strict";var i=t;i.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var n,s=null,r=[],a=0;t<i;)(n=e[t++])<128?r[a++]=n:n>191&&n<224?r[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[a++]=55296+(n>>10),r[a++]=56320+(1023&n)):r[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,r)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,r.slice(0,a))),s.join("")):String.fromCharCode.apply(String,r.slice(0,a))},i.write=function(e,t,i){for(var n,s,r=i,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(s=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&s),++a,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-r}},645:(e,t)=>{t.i=function(e,t,i,n,s){var r,a,o=8*s-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=i?s-1:0,d=i?-1:1,f=e[t+h];for(h+=d,r=f&(1<<-u)-1,f>>=-u,u+=o;u>0;r=256*r+e[t+h],h+=d,u-=8);for(a=r&(1<<-u)-1,r>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===r)r=1-c;else{if(r===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),r-=c}return(f?-1:1)*a*Math.pow(2,r-n)},t.c=function(e,t,i,n,s,r){var a,o,l,c=8*r-s-1,u=(1<<c)-1,h=u>>1,d=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:r-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(t*l-1)*Math.pow(2,s),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,s),a=0));s>=8;e[i+f]=255&o,f+=p,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[i+f]=255&a,f+=p,a/=256,c-=8);e[i+f-p]|=128*m}},6884:e=>{var t,i=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,n=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s="\\ud800-\\udfff",r="\\u0300-\\u036f\\ufe20-\\ufe23",a="\\u20d0-\\u20f0",o="\\u2700-\\u27bf",l="a-z\\xdf-\\xf6\\xf8-\\xff",c="A-Z\\xc0-\\xd6\\xd8-\\xde",u="\\ufe0e\\ufe0f",h="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",d="["+s+"]",f="["+h+"]",p="["+r+a+"]",m="\\d+",g="["+o+"]",v="["+l+"]",y="[^"+s+h+m+o+l+c+"]",S="\\ud83c[\\udffb-\\udfff]",b="[^"+s+"]",C="(?:\\ud83c[\\udde6-\\uddff]){2}",T="[\\ud800-\\udbff][\\udc00-\\udfff]",E="["+c+"]",w="\\u200d",_="(?:"+v+"|"+y+")",k="(?:"+E+"|"+y+")",R="(?:['](?:d|ll|m|re|s|t|ve))?",x="(?:['](?:D|LL|M|RE|S|T|VE))?",A="(?:"+p+"|"+S+")?",N="["+u+"]?",O=N+A+"(?:"+w+"(?:"+[b,C,T].join("|")+")"+N+A+")*",M="(?:"+[g,C,T].join("|")+")"+O,P="(?:"+[b+p+"?",p,C,T,d].join("|")+")",I=RegExp("[']","g"),L=RegExp(p,"g"),D=RegExp(S+"(?="+S+")|"+P+O,"g"),j=RegExp([E+"?"+v+"+"+R+"(?="+[f,E,"$"].join("|")+")",k+"+"+x+"(?="+[f,E+_,"$"].join("|")+")",E+"?"+_+"+"+R,E+"+"+x,m,M].join("|"),"g"),B=RegExp("["+w+s+r+a+u+"]"),F=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,z="object"==typeof global&&global&&global.Object===Object&&global,U="object"==typeof self&&self&&self.Object===Object&&self,H=z||U||Function("return this")(),q=(t={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},function(e){return null==t?void 0:t[e]});function G(e){return B.test(e)}var W=Object.prototype.toString,$=H.Symbol,V=$?$.prototype:void 0,Y=V?V.toString:void 0;function J(e){return null==e?"":function(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==W.call(e)}(e))return Y?Y.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}var K,X=(K=function(e,t,i){return t=t.toLowerCase(),e+(i?Q(J(t).toLowerCase()):t)},function(e){return function(e,t,i,n){for(var s=-1,r=e?e.length:0;++s<r;)i=t(i,e[s],s,e);return i}(function(e,t,n){return e=J(e),void 0===t?function(e){return F.test(e)}(e)?function(e){return e.match(j)||[]}(e):function(e){return e.match(i)||[]}(e):e.match(t)||[]}(function(e){return(e=J(e))&&e.replace(n,q).replace(L,"")}(e).replace(I,"")),K,"")}),Q=("toUpperCase",function(e){var t,i,n,s,r=G(e=J(e))?function(e){return G(e)?function(e){return e.match(D)||[]}(e):function(e){return e.split("")}(e)}(e):void 0,a=r?r[0]:e.charAt(0),o=r?(t=r,i=1,s=t.length,n=void 0===n?s:n,!i&&n>=s?t:function(e,t,i){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(i=i>s?s:i)<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;for(var r=Array(s);++n<s;)r[n]=e[n+t];return r}(t,i,n)).join(""):e.slice(1);return a.toUpperCase()+o});e.exports=X},3720:e=>{e.exports=i;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function n(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=n;var s={},r={};function a(e,t){var i,n,a;return t?(a=0<=(e>>>=0)&&e<256)&&(n=r[e])?n:(i=l(e,(0|e)<0?-1:0,!0),a&&(r[e]=i),i):(a=-128<=(e|=0)&&e<128)&&(n=s[e])?n:(i=l(e,e<0?-1:0,!1),a&&(s[e]=i),i)}function o(e,t){if(isNaN(e))return t?v:g;if(t){if(e<0)return v;if(e>=f)return T}else{if(e<=-p)return E;if(e+1>=p)return C}return e<0?o(-e,t).neg():l(e%d|0,e/d|0,t)}function l(e,t,n){return new i(e,t,n)}i.fromInt=a,i.fromNumber=o,i.fromBits=l;var c=Math.pow;function u(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(i=t,t=!1):t=!!t,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(e.substring(1),t,i).neg();for(var s=o(c(i,8)),r=g,a=0;a<e.length;a+=8){var l=Math.min(8,e.length-a),h=parseInt(e.substring(a,a+l),i);if(l<8){var d=o(c(i,l));r=r.mul(d).add(o(h))}else r=(r=r.mul(s)).add(o(h))}return r.unsigned=t,r}function h(e,t){return"number"==typeof e?o(e,t):"string"==typeof e?u(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=u,i.fromValue=h;var d=4294967296,f=d*d,p=f/2,m=a(1<<24),g=a(0);i.ZERO=g;var v=a(0,!0);i.UZERO=v;var y=a(1);i.ONE=y;var S=a(1,!0);i.UONE=S;var b=a(-1);i.NEG_ONE=b;var C=l(-1,2147483647,!1);i.MAX_VALUE=C;var T=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=T;var E=l(0,-2147483648,!1);i.MIN_VALUE=E;var w=i.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},w.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var t=o(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=o(c(e,6),this.unsigned),r=this,a="";;){var l=r.div(s),u=(r.sub(l.mul(s)).toInt()>>>0).toString(e);if((r=l).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},w.eq=w.equals,w.notEquals=function(e){return!this.eq(e)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(e){return this.comp(e)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(e){return this.comp(e)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(e){return this.comp(e)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(e){return this.comp(e)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(y)},w.neg=w.negate,w.add=function(e){n(e)||(e=h(e));var t=this.high>>>16,i=65535&this.high,s=this.low>>>16,r=65535&this.low,a=e.high>>>16,o=65535&e.high,c=e.low>>>16,u=0,d=0,f=0,p=0;return f+=(p+=r+(65535&e.low))>>>16,d+=(f+=s+c)>>>16,u+=(d+=i+o)>>>16,u+=t+a,l((f&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},w.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},w.sub=w.subtract,w.multiply=function(e){if(this.isZero())return g;if(n(e)||(e=h(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(E))return e.isOdd()?E:g;if(e.eq(E))return this.isOdd()?E:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return o(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,s=65535&this.high,r=this.low>>>16,a=65535&this.low,c=e.high>>>16,u=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,v=0,y=0,S=0;return y+=(S+=a*f)>>>16,v+=(y+=r*f)>>>16,y&=65535,v+=(y+=a*d)>>>16,p+=(v+=s*f)>>>16,v&=65535,p+=(v+=r*d)>>>16,v&=65535,p+=(v+=a*u)>>>16,p+=i*f+s*d+r*u+a*c,l((y&=65535)<<16|(S&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(e){if(n(e)||(e=h(e)),e.isZero())throw Error("division by zero");var i,s,r;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return S;r=v}else{if(this.eq(E))return e.eq(y)||e.eq(b)?E:e.eq(E)?y:(i=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:b:(s=this.sub(e.mul(i)),r=i.add(s.div(e)));if(e.eq(E))return this.unsigned?v:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=g}for(s=this;s.gte(e);){i=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),u=a<=48?1:c(2,a-48),d=o(i),f=d.mul(e);f.isNegative()||f.gt(s);)f=(d=o(i-=u,this.unsigned)).mul(e);d.isZero()&&(d=y),r=r.add(d),s=s.sub(f)}return r},w.div=w.divide,w.modulo=function(e){return n(e)||(e=h(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return l(~this.low,~this.high,this.unsigned)},w.and=function(e){return n(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},w.or=function(e){return n(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},w.xor=function(e){return n(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},w.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},w.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},w.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,n){return n?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},3961:(e,t,i)=>{"use strict";var n=i(3281);e.exports=t=n.descriptor=n.Root.fromJSON(i(3571)).lookup(".google.protobuf");var s=n.Namespace,r=n.Root,a=n.Enum,o=n.Type,l=n.Field,c=n.MapField,u=n.OneOf,h=n.Service,d=n.Method;function f(e,i,n){var c=t.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});n&&(c.syntax=n),e instanceof r||(c.package=e.fullName.substring(1));for(var u,d=0;d<e.nestedArray.length;++d)(u=e._nestedArray[d])instanceof o?c.messageType.push(u.toDescriptor(n)):u instanceof a?c.enumType.push(u.toDescriptor()):u instanceof l?c.extension.push(u.toDescriptor(n)):u instanceof h?c.service.push(u.toDescriptor()):u instanceof s&&f(u,i,n);c.options=T(e.options,t.FileOptions),c.messageType.length+c.enumType.length+c.extension.length+c.service.length&&i.push(c)}r.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.FileDescriptorSet.decode(e));var i=new r;if(e.file)for(var n,s,c,u=0;u<e.file.length;++u){if(s=i,(n=e.file[u]).package&&n.package.length&&(s=i.define(n.package)),n.name&&n.name.length&&i.files.push(s.filename=n.name),n.messageType)for(c=0;c<n.messageType.length;++c)s.add(o.fromDescriptor(n.messageType[c],n.syntax));if(n.enumType)for(c=0;c<n.enumType.length;++c)s.add(a.fromDescriptor(n.enumType[c]));if(n.extension)for(c=0;c<n.extension.length;++c)s.add(l.fromDescriptor(n.extension[c]));if(n.service)for(c=0;c<n.service.length;++c)s.add(h.fromDescriptor(n.service[c]));var d=C(n.options,t.FileOptions);if(d){var f=Object.keys(d);for(c=0;c<f.length;++c)s.setOption(f[c],d[f[c]])}}return i},r.prototype.toDescriptor=function(e){var i=t.FileDescriptorSet.create();return f(this,i.file,e),i};var p=0;o.fromDescriptor=function(e,i){"number"==typeof e.length&&(e=t.DescriptorProto.decode(e));var n,s=new o(e.name.length?e.name:"Type"+p++,C(e.options,t.MessageOptions));if(e.oneofDecl)for(n=0;n<e.oneofDecl.length;++n)s.add(u.fromDescriptor(e.oneofDecl[n]));if(e.field)for(n=0;n<e.field.length;++n){var r=l.fromDescriptor(e.field[n],i);s.add(r),e.field[n].hasOwnProperty("oneofIndex")&&s.oneofsArray[e.field[n].oneofIndex].add(r)}if(e.extension)for(n=0;n<e.extension.length;++n)s.add(l.fromDescriptor(e.extension[n],i));if(e.nestedType)for(n=0;n<e.nestedType.length;++n)s.add(o.fromDescriptor(e.nestedType[n],i)),e.nestedType[n].options&&e.nestedType[n].options.mapEntry&&s.setOption("map_entry",!0);if(e.enumType)for(n=0;n<e.enumType.length;++n)s.add(a.fromDescriptor(e.enumType[n]));if(e.extensionRange&&e.extensionRange.length)for(s.extensions=[],n=0;n<e.extensionRange.length;++n)s.extensions.push([e.extensionRange[n].start,e.extensionRange[n].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(s.reserved=[],e.reservedRange)for(n=0;n<e.reservedRange.length;++n)s.reserved.push([e.reservedRange[n].start,e.reservedRange[n].end]);if(e.reservedName)for(n=0;n<e.reservedName.length;++n)s.reserved.push(e.reservedName[n])}return s},o.prototype.toDescriptor=function(e){var i,n=t.DescriptorProto.create({name:this.name});for(i=0;i<this.fieldsArray.length;++i){var s;if(n.field.push(s=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof c){var r=b(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType),u=b(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType),h=11===u||14===u?this._fieldsArray[i].resolvedType&&E(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;n.nestedType.push(t.DescriptorProto.create({name:s.typeName,field:[t.FieldDescriptorProto.create({name:"key",number:1,label:1,type:r}),t.FieldDescriptorProto.create({name:"value",number:2,label:1,type:u,typeName:h})],options:t.MessageOptions.create({mapEntry:!0})}))}}for(i=0;i<this.oneofsArray.length;++i)n.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof l?n.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof o?n.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof a&&n.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)n.extensionRange.push(t.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)"string"==typeof this.reserved[i]?n.reservedName.push(this.reserved[i]):n.reservedRange.push(t.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return n.options=T(this.options,t.MessageOptions),n};var m=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(e,i){if("number"==typeof e.length&&(e=t.DescriptorProto.decode(e)),"number"!=typeof e.number)throw Error("missing field id");var n,s;switch(n=e.typeName&&e.typeName.length?e.typeName:function(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}(e.type),e.label){case 1:s=void 0;break;case 2:s="required";break;case 3:s="repeated";break;default:throw Error("illegal label: "+e.label)}var r=e.extendee;void 0!==e.extendee&&(r=r.length?r:void 0);var a=new l(e.name.length?e.name:"field"+e.number,e.number,n,s,r);if(a.options=C(e.options,t.FieldOptions),e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=!0;break;case"false":case"FALSE":o=!1;break;default:m.exec(o)&&(o=parseInt(o))}a.setOption("default",o)}return function(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}(e.type)&&("proto3"===i?e.options&&!e.options.packed&&a.setOption("packed",!1):e.options&&e.options.packed||a.setOption("packed",!1)),a},l.prototype.toDescriptor=function(e){var i=t.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)i.type=11,i.typeName=n.util.ucFirst(this.name),i.label=3;else{switch(i.type=b(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:i.typeName=this.resolvedType?E(this.parent,this.resolvedType):this.type}switch(this.rule){case"repeated":i.label=3;break;case"required":i.label=2;break;default:i.label=1}}if(i.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(i.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(i.options=T(this.options,t.FieldOptions),null!=this.options.default&&(i.defaultValue=String(this.options.default))),"proto3"===e?this.packed||((i.options||(i.options=t.FieldOptions.create())).packed=!1):this.packed&&((i.options||(i.options=t.FieldOptions.create())).packed=!0),i};var g=0;a.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.EnumDescriptorProto.decode(e));var i={};if(e.value)for(var n=0;n<e.value.length;++n){var s=e.value[n].name,r=e.value[n].number||0;i[s&&s.length?s:"NAME"+r]=r}return new a(e.name&&e.name.length?e.name:"Enum"+g++,i,C(e.options,t.EnumOptions))},a.prototype.toDescriptor=function(){for(var e=[],i=0,n=Object.keys(this.values);i<n.length;++i)e.push(t.EnumValueDescriptorProto.create({name:n[i],number:this.values[n[i]]}));return t.EnumDescriptorProto.create({name:this.name,value:e,options:T(this.options,t.EnumOptions)})};var v=0;u.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.OneofDescriptorProto.decode(e)),new u(e.name&&e.name.length?e.name:"oneof"+v++)},u.prototype.toDescriptor=function(){return t.OneofDescriptorProto.create({name:this.name})};var y=0;h.fromDescriptor=function(e){"number"==typeof e.length&&(e=t.ServiceDescriptorProto.decode(e));var i=new h(e.name&&e.name.length?e.name:"Service"+y++,C(e.options,t.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)i.add(d.fromDescriptor(e.method[n]));return i},h.prototype.toDescriptor=function(){for(var e=[],i=0;i<this.methodsArray.length;++i)e.push(this._methodsArray[i].toDescriptor());return t.ServiceDescriptorProto.create({name:this.name,method:e,options:T(this.options,t.ServiceOptions)})};var S=0;function b(e,t){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return t.group?10:11;throw Error("illegal type: "+e)}function C(e,t){if(e){for(var i,s,r,o,l=[],c=0;c<t.fieldsArray.length;++c)"uninterpretedOption"!==(s=(i=t._fieldsArray[c]).name)&&e.hasOwnProperty(s)&&(r=e[s],i.resolvedType instanceof a&&"number"==typeof r&&void 0!==i.resolvedType.valuesById[r]&&(r=i.resolvedType.valuesById[r]),l.push((o=s).substring(0,1)+o.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,(function(e,t){return"_"+t.toLowerCase()})),r));return l.length?n.util.toObject(l):void 0}}function T(e,t){if(e){for(var i,s,r=[],a=0,o=Object.keys(e);a<o.length;++a)if(s=e[i=o[a]],"default"!==i){var l=t.fields[i];(l||(l=t.fields[i=n.util.camelCase(i)]))&&r.push(i,s)}return r.length?t.fromObject(n.util.toObject(r)):void 0}}function E(e,t){var i=e.fullName.split("."),n=t.fullName.split("."),a=0,o=0,l=n.length-1;if(!(e instanceof r)&&t instanceof s)for(;a<i.length&&o<l&&i[a]===n[o];){var c=t.lookup(i[a++],!0);if(null!==c&&c!==t)break;++o}else for(;a<i.length&&o<l&&i[a]===n[o];++a,++o);return n.slice(o).join(".")}d.fromDescriptor=function(e){return"number"==typeof e.length&&(e=t.MethodDescriptorProto.decode(e)),new d(e.name&&e.name.length?e.name:"Method"+S++,"rpc",e.inputType,e.outputType,Boolean(e.clientStreaming),Boolean(e.serverStreaming),C(e.options,t.MethodOptions))},d.prototype.toDescriptor=function(){return t.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:T(this.options,t.MethodOptions)})}},3281:(e,t,i)=>{"use strict";e.exports=i(9050)},2967:e=>{"use strict";e.exports=n;var t,i=/\/|\./;function n(e,t){i.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),n[e]=t}n("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),n("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),n("timestamp",{Timestamp:t}),n("empty",{Empty:{fields:{}}}),n("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),n("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),n("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),n.get=function(e){return n[e]||null}},3996:(e,t,i)=>{"use strict";var n=t,s=i(7025),r=i(9935);function a(e,t,i,n){var r=!1;if(t.resolvedType)if(t.resolvedType instanceof s){e("switch(d%s){",n);for(var a=t.resolvedType.values,o=Object.keys(a),l=0;l<o.length;++l)a[o[l]]!==t.typeDefault||r||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),t.repeated||e("break"),r=!0),e("case%j:",o[l])("case %i:",a[o[l]])("m%s=%j",n,a[o[l]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,i,n);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function o(e,t,i,n){if(t.resolvedType)t.resolvedType instanceof s?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,i,n,n,i,n,n):e("d%s=types[%i].toObject(m%s,o)",n,i,n);else{var r=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,r?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}n.fromObject=function(e){var t=e.fieldsArray,i=r.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var n=0;n<t.length;++n){var o=t[n].resolve(),l=r.safeProp(o.name);o.map?(i("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",o.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),a(i,o,n,l+"[ks[i]]")("}")("}")):o.repeated?(i("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",o.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),a(i,o,n,l+"[i]")("}")("}")):(o.resolvedType instanceof s||i("if(d%s!=null){",l),a(i,o,n,l),o.resolvedType instanceof s||i("}"))}return i("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(r.compareFieldsById);if(!t.length)return r.codegen()("return {}");for(var i=r.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],a=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?n:t[c].map?a:l).push(t[c]);if(n.length){for(i("if(o.arrays||o.defaults){"),c=0;c<n.length;++c)i("d%s=[]",r.safeProp(n[c].name));i("}")}if(a.length){for(i("if(o.objects||o.defaults){"),c=0;c<a.length;++c)i("d%s={}",r.safeProp(a[c].name));i("}")}if(l.length){for(i("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],h=r.safeProp(u.name);if(u.resolvedType instanceof s)i("d%s=o.enums===String?%j:%j",h,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",h)("}else")("d%s=o.longs===String?%j:%i",h,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var d="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",h,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",h,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",h,h)("}")}else i("d%s=%j",h,u.typeDefault)}i("}")}var f=!1;for(c=0;c<t.length;++c){u=t[c];var p=e._fieldsArray.indexOf(u);h=r.safeProp(u.name),u.map?(f||(f=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",h,h)("d%s={}",h)("for(var j=0;j<ks2.length;++j){"),o(i,u,p,h+"[ks2[j]]")("}")):u.repeated?(i("if(m%s&&m%s.length){",h,h)("d%s=[]",h)("for(var j=0;j<m%s.length;++j){",h),o(i,u,p,h+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",h,u.name),o(i,u,p,h),u.partOf&&i("if(o.oneofs)")("d%s=%j",r.safeProp(u.partOf.name),u.name)),i("}")}return i("return d")}},5305:(e,t,i)=>{"use strict";e.exports=function(e){var t=r.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var i=0;i<e.fieldsArray.length;++i){var o=e._fieldsArray[i].resolve(),l=o.resolvedType instanceof n?"int32":o.type,c="m"+r.safeProp(o.name);t("case %i: {",o.id),o.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==s.defaults[o.keyType]?t("k=%j",s.defaults[o.keyType]):t("k=null"),void 0!==s.defaults[l]?t("value=%j",s.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",o.keyType)("case 2:"),void 0===s.basic[l]?t("value=types[%i].decode(r,r.uint32())",i):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==s.long[o.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',c):t("%s[k]=value",c)):o.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==s.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===s.basic[l]?t(o.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",c,i):t("%s.push(r.%s())",c,l)):void 0===s.basic[l]?t(o.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",c,i):t("%s=r.%s()",c,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<e._fieldsArray.length;++i){var u=e._fieldsArray[i];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")};var n=i(7025),s=i(7063),r=i(9935);function a(e){return"missing required '"+e.name+"'"}},4928:(e,t,i)=>{"use strict";e.exports=function(e){for(var t,i=r.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),o=e.fieldsArray.slice().sort(r.compareFieldsById),l=0;l<o.length;++l){var c=o[l].resolve(),u=e._fieldsArray.indexOf(c),h=c.resolvedType instanceof n?"int32":c.type,d=s.basic[h];t="m"+r.safeProp(c.name),c.map?(i("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|s.mapKey[c.keyType],c.keyType),void 0===d?i("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):i(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,h,t),i("}")("}")):c.repeated?(i("if(%s!=null&&%s.length){",t,t),c.packed&&void 0!==s.packed[h]?i("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",h,t)("w.ldelim()"):(i("for(var i=0;i<%s.length;++i)",t),void 0===d?a(i,c,u,t+"[i]"):i("w.uint32(%i).%s(%s[i])",(c.id<<3|d)>>>0,h,t)),i("}")):(c.optional&&i("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,c.name),void 0===d?a(i,c,u,t):i("w.uint32(%i).%s(%s)",(c.id<<3|d)>>>0,h,t))}return i("return w")};var n=i(7025),s=i(7063),r=i(9935);function a(e,t,i,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",i,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",i,n,(t.id<<3|2)>>>0)}},7025:(e,t,i)=>{"use strict";e.exports=a;var n=i(3243);((a.prototype=Object.create(n.prototype)).constructor=a).className="Enum";var s=i(9313),r=i(9935);function a(e,t,i,s,r,a){if(n.call(this,e,i),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=s,this.comments=r||{},this.valuesOptions=a,this.reserved=void 0,t)for(var o=Object.keys(t),l=0;l<o.length;++l)"number"==typeof t[o[l]]&&(this.valuesById[this.values[o[l]]=t[o[l]]]=o[l])}a.fromJSON=function(e,t){var i=new a(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,i,n){if(!r.isString(e))throw TypeError("name must be a string");if(!r.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return n&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=n||null),this.comments[e]=i||null,this},a.prototype.remove=function(e){if(!r.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},a.prototype.isReservedId=function(e){return s.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return s.isReservedName(this.reserved,e)}},3548:(e,t,i)=>{"use strict";e.exports=c;var n=i(3243);((c.prototype=Object.create(n.prototype)).constructor=c).className="Field";var s,r=i(7025),a=i(7063),o=i(9935),l=/^required|optional|repeated$/;function c(e,t,i,s,r,c,u){if(o.isObject(s)?(u=r,c=s,s=r=void 0):o.isObject(r)&&(u=c,c=r,r=void 0),n.call(this,e,c),!o.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!o.isString(i))throw TypeError("type must be a string");if(void 0!==s&&!l.test(s=s.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==r&&!o.isString(r))throw TypeError("extend must be a string");"proto3_optional"===s&&(s="optional"),this.rule=s&&"optional"!==s?s:void 0,this.type=i,this.id=t,this.extend=r||void 0,this.required="required"===s,this.optional=!this.required,this.repeated="repeated"===s,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!o.Long&&void 0!==a.long[i],this.bytes="bytes"===i,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,i){return"packed"===e&&(this._packed=null),n.prototype.setOption.call(this,e,t,i)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof s?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof r&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof r)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=o.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;o.base64.test(this.typeDefault)?o.base64.decode(this.typeDefault,e=o.newBuffer(o.base64.length(this.typeDefault)),0):o.utf8.write(this.typeDefault,e=o.newBuffer(o.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=o.emptyObject:this.repeated?this.defaultValue=o.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof s&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},c.d=function(e,t,i,n){return"function"==typeof t?t=o.decorateType(t).name:t&&"object"==typeof t&&(t=o.decorateEnum(t).name),function(s,r){o.decorateType(s.constructor).add(new c(r,e,t,i,{default:n}))}},c._configure=function(e){s=e}},8836:(e,t,i)=>{"use strict";var n=e.exports=i(9482);n.build="light",n.load=function(e,t,i){return"function"==typeof t?(i=t,t=new n.Root):t||(t=new n.Root),t.load(e,i)},n.loadSync=function(e,t){return t||(t=new n.Root),t.loadSync(e)},n.encoder=i(4928),n.decoder=i(5305),n.verifier=i(4497),n.converter=i(3996),n.ReflectionObject=i(3243),n.Namespace=i(9313),n.Root=i(9424),n.Enum=i(7025),n.Type=i(7645),n.Field=i(3548),n.OneOf=i(7598),n.MapField=i(6039),n.Service=i(7513),n.Method=i(4429),n.Message=i(8368),n.wrappers=i(1667),n.types=i(7063),n.util=i(9935),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)},9482:(e,t,i)=>{"use strict";var n=t;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=i(1173),n.BufferWriter=i(3155),n.Reader=i(1408),n.BufferReader=i(593),n.util=i(9693),n.rpc=i(5994),n.roots=i(5054),n.configure=s,s()},9050:(e,t,i)=>{"use strict";var n=e.exports=i(8836);n.build="full",n.tokenize=i(626),n.parse=i(2228),n.common=i(2967),n.Root._configure(n.Type,n.parse,n.common)},6039:(e,t,i)=>{"use strict";e.exports=a;var n=i(3548);((a.prototype=Object.create(n.prototype)).constructor=a).className="MapField";var s=i(7063),r=i(9935);function a(e,t,i,s,a,o){if(n.call(this,e,t,s,void 0,void 0,a,o),!r.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===s.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},a.d=function(e,t,i){return"function"==typeof i?i=r.decorateType(i).name:i&&"object"==typeof i&&(i=r.decorateEnum(i).name),function(n,s){r.decorateType(n.constructor).add(new a(s,e,t,i))}}},8368:(e,t,i)=>{"use strict";e.exports=s;var n=i(9693);function s(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)this[t[i]]=e[t[i]]}s.create=function(e){return this.$type.create(e)},s.encode=function(e,t){return this.$type.encode(e,t)},s.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},s.decode=function(e){return this.$type.decode(e)},s.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},s.verify=function(e){return this.$type.verify(e)},s.fromObject=function(e){return this.$type.fromObject(e)},s.toObject=function(e,t){return this.$type.toObject(e,t)},s.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},4429:(e,t,i)=>{"use strict";e.exports=r;var n=i(3243);((r.prototype=Object.create(n.prototype)).constructor=r).className="Method";var s=i(9935);function r(e,t,i,r,a,o,l,c,u){if(s.isObject(a)?(l=a,a=o=void 0):s.isObject(o)&&(l=o,o=void 0),void 0!==t&&!s.isString(t))throw TypeError("type must be a string");if(!s.isString(i))throw TypeError("requestType must be a string");if(!s.isString(r))throw TypeError("responseType must be a string");n.call(this,e,l),this.type=t||"rpc",this.requestType=i,this.requestStream=!!a||void 0,this.responseType=r,this.responseStream=!!o||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c,this.parsedOptions=u}r.fromJSON=function(e,t){return new r(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},r.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},r.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}},9313:(e,t,i)=>{"use strict";e.exports=h;var n=i(3243);((h.prototype=Object.create(n.prototype)).constructor=h).className="Namespace";var s,r,a,o=i(3548),l=i(9935),c=i(7598);function u(e,t){if(e&&e.length){for(var i={},n=0;n<e.length;++n)i[e[n].name]=e[n].toJSON(t);return i}}function h(e,t){n.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}h.fromJSON=function(e,t){return new h(e,t.options).addJSON(t.nested)},h.arrayToJSON=u,h.isReservedId=function(e,t){if(e)for(var i=0;i<e.length;++i)if("string"!=typeof e[i]&&e[i][0]<=t&&e[i][1]>t)return!0;return!1},h.isReservedName=function(e,t){if(e)for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1},Object.defineProperty(h.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),h.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},h.prototype.addJSON=function(e){if(e)for(var t,i=Object.keys(e),n=0;n<i.length;++n)t=e[i[n]],this.add((void 0!==t.fields?s.fromJSON:void 0!==t.values?a.fromJSON:void 0!==t.methods?r.fromJSON:void 0!==t.id?o.fromJSON:h.fromJSON)(i[n],t));return this},h.prototype.get=function(e){return this.nested&&this.nested[e]||null},h.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},h.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof s||e instanceof c||e instanceof a||e instanceof r||e instanceof h))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof h&&e instanceof h)||t instanceof s||t instanceof r)throw Error("duplicate name '"+e.name+"' in "+this);for(var i=t.nestedArray,n=0;n<i.length;++n)e.add(i[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},h.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},h.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var i=this;e.length>0;){var n=e.shift();if(i.nested&&i.nested[n]){if(!((i=i.nested[n])instanceof h))throw Error("path conflicts with non-namespace objects")}else i.add(i=new h(n))}return t&&i.addJSON(t),i},h.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof h?e[t++].resolveAll():e[t++].resolve();return this.resolve()},h.prototype.lookup=function(e,t,i){if("boolean"==typeof t?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof h&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof h&&(n=this._nestedArray[s].lookup(e,t,!0)))return n;return null===this.parent||i?null:this.parent.lookup(e,t)},h.prototype.lookupType=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such type: "+e);return t},h.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},h.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[s,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},h.prototype.lookupService=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},h._configure=function(e,t,i){s=e,r=t,a=i}},3243:(e,t,i)=>{"use strict";e.exports=r,r.className="ReflectionObject";var n,s=i(9935);function r(e,t){if(!s.isString(e))throw TypeError("name must be a string");if(t&&!s.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(r.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),r.prototype.toJSON=function(){throw Error()},r.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},r.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},r.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},r.prototype.getOption=function(e){if(this.options)return this.options[e]},r.prototype.setOption=function(e,t,i){return i&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},r.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(i){var r=n.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(r){var a=r[e];s.setProperty(a,i,t)}else(r={})[e]=s.setProperty({},i,t),n.push(r)}else{var o={};o[e]=t,n.push(o)}return this},r.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),n=0;n<i.length;++n)this.setOption(i[n],e[i[n]],t);return this},r.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},r._configure=function(e){n=e}},7598:(e,t,i)=>{"use strict";e.exports=a;var n=i(3243);((a.prototype=Object.create(n.prototype)).constructor=a).className="OneOf";var s=i(3548),r=i(9935);function a(e,t,i,s){if(Array.isArray(t)||(i=t,t=void 0),n.call(this,e,i),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=s}function o(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof s))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,o(this),this},a.prototype.remove=function(e){if(!(e instanceof s))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var i=e.get(this.oneof[t]);i&&!i.partOf&&(i.partOf=this,this.fieldsArray.push(i))}o(this)},a.prototype.onRemove=function(e){for(var t,i=0;i<this.fieldsArray.length;++i)(t=this.fieldsArray[i]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,i){r.decorateType(t.constructor).add(new a(i,e)),Object.defineProperty(t,i,{get:r.oneOfGetter(e),set:r.oneOfSetter(e)})}}},2228:(e,t,i)=>{"use strict";e.exports=w,w.filename=null,w.defaults={keepCase:!1};var n=i(626),s=i(9424),r=i(7645),a=i(3548),o=i(6039),l=i(7598),c=i(7025),u=i(7513),h=i(4429),d=i(7063),f=i(9935),p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,y=/^0[0-7]+$/,S=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,C=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,E=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function w(e,t,i){t instanceof s||(i=t,t=new s),i||(i=w.defaults);var _,k,R,x,A,N=i.preferTrailingComment||!1,O=n(e,i.alternateCommentMode||!1),M=O.next,P=O.push,I=O.peek,L=O.skip,D=O.cmnt,j=!0,B=!1,F=t,z=i.keepCase?function(e){return e}:f.camelCase;function U(e,t,i){var n=w.filename;return i||(w.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+O.line+")")}function H(){var e,t=[];do{if('"'!==(e=M())&&"'"!==e)throw U(e);t.push(M()),L(e),e=I()}while('"'===e||"'"===e);return t.join("")}function q(e){var t=M();switch(t){case"'":case'"':return P(t),H();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var i=1;switch("-"===e.charAt(0)&&(i=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return i*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return i*parseInt(e,10);if(g.test(e))return i*parseInt(e,16);if(y.test(e))return i*parseInt(e,8);if(b.test(e))return i*parseFloat(e);throw U(e,"number",!0)}(t)}catch(i){if(e&&T.test(t))return t;throw U(t,"value")}}function G(e,t){var i,n;do{!t||'"'!==(i=I())&&"'"!==i?e.push([n=W(M()),L("to",!0)?W(M()):n]):e.push(H())}while(L(",",!0));L(";")}function W(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw U(e,"id");if(m.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(S.test(e))return parseInt(e,8);throw U(e,"id")}function $(){if(void 0!==_)throw U("package");if(_=M(),!T.test(_))throw U(_,"name");F=F.define(_),L(";")}function V(){var e,t=I();switch(t){case"weak":e=R||(R=[]),M();break;case"public":M();default:e=k||(k=[])}t=H(),L(";"),e.push(t)}function Y(){if(L("="),x=H(),!(B="proto3"===x)&&"proto2"!==x)throw U(x,"syntax");L(";")}function J(e,t){switch(t){case"option":return ee(e,t),L(";"),!0;case"message":return X(e,t),!0;case"enum":return Z(e,t),!0;case"service":return function(e,t){if(!C.test(t=M()))throw U(t,"service name");var i=new u(t);K(i,(function(e){if(!J(i,e)){if("rpc"!==e)throw U(e);!function(e,t){var i=D(),n=t;if(!C.test(t=M()))throw U(t,"name");var s,r,a,o,l=t;if(L("("),L("stream",!0)&&(r=!0),!T.test(t=M()))throw U(t);if(s=t,L(")"),L("returns"),L("("),L("stream",!0)&&(o=!0),!T.test(t=M()))throw U(t);a=t,L(")");var c=new h(l,n,s,a,r,o);c.comment=i,K(c,(function(e){if("option"!==e)throw U(e);ee(c,e),L(";")})),e.add(c)}(i,e)}})),e.add(i)}(e,t),!0;case"extend":return function(e,t){if(!T.test(t=M()))throw U(t,"reference");var i=t;K(null,(function(t){switch(t){case"required":case"repeated":Q(e,t,i);break;case"optional":Q(e,B?"proto3_optional":"optional",i);break;default:if(!B||!T.test(t))throw U(t);P(t),Q(e,"optional",i)}}))}(e,t),!0}return!1}function K(e,t,i){var n=O.line;if(e&&("string"!=typeof e.comment&&(e.comment=D()),e.filename=w.filename),L("{",!0)){for(var s;"}"!==(s=M());)t(s);L(";",!0)}else i&&i(),L(";"),e&&("string"!=typeof e.comment||N)&&(e.comment=D(n)||e.comment)}function X(e,t){if(!C.test(t=M()))throw U(t,"type name");var i=new r(t);K(i,(function(e){if(!J(i,e))switch(e){case"map":!function(e){L("<");var t=M();if(void 0===d.mapKey[t])throw U(t,"type");L(",");var i=M();if(!T.test(i))throw U(i,"type");L(">");var n=M();if(!C.test(n))throw U(n,"name");L("=");var s=new o(z(n),W(M()),t,i);K(s,(function(e){if("option"!==e)throw U(e);ee(s,e),L(";")}),(function(){ne(s)})),e.add(s)}(i);break;case"required":case"repeated":Q(i,e);break;case"optional":Q(i,B?"proto3_optional":"optional");break;case"oneof":!function(e,t){if(!C.test(t=M()))throw U(t,"name");var i=new l(z(t));K(i,(function(e){"option"===e?(ee(i,e),L(";")):(P(e),Q(i,"optional"))})),e.add(i)}(i,e);break;case"extensions":G(i.extensions||(i.extensions=[]));break;case"reserved":G(i.reserved||(i.reserved=[]),!0);break;default:if(!B||!T.test(e))throw U(e);P(e),Q(i,"optional")}})),e.add(i)}function Q(e,t,i){var n=M();if("group"!==n){if(!T.test(n))throw U(n,"type");var s=M();if(!C.test(s))throw U(s,"name");s=z(s),L("=");var o=new a(s,W(M()),n,t,i);if(K(o,(function(e){if("option"!==e)throw U(e);ee(o,e),L(";")}),(function(){ne(o)})),"proto3_optional"===t){var c=new l("_"+s);o.setOption("proto3_optional",!0),c.add(o),e.add(c)}else e.add(o);B||!o.repeated||void 0===d.packed[n]&&void 0!==d.basic[n]||o.setOption("packed",!1,!0)}else!function(e,t){var i=M();if(!C.test(i))throw U(i,"name");var n=f.lcFirst(i);i===n&&(i=f.ucFirst(i)),L("=");var s=W(M()),o=new r(i);o.group=!0;var l=new a(n,s,i,t);l.filename=w.filename,K(o,(function(e){switch(e){case"option":ee(o,e),L(";");break;case"required":case"repeated":Q(o,e);break;case"optional":Q(o,B?"proto3_optional":"optional");break;case"message":X(o,e);break;case"enum":Z(o,e);break;default:throw U(e)}})),e.add(o).add(l)}(e,t)}function Z(e,t){if(!C.test(t=M()))throw U(t,"name");var i=new c(t);K(i,(function(e){switch(e){case"option":ee(i,e),L(";");break;case"reserved":G(i.reserved||(i.reserved=[]),!0);break;default:!function(e,t){if(!C.test(t))throw U(t,"name");L("=");var i=W(M(),!0),n={options:void 0,setOption:function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t}};K(n,(function(e){if("option"!==e)throw U(e);ee(n,e),L(";")}),(function(){ne(n)})),e.add(t,i,n.comment,n.options)}(i,e)}})),e.add(i)}function ee(e,t){var i=L("(",!0);if(!T.test(t=M()))throw U(t,"name");var n,s=t,r=s;i&&(L(")"),r=s="("+s+")",t=I(),E.test(t)&&(n=t.slice(1),s+=t,M())),L("="),function(e,t,i,n){e.setParsedOption&&e.setParsedOption(t,i,n)}(e,r,te(e,s),n)}function te(e,t){if(L("{",!0)){for(var i={};!L("}",!0);){if(!C.test(A=M()))throw U(A,"name");var n,s=A;if(L(":",!0),"{"===I())n=te(e,t+"."+A);else if("["===I()){var r;if(n=[],L("[",!0)){do{r=q(!0),n.push(r)}while(L(",",!0));L("]"),void 0!==r&&ie(e,t+"."+A,r)}}else n=q(!0),ie(e,t+"."+A,n);var a=i[s];a&&(n=[].concat(a).concat(n)),i[s]=n,L(",",!0),L(";",!0)}return i}var o=q(!0);return ie(e,t,o),o}function ie(e,t,i){e.setOption&&e.setOption(t,i)}function ne(e){if(L("[",!0)){do{ee(e,"option")}while(L(",",!0));L("]")}return e}for(;null!==(A=M());)switch(A){case"package":if(!j)throw U(A);$();break;case"import":if(!j)throw U(A);V();break;case"syntax":if(!j)throw U(A);Y();break;case"option":ee(F,A),L(";");break;default:if(J(F,A)){j=!1;continue}throw U(A)}return w.filename=null,{package:_,imports:k,weakImports:R,syntax:x,root:t}}},1408:(e,t,i)=>{"use strict";e.exports=l;var n,s=i(9693),r=s.LongBits,a=s.utf8;function o(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},h=function(){return s.Buffer?function(e){return(l.create=function(e){return s.Buffer.isBuffer(e)?new n(e):u(e)})(e)}:u};function d(){var e=new r(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw o(this,8);return new r(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return f(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|f(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw o(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw o(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=h(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},593:(e,t,i)=>{"use strict";e.exports=r;var n=i(1408);(r.prototype=Object.create(n.prototype)).constructor=r;var s=i(9693);function r(e){n.call(this,e)}r._configure=function(){s.Buffer&&(r.prototype._slice=s.Buffer.prototype.slice)},r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},r._configure()},9424:(e,t,i)=>{"use strict";e.exports=h;var n=i(9313);((h.prototype=Object.create(n.prototype)).constructor=h).className="Root";var s,r,a,o=i(3548),l=i(7025),c=i(7598),u=i(9935);function h(e){n.call(this,"",e),this.deferred=[],this.files=[]}function d(){}h.fromJSON=function(e,t){return t||(t=new h),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},h.prototype.resolvePath=u.path.resolve,h.prototype.fetch=u.fetch,h.prototype.load=function e(t,i,n){"function"==typeof i&&(n=i,i=void 0);var s=this;if(!n)return u.asPromise(e,s,t,i);var o=n===d;function l(e,t){if(n){var i=n;if(n=null,o)throw e;i(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var i=e.substring(t);if(i in a)return i}return null}function h(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){r.filename=e;var n,a=r(t,s,i),h=0;if(a.imports)for(;h<a.imports.length;++h)(n=c(a.imports[h])||s.resolvePath(e,a.imports[h]))&&f(n);if(a.weakImports)for(h=0;h<a.weakImports.length;++h)(n=c(a.weakImports[h])||s.resolvePath(e,a.weakImports[h]))&&f(n,!0)}else s.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}o||p||l(null,s)}function f(e,t){if(!(s.files.indexOf(e)>-1))if(s.files.push(e),e in a)o?h(e,a[e]):(++p,setTimeout((function(){--p,h(e,a[e])})));else if(o){var i;try{i=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||l(e))}h(e,i)}else++p,s.fetch(e,(function(i,r){--p,n&&(i?t?p||l(null,s):l(i):h(e,r))}))}var p=0;u.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=s.resolvePath("",t[g]))&&f(m);if(o)return s;p||l(null,s)},h.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,d)},h.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return n.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var i=t.parent.lookup(t.extend);if(i){var n=new o(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.declaringField=t,t.extensionField=n,i.add(n),!0}return!1}h.prototype._handleAdd=function(e){if(e instanceof o)void 0===e.extend||e.extensionField||p(0,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof s)for(var t=0;t<this.deferred.length;)p(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);f.test(e.name)&&(e.parent[e.name]=e)}},h.prototype._handleRemove=function(e){if(e instanceof o){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof n){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);f.test(e.name)&&delete e.parent[e.name]}},h._configure=function(e,t,i){s=e,r=t,a=i}},5054:e=>{"use strict";e.exports={}},5994:(e,t,i)=>{"use strict";t.Service=i(7948)},7948:(e,t,i)=>{"use strict";e.exports=s;var n=i(9693);function s(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,i,s,r,a){if(!r)throw TypeError("request must be specified");var o=this;if(!a)return n.asPromise(e,o,t,i,s,r);if(o.rpcImpl)try{return o.rpcImpl(t,i[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),(function(e,i){if(e)return o.emit("error",e,t),a(e);if(null!==i){if(!(i instanceof s))try{i=s[o.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return o.emit("error",e,t),a(e)}return o.emit("data",i,t),a(null,i)}o.end(!0)}))}catch(e){return o.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},7513:(e,t,i)=>{"use strict";e.exports=o;var n=i(9313);((o.prototype=Object.create(n.prototype)).constructor=o).className="Service";var s=i(4429),r=i(9935),a=i(5994);function o(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}o.fromJSON=function(e,t){var i=new o(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),r=0;r<n.length;++r)i.add(s.fromJSON(n[r],t.methods[n[r]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i},o.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return r.toObject(["options",t&&t.options||void 0,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},Object.defineProperty(o.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=r.toArray(this.methods))}}),o.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},o.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},o.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof s?(this.methods[e.name]=e,e.parent=this,l(this)):n.prototype.add.call(this,e)},o.prototype.remove=function(e){if(e instanceof s){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return n.prototype.remove.call(this,e)},o.prototype.create=function(e,t,i){for(var n,s=new a.Service(e,t,i),o=0;o<this.methodsArray.length;++o){var l=r.lcFirst((n=this._methodsArray[o]).resolve().name).replace(/[^$\w_]/g,"");s[l]=r.codegen(["r","c"],r.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return s}},626:e=>{"use strict";e.exports=h;var t=/[\s{}=;:[\],'"()<>]/g,i=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,n=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,s=/^ *[*/]+ */,r=/^\s*\*?\/*/,a=/\n/g,o=/\s/,l=/\\(.?)/g,c={0:"\0",r:"\r",n:"\n",t:"\t"};function u(e){return e.replace(l,(function(e,t){switch(t){case"\\":case"":return t;default:return c[t]||""}}))}function h(e,l){e=e.toString();var c=0,h=e.length,d=1,f=0,p={},m=[],g=null;function v(e){return Error("illegal "+e+" (line "+d+")")}function y(t){return e.charAt(t)}function S(t,i,n){var o,c={type:e.charAt(t++),lineEmpty:!1,leading:n},u=t-(l?2:3);do{if(--u<0||"\n"===(o=e.charAt(u))){c.lineEmpty=!0;break}}while(" "===o||"\t"===o);for(var h=e.substring(t,i).split(a),m=0;m<h.length;++m)h[m]=h[m].replace(l?r:s,"").trim();c.text=h.join("\n").trim(),p[d]=c,f=d}function b(t){var i=C(t),n=e.substring(t,i);return/^\s*\/{1,2}/.test(n)}function C(e){for(var t=e;t<h&&"\n"!==y(t);)t++;return t}function T(){if(m.length>0)return m.shift();if(g)return function(){var t="'"===g?n:i;t.lastIndex=c-1;var s=t.exec(e);if(!s)throw v("string");return c=t.lastIndex,E(g),g=null,u(s[1])}();var s,r,a,f,p,T=0===c;do{if(c===h)return null;for(s=!1;o.test(a=y(c));)if("\n"===a&&(T=!0,++d),++c===h)return null;if("/"===y(c)){if(++c===h)throw v("comment");if("/"===y(c))if(l){if(f=c,p=!1,b(c)){p=!0;do{if((c=C(c))===h)break;if(c++,!T)break}while(b(c))}else c=Math.min(h,C(c)+1);p&&(S(f,c,T),T=!0),d++,s=!0}else{for(p="/"===y(f=c+1);"\n"!==y(++c);)if(c===h)return null;++c,p&&(S(f,c-1,T),T=!0),++d,s=!0}else{if("*"!==(a=y(c)))return"/";f=c+1,p=l||"*"===y(f);do{if("\n"===a&&++d,++c===h)throw v("comment");r=a,a=y(c)}while("*"!==r||"/"!==a);++c,p&&(S(f,c-2,T),T=!0),s=!0}}}while(s);var w=c;if(t.lastIndex=0,!t.test(y(w++)))for(;w<h&&!t.test(y(w));)++w;var _=e.substring(c,c=w);return'"'!==_&&"'"!==_||(g=_),_}function E(e){m.push(e)}function w(){if(!m.length){var e=T();if(null===e)return null;E(e)}return m[0]}return Object.defineProperty({next:T,peek:w,push:E,skip:function(e,t){var i=w();if(i===e)return T(),!0;if(!t)throw v("token '"+i+"', '"+e+"' expected");return!1},cmnt:function(e){var t,i=null;return void 0===e?(t=p[d-1],delete p[d-1],t&&(l||"*"===t.type||t.lineEmpty)&&(i=t.leading?t.text:null)):(f<e&&w(),t=p[e],delete p[e],!t||t.lineEmpty||!l&&"/"!==t.type||(i=t.leading?null:t.text)),i}},"line",{get:function(){return d}})}h.unescape=u},7645:(e,t,i)=>{"use strict";e.exports=y;var n=i(9313);((y.prototype=Object.create(n.prototype)).constructor=y).className="Type";var s=i(7025),r=i(7598),a=i(3548),o=i(6039),l=i(7513),c=i(8368),u=i(1408),h=i(1173),d=i(9935),f=i(4928),p=i(5305),m=i(4497),g=i(3996),v=i(1667);function y(e,t){n.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function S(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var i=this.fields[e[t]],n=i.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,d.merge(e.prototype,t)),e.$type=e.prototype.$type=this,d.merge(e,c,!0),this._ctor=e;for(var i=0;i<this.fieldsArray.length;++i)this._fieldsArray[i].resolve();var n={};for(i=0;i<this.oneofsArray.length;++i)n[this._oneofsArray[i].resolve().name]={get:d.oneOfGetter(this._oneofsArray[i].oneof),set:d.oneOfSetter(this._oneofsArray[i].oneof)};i&&Object.defineProperties(e.prototype,n)}}}),y.generateConstructor=function(e){for(var t,i=d.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?i("this%s={}",d.safeProp(t.name)):t.repeated&&i("this%s=[]",d.safeProp(t.name));return i("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},y.fromJSON=function(e,t){var i=new y(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)i.add((void 0!==t.fields[c[u]].keyType?o.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)i.add(r.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var h=t.nested[c[u]];i.add((void 0!==h.id?a.fromJSON:void 0!==h.fields?y.fromJSON:void 0!==h.values?s.fromJSON:void 0!==h.methods?l.fromJSON:n.fromJSON)(c[u],h))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i},y.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return d.toObject(["options",t&&t.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},y.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return n.prototype.resolveAll.call(this)},y.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},y.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),S(this)}return e instanceof r?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),S(this)):n.prototype.add.call(this,e)},y.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),S(this)}if(e instanceof r){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),S(this)}return n.prototype.remove.call(this,e)},y.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},y.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},y.prototype.create=function(e){return new this.ctor(e)},y.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=f(this)({Writer:h,types:t,util:d}),this.decode=p(this)({Reader:u,types:t,util:d}),this.verify=m(this)({types:t,util:d}),this.fromObject=g.fromObject(this)({types:t,util:d}),this.toObject=g.toObject(this)({types:t,util:d});var n=v[e];if(n){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(s),s.toObject=this.toObject,this.toObject=n.toObject.bind(s)}return this},y.prototype.encode=function(e,t){return this.setup().encode(e,t)},y.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},y.prototype.decode=function(e,t){return this.setup().decode(e,t)},y.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},y.prototype.verify=function(e){return this.setup().verify(e)},y.prototype.fromObject=function(e){return this.setup().fromObject(e)},y.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},y.d=function(e){return function(t){d.decorateType(t,e)}}},7063:(e,t,i)=>{"use strict";var n=t,s=i(9935),r=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var i=0,n={};for(t|=0;i<e.length;)n[r[i+t]]=e[i++];return n}n.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",s.emptyArray,null]),n.long=a([0,0,0,1,1],7),n.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:(e,t,i)=>{"use strict";var n,s,r=e.exports=i(9693),a=i(5054);r.codegen=i(5124),r.fetch=i(9054),r.path=i(2860),r.fs=r.inquire("fs"),r.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),n=0;n<t.length;)i[n]=e[t[n++]];return i}return[]},r.toObject=function(e){for(var t={},i=0;i<e.length;){var n=e[i++],s=e[i++];void 0!==s&&(t[n]=s)}return t};var o=/\\/g,l=/"/g;r.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},r.safeProp=function(e){return!/^[$\w_]+$/.test(e)||r.isReserved(e)?'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]':"."+e},r.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;r.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))},r.compareFieldsById=function(e,t){return e.id-t.id},r.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(r.decorateRoot.remove(e.$type),e.$type.name=t,r.decorateRoot.add(e.$type)),e.$type;n||(n=i(7645));var s=new n(t||e.name);return r.decorateRoot.add(s),s.ctor=e,Object.defineProperty(e,"$type",{value:s,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:s,enumerable:!1}),s};var u=0;r.decorateEnum=function(e){if(e.$type)return e.$type;s||(s=i(7025));var t=new s("Enum"+u++,e);return r.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},r.setProperty=function(e,t,i){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,i,n){var s=i.shift();if("__proto__"===s)return t;if(i.length>0)t[s]=e(t[s]||{},i,n);else{var r=t[s];r&&(n=[].concat(r).concat(n)),t[s]=n}return t}(e,t=t.split("."),i)},Object.defineProperty(r,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(i(9424)))}})},1945:(e,t,i)=>{"use strict";e.exports=s;var n=i(9693);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=s.zero=new s(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var a=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new s(i,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):r},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var o=String.prototype.charCodeAt;s.fromHash=function(e){return e===a?r:new s((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},9693:function(e,t,i){"use strict";var n=t;function s(e,t,i){for(var n=Object.keys(t),s=0;s<n.length;++s)void 0!==e[n[s]]&&i||(e[n[s]]=t[n[s]]);return e}function r(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&s(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>e,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=i(4537),n.base64=i(7419),n.EventEmitter=i(9211),n.float=i(945),n.inquire=i(7199),n.utf8=i(4997),n.pool=i(6662),n.LongBits=i(1945),n.isNode=Boolean("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),n.global=n.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=r,n.ProtocolError=r("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},4497:(e,t,i)=>{"use strict";e.exports=function(e){var t=s.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i={};e.oneofsArray.length&&t("var p={}");for(var n=0;n<e.fieldsArray.length;++n){var l=e._fieldsArray[n].resolve(),c="m"+s.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,l.name),l.map)t("if(!util.isObject(%s))",c)("return%j",r(l,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),o(t,l,"k[i]"),a(t,l,n,c+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",c)("return%j",r(l,"array"))("for(var i=0;i<%s.length;++i){",c),a(t,l,n,c+"[i]")("}");else{if(l.partOf){var u=s.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",u)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",u)}a(t,l,n,c)}l.optional&&t("}")}return t("return null")};var n=i(7025),s=i(9935);function r(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,i,s){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",s)("default:")("return%j",r(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),o=0;o<a.length;++o)e("case %i:",t.resolvedType.values[a[o]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",i,s)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",s)("return%j",r(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",s,s,s,s)("return%j",r(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',s)("return%j",r(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',s)("return%j",r(t,"boolean"));break;case"string":e("if(!util.isString(%s))",s)("return%j",r(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',s,s,s)("return%j",r(t,"buffer"))}return e}function o(e,t,i){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",i)("return%j",r(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",i)("return%j",r(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",i)("return%j",r(t,"boolean key"))}return e}},1667:(e,t,i)=>{"use strict";var n=t,s=i(8368);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),i=this.lookup(t);if(i){var n="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===n.indexOf("/")&&(n="/"+n),this.create({type_url:n,value:i.encode(i.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var i="",n="";if(t&&t.json&&e.type_url&&e.value){n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var r=this.lookup(n);r&&(e=r.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof s){var a=e.$type.toObject(e,t);return""===i&&(i="type.googleapis.com/"),n=i+("."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName),a["@type"]=n,a}return this.toObject(e,t)}}},1173:(e,t,i)=>{"use strict";e.exports=h;var n,s=i(9693),r=s.LongBits,a=s.base64,o=s.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var d=function(){return s.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function f(e,t,i){t[i]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function g(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}h.create=d(),h.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(h.alloc=s.pool(h.alloc,s.Array.prototype.subarray)),h.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},p.prototype=Object.create(l.prototype),p.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,r.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=r.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=r.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var v=s.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(s.isString(e)){var i=h.alloc(t=a.length(e));a.decode(e,i,0),e=i}return this.uint32(t)._push(v,t,e)},h.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},3155:(e,t,i)=>{"use strict";e.exports=r;var n=i(1173);(r.prototype=Object.create(n.prototype)).constructor=r;var s=i(9693);function r(){n.call(this)}function a(e,t,i){e.length<40?s.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}r._configure=function(){r.alloc=s._Buffer_allocUnsafe,r.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},r.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(r.writeBytesBuffer,t,e),this},r.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},r._configure()},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},1808:e=>{"use strict";e.exports=require("net")},4492:e=>{"use strict";e.exports=require("node:stream")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},6569:e=>{"use strict";e.exports={i8:"1.8.0"}},4784:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},3571:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},3342:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},8783:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}},__webpack_module_cache__={},leafPrototypes,getProto;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var i=Object.create(null);__webpack_require__.r(i);var n={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var s=2&t&&e;"object"==typeof s&&!~leafPrototypes.indexOf(s);s=getProto(s))Object.getOwnPropertyNames(s).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,__webpack_require__.d(i,n),i},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(6636),t=__webpack_require__(9421),i=__webpack_require__(1017),n=__webpack_require__(7310),s=__webpack_require__(7147);const r=require("node:fs/promises"),a=require("node:fs");async function o(e,t,i,n,s){return new Promise(((r,o)=>{a.read(e,t,i,n,s,((e,t,i)=>{e?o(e):r({bytesRead:t,buffer:i})}))}))}a.existsSync,a.createReadStream;class l extends Error{constructor(){super("End-Of-Stream")}}const c=require("node:buffer");class u{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const i=c.Buffer.alloc(e.len);if(await this.readBuffer(i,{position:t})<e.len)throw new l;return e.get(i,0)}async peekToken(e,t=this.position){const i=c.Buffer.alloc(e.len);if(await this.peekBuffer(i,{position:t})<e.len)throw new l;return e.get(i,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new l;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new l;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}class h extends u{constructor(e,t){super(t),this.fd=e}async readBuffer(e,t){const i=this.normalizeOptions(e,t);this.position=i.position;const n=await o(this.fd,e,i.offset,i.length,i.position);if(this.position+=n.bytesRead,n.bytesRead<i.length&&(!t||!t.mayBeLess))throw new l;return n.bytesRead}async peekBuffer(e,t){const i=this.normalizeOptions(e,t),n=await o(this.fd,e,i.offset,i.length,i.position);if(!i.mayBeLess&&n.bytesRead<i.length)throw new l;return n.bytesRead}async close(){return async function(e){return new Promise(((t,i)=>{a.close(e,(e=>{e?i(e):t()}))}))}(this.fd)}}function d(e){return new DataView(e.buffer,e.byteOffset)}__webpack_require__(645);const f={len:1,get:(e,t)=>d(e).getUint8(t),put:(e,t,i)=>(d(e).setUint8(t,i),t+1)},p={len:2,get:(e,t)=>d(e).getUint16(t,!0),put:(e,t,i)=>(d(e).setUint16(t,i,!0),t+2)},m={len:2,get:(e,t)=>d(e).getUint16(t),put:(e,t,i)=>(d(e).setUint16(t,i),t+2)},g={len:4,get:(e,t)=>d(e).getUint32(t,!0),put:(e,t,i)=>(d(e).setUint32(t,i,!0),t+4)},v={len:4,get:(e,t)=>d(e).getUint32(t),put:(e,t,i)=>(d(e).setUint32(t,i),t+4)},y={len:4,get:(e,t)=>d(e).getInt32(t),put:(e,t,i)=>(d(e).setInt32(t,i),t+4)},S={len:8,get:(e,t)=>d(e).getBigUint64(t,!0),put:(e,t,i)=>(d(e).setBigUint64(t,i,!0),t+8)};class b{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return c.Buffer.from(e).toString(this.encoding,t,t+this.len)}}class C{constructor(e){this.len=e}static decode(e,t,i){let n="";for(let s=t;s<i;++s)n+=C.codePointToString(C.singleByteDecoder(e[s]));return n}static inRange(e,t,i){return t<=e&&e<=i}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(C.inRange(e,0,127))return e;const t=C.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return C.decode(e,t,t+this.len)}}C.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];const T={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4};function E(e,t,i){i={offset:0,...i};for(const[n,s]of t.entries())if(i.mask){if(s!==(i.mask[n]&e[n+i.offset]))return!1}else if(s!==e[n+i.offset])return!1;return!0}async function w(e){try{return(new _).parse(e)}catch(e){if(!(e instanceof l))throw e}}class _{check(e,t){return E(this.buffer,e,t)}checkString(e,t){return this.check((i=e,[...i].map((e=>e.charCodeAt(0)))),t);var i}async parse(e){if(this.buffer=c.Buffer.alloc(4100),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const t=await e.readToken(T);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),w(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const i={compressedSize:this.buffer.readUInt32LE(18),uncompressedSize:this.buffer.readUInt32LE(22),filenameLength:this.buffer.readUInt16LE(26),extraFieldLength:this.buffer.readUInt16LE(28)};if(i.filename=await e.readToken(new b(i.filenameLength,"utf-8")),await e.ignore(i.extraFieldLength),"META-INF/mozilla.rsa"===i.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(i.filename.endsWith(".rels")||i.filename.endsWith(".xml"))switch(i.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(i.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(i.filename.startsWith("3D/")&&i.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===i.filename&&i.compressedSize===i.uncompressedSize){let n=await e.readToken(new b(i.compressedSize,"utf-8"));switch(n=n.trim(),n){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===i.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=this.buffer.indexOf("504B0304",0,"hex"),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(i.compressedSize)}}catch(r){if(!(r instanceof l))throw r}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const a=c.Buffer.alloc(8);return await e.readBuffer(a),E(a,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:E(a,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:E(a,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:E(a,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:E(a,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:E(a,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&0!=(96&this.buffer[8])){const o=this.buffer.toString("binary",8,12).replace("\0"," ").trim();switch(o){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return o.startsWith("3g")?o.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){await e.ignore(1350);const u=10485760,h=c.Buffer.alloc(Math.min(u,e.fileInfo.size));return await e.readBuffer(h,{mayBeLess:!0}),h.includes(c.Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const d=await this.readTiffHeader(!1);if(d)return d}if(this.check([77,77])){const p=await this.readTiffHeader(!0);if(p)return p}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function m(){const t=await e.peekNumber(f);let i=128,n=0;for(;0==(t&i)&&0!==i;)++n,i>>=1;const s=c.Buffer.alloc(n+1);return await e.readBuffer(s),s}async function g(){const e=await m(),t=await m();t[0]^=128>>t.length-1;const i=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-i,i)}}async function v(t){for(;t>0;){const i=await g();if(17026===i.id)return(await e.readToken(new b(i.len,"utf-8"))).replace(/\00.*$/g,"");await e.ignore(i.len),--t}}const C=await g();switch(await v(C.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),"debian-binary"===await e.readToken(new b(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.check([137,80,78,71,13,10,26,10])){async function _(){return{length:await e.readToken(y),type:await e.readToken(new b(4,"binary"))}}await e.ignore(8);do{const k=await _();if(k.length<0)return;switch(k.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(k.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function R(){const t=c.Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(S))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const x=await R();let A=x.size-24;if(E(x.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const N=c.Buffer.alloc(16);if(A-=await e.readBuffer(N),E(N,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(E(N,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(A)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new b(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const O=this.buffer.readUInt32LE(12);if(O>12&&this.buffer.length>=O+16)try{const M=this.buffer.slice(16,O+16).toString();if(JSON.parse(M).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),function(e,t=0){const i=Number.parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(i))return!1;let n=256;for(let i=t;i<t+148;i++)n+=e[i];for(let i=t+156;i<t+512;i++)n+=e[i];return i===n}(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const t=await this.tokenizer.readToken(e?m:p);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const t=await this.tokenizer.readToken(e?m:p);for(let i=0;i<t;++i){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const t=(e?m:p).get(this.buffer,2),i=(e?v:g).get(this.buffer,4);if(42===t){if(i>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}await this.tokenizer.ignore(i);return await this.readTiffIFD(!1)||{ext:"tif",mime:"image/tiff"}}if(43===t)return{ext:"tif",mime:"image/tiff"}}}function k(e,t,i,n,s,r,a){try{var o=e[r](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,s)}new Set(["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"]),new Set(["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]);var R=(0,n.fileURLToPath)("file:///C:/Users/User/Desktop/Study/GBTube/GRPC_server/server.js"),x=(0,i.dirname)(R),A="185.26.120.191:9090",N=(0,i.resolve)(x,"proto","video.proto"),O=(0,i.resolve)(x,"..","media"),M=t.loadSync(N,{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0});var P,I,L,D=e.loadPackageDefinition(M).videoService;P={callMediaInfo:function(e,t){(function(){var t,n=(t=function*(){var t=(0,i.resolve)(O,e.request.pathToMedia),{ext:n,mime:s}=yield async function(e){const t=await async function(e){const t=await async function(e){return new Promise(((t,i)=>{a.stat(e,((e,n)=>{e?i(e):t(n)}))}))}(e);if(!t.isFile)throw new Error(`File not a file: ${e}`);const i=await async function(e,t){return new Promise(((t,i)=>{a.open(e,"r",((e,n)=>{e?i(e):t(n)}))}))}(e);return new h(i,{path:e,size:t.size})}(e);try{return await w(t)}finally{await t.close()}}(t),{size:o}=yield(0,r.stat)(t);return{size:o,ext:n,mime:s}},function(){var e=this,i=arguments;return new Promise((function(n,s){var r=t.apply(e,i);function a(e){k(r,n,s,a,o,"next",e)}function o(e){k(r,n,s,a,o,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}})()().then((e=>{var{size:i,ext:n,mime:s}=e;t(null,{fileSize:i,ext:n,mime:s})})).catch((e=>{t(e,{fileSize:0,ext:"none",mime:"none"})}))},callVideoChunk:function(e){var{pathToMedia:t,start:n,end:r}=e.request,a=(0,i.resolve)(O,t),o=s.createReadStream(a,{start:n,end:r});o.on("data",(t=>{e.write({mediaStream:t})})),o.on("error",(()=>{e.write({isError:!0}),e.end()})),o.on("end",(()=>{e.end()}))},callMediaSimple:function(e){var{pathToMedia:t}=e.request,n=(0,i.resolve)(O,t),r=s.createReadStream(n);r.on("data",(t=>{e.write({mediaStream:t})})),r.on("error",(()=>{e.write({isError:!0}),e.end()})),r.on("end",(()=>{e.end()}))},sendMedia:function(e,t){var n;e.on("data",(e=>{var r=e.chunk,a=e.fileName;if("string"!=typeof a||r)n.write(r);else{var o=(0,i.resolve)(O,a);(n=s.createWriteStream(o)).on("error",(e=>{console.log("Write file error"),console.log(e),t(e,{status:"FAILED"})}))}})),e.on("end",(()=>{n.close(),t(null,{status:"SUCCESS"})}))},isFileExist:function(e,t){var n=(0,i.resolve)(O,e.request.fileName);(0,r.access)(n,r.constants.R_OK|r.constants.W_OK).then((()=>{t(null,{fileExist:!0})})).catch((()=>{t(null,{fileExist:!1})}))},deleteFile:function(e,t){var n=(0,i.resolve)(O,e.request.fileName);(0,r.rm)(n).then((()=>{t(null,{})})).catch((e=>{t(e,{})}))}},(I=new e.Server).addService(D.VideoService.service,P),(L=I).bindAsync(A,e.ServerCredentials.createInsecure(),(()=>{L.start(),console.log("gRPC server has been started on ".concat(A))}))})()})();